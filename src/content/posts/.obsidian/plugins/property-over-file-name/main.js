/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/utils/frontmatter.ts
var frontmatter_exports = {};
__export(frontmatter_exports, {
  getFrontmatter: () => getFrontmatter,
  getFrontmatterSync: () => getFrontmatterSync,
  isFileTypeSupported: () => isFileTypeSupported
});
async function getFrontmatter(app, file, settings) {
  if (file.extension === "md") {
    const fileCache = app.metadataCache.getFileCache(file);
    return (fileCache == null ? void 0 : fileCache.frontmatter) || null;
  }
  if (file.extension === "mdx" && settings.enableMdxSupport) {
    try {
      const content = await app.vault.read(file);
      const frontmatterRegex = /^---\n([\s\S]*?)\n---/;
      const match = content.match(frontmatterRegex);
      if (match && match[1]) {
        const frontmatterText = match[1];
        try {
          const parsed = (0, import_obsidian.parseYaml)(frontmatterText);
          return parsed && typeof parsed === "object" ? parsed : null;
        } catch (e) {
          return null;
        }
      }
      return null;
    } catch (e) {
      return null;
    }
  }
  return null;
}
function getFrontmatterSync(app, file, settings) {
  if (file.extension === "md") {
    const fileCache = app.metadataCache.getFileCache(file);
    return (fileCache == null ? void 0 : fileCache.frontmatter) || null;
  }
  if (file.extension === "mdx" && settings.enableMdxSupport) {
    return null;
  }
  return null;
}
function isFileTypeSupported(extension, settings) {
  if (extension === "md") {
    return true;
  }
  if (extension === "mdx") {
    return settings.enableMdxSupport;
  }
  return false;
}
var import_obsidian;
var init_frontmatter = __esm({
  "src/utils/frontmatter.ts"() {
    "use strict";
    import_obsidian = require("obsidian");
  }
});

// src/utils/search.ts
async function buildFileCache(files, metadataCache, app, propertyKey, settings) {
  const cache = /* @__PURE__ */ new Map();
  const { getFrontmatter: getFrontmatter2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
  await Promise.all(files.map(async (file) => {
    if (!isFileTypeSupported(file.extension, settings)) {
      return;
    }
    let frontmatter;
    if (file.extension === "md") {
      const fileCache = app.metadataCache.getFileCache(file);
      frontmatter = (fileCache == null ? void 0 : fileCache.frontmatter) || null;
    } else {
      frontmatter = await getFrontmatter2(app, file, settings);
    }
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[propertyKey] !== void 0 && frontmatter[propertyKey] !== null) {
      const propertyValueRaw = frontmatter[propertyKey];
      let propertyValue;
      if (typeof propertyValueRaw === "string") {
        propertyValue = propertyValueRaw.trim();
      } else if (typeof propertyValueRaw === "number" || typeof propertyValueRaw === "boolean") {
        propertyValue = String(propertyValueRaw).trim();
      } else {
        propertyValue = "";
      }
      if (propertyValue && propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    cache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  }));
  return cache;
}
var init_search = __esm({
  "src/utils/search.ts"() {
    "use strict";
    init_frontmatter();
  }
});

// src/ui/QuickSwitchModal.ts
var QuickSwitchModal_exports = {};
__export(QuickSwitchModal_exports, {
  QuickSwitchModal: () => QuickSwitchModal
});
var import_obsidian5, QuickSwitchModal;
var init_QuickSwitchModal = __esm({
  "src/ui/QuickSwitchModal.ts"() {
    "use strict";
    import_obsidian5 = require("obsidian");
    init_search();
    init_frontmatter();
    QuickSwitchModal = class extends import_obsidian5.FuzzySuggestModal {
      constructor(app, plugin) {
        super(app);
        this.fileCache = /* @__PURE__ */ new Map();
        this.recentFiles = [];
        this.searchTimeout = null;
        this.matchReasons = /* @__PURE__ */ new Map();
        this.plugin = plugin;
        this.limit = 8;
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.setPlaceholder("Type to search notes by title or file name...");
        } else {
          this.setPlaceholder("Type to search files...");
        }
        void this.buildFileCache();
        this.updateRecentFiles();
        this.addKeyboardNavigation();
        this.addFooter();
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.containerEl.addClass("property-over-filename-modal");
        }
      }
      addKeyboardNavigation() {
        this.inputEl.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            this.close();
            e.preventDefault();
            e.stopPropagation();
          }
        });
      }
      addFooter() {
        const promptContainer = this.containerEl.querySelector(".prompt");
        if (promptContainer) {
          const footer = promptContainer.createDiv({ cls: "prompt-instructions" });
          const instructions = [
            { command: "\u2191\u2193", action: "to navigate" },
            { command: "\u21B5", action: "to open" },
            { command: "ctrl \u21B5", action: "to open in new tab" },
            { command: "ctrl alt \u21B5", action: "to open to the right" },
            { command: "shift \u21B5", action: "to create" },
            { command: "esc", action: "to dismiss" }
          ];
          instructions.forEach(({ command, action }) => {
            const instruction = footer.createDiv({ cls: "prompt-instruction" });
            instruction.createSpan({ cls: "prompt-instruction-command", text: command });
            instruction.createSpan({ text: action });
          });
        }
      }
      async buildFileCache() {
        const files = this.getFilteredFiles();
        this.fileCache = await buildFileCache(
          files,
          this.app.metadataCache,
          this.app,
          this.plugin.settings.propertyKey,
          this.plugin.settings
        );
      }
      async updateFileCache(file) {
        const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
        if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
          return;
        }
        const frontmatter = await getFrontmatter2(this.app, file, this.plugin.settings);
        let displayName = file.basename;
        let isCustomDisplay = false;
        let aliases = [];
        if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
          const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
          if (propertyValue !== "") {
            displayName = propertyValue;
            isCustomDisplay = true;
          }
        }
        if (frontmatter == null ? void 0 : frontmatter.aliases) {
          const aliasesRaw = frontmatter.aliases;
          aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
          aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
        }
        this.fileCache.set(file.path, {
          file,
          displayName,
          aliases,
          lastModified: file.stat.mtime,
          isCustomDisplay
        });
      }
      updateRecentFiles() {
        var _a, _b;
        let recentFiles = [];
        const workspace = this.app.workspace;
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showAttachments = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) != null ? _a : true;
        if ((_b = workspace.recentFileTracker) == null ? void 0 : _b.getLastOpenFiles) {
          const lastOpenFiles = workspace.recentFileTracker.getLastOpenFiles();
          recentFiles = lastOpenFiles.map((filePath) => this.app.vault.getAbstractFileByPath(filePath)).filter((file) => file instanceof import_obsidian5.TFile);
        }
        if (recentFiles.length === 0) {
          const openFiles = this.app.workspace.getLeavesOfType("markdown").map((leaf) => leaf.view).filter((view) => view instanceof import_obsidian5.MarkdownView).map((view) => view.file).filter((file) => file !== null).filter((file, index, self) => self.indexOf(file) === index);
          recentFiles = [...openFiles];
        }
        if (!showAttachments) {
          recentFiles = recentFiles.filter(
            (file) => file.extension === "md" || file.extension === "mdx" && this.plugin.settings.enableMdxSupport
          );
        }
        const targetCount = 8;
        const existingPaths = new Set(recentFiles.map((f) => f.path));
        if (recentFiles.length < targetCount) {
          if (showAttachments) {
            const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian5.TFile);
            const additionalFiles = allFiles.filter((file) => !existingPaths.has(file.path)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          } else {
            const allMarkdownFiles = this.app.vault.getMarkdownFiles();
            const mdxFiles = this.plugin.settings.enableMdxSupport ? this.app.vault.getFiles().filter(
              (f) => f instanceof import_obsidian5.TFile && f.extension === "mdx"
            ) : [];
            const allSupportedFiles = [...allMarkdownFiles, ...mdxFiles];
            const additionalFiles = allSupportedFiles.filter((file) => !existingPaths.has(file.path)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          }
        }
        this.recentFiles = recentFiles.slice(0, targetCount);
      }
      getItems() {
        return this.getFilteredFiles();
      }
      getFilteredFiles() {
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        let files = this.app.vault.getMarkdownFiles();
        if (this.plugin.settings.enableMdxSupport) {
          const mdxFiles = this.app.vault.getFiles().filter(
            (f) => f instanceof import_obsidian5.TFile && f.extension === "mdx"
          );
          files = [...files, ...mdxFiles];
        }
        if (quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) {
          const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian5.TFile);
          files = allFiles.filter(
            (file) => file instanceof import_obsidian5.TFile && (file.extension === "md" || file.extension === "mdx" && this.plugin.settings.enableMdxSupport || this.isAttachment(file))
          );
        }
        return files;
      }
      isAttachment(file) {
        const attachmentExtensions = ["png", "jpg", "jpeg", "gif", "svg", "webp", "pdf", "mp4", "mp3", "wav", "ogg", "webm"];
        return attachmentExtensions.includes(file.extension.toLowerCase());
      }
      getQuickSwitcherOptions() {
        var _a;
        try {
          const internalPlugins = this.app.internalPlugins;
          if (!internalPlugins) return null;
          const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
          if (!switcherPlugin || !switcherPlugin.instance) {
            return null;
          }
          return switcherPlugin.instance.options || null;
        } catch (e) {
          return null;
        }
      }
      getItemText(item) {
        if ("isNewNote" in item) {
          return item.newName;
        }
        if ("isUnresolved" in item) {
          return item.unresolvedText;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          return item.basename;
        }
        const display = this.getDisplayName(item);
        return display;
      }
      getDisplayName(file) {
        const cached = this.fileCache.get(file.path);
        if (cached) {
          return cached.displayName;
        }
        const frontmatter = getFrontmatterSync(this.app, file, this.plugin.settings);
        if (frontmatter) {
          const propertyValue = frontmatter[this.plugin.settings.propertyKey];
          if (propertyValue !== void 0 && propertyValue !== null) {
            const trimmed = typeof propertyValue === "string" ? propertyValue.trim() : (typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "").trim();
            if (trimmed !== "") {
              return trimmed;
            }
          }
        }
        return file.basename;
      }
      getSuggestions(query) {
        var _a;
        if (!this.plugin.settings.enableForQuickSwitcher) {
          const searchQuery2 = query.trim();
          if (!searchQuery2) {
            return this.getRecentFilesResults();
          }
          const files = this.getFilteredFiles();
          const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian5.prepareSimpleSearch)(searchQuery2) : (0, import_obsidian5.prepareFuzzySearch)(searchQuery2);
          const results = [];
          for (const file of files) {
            const match = (_a = search(file.basename)) != null ? _a : { score: 0, matches: [] };
            if (match.matches.length > 0) {
              results.push({ item: file, match });
            }
          }
          (0, import_obsidian5.sortSearchResults)(results);
          if (results.length === 0) {
            const newItem = { isNewNote: true, newName: searchQuery2 };
            results.push({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery2.length]] }
            });
          }
          return results.slice(0, this.limit);
        }
        const searchQuery = query.trim();
        if (this.searchTimeout) {
          clearTimeout(this.searchTimeout);
        }
        if (!searchQuery) {
          return this.getRecentFilesResults();
        }
        return this.performSearch(searchQuery);
      }
      getRecentFilesResults() {
        this.updateRecentFiles();
        this.matchReasons.clear();
        return this.recentFiles.map((file) => ({
          item: file,
          match: { score: 1e3, matches: [] }
        }));
      }
      performSearch(searchQuery) {
        var _a;
        const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian5.prepareSimpleSearch)(searchQuery) : (0, import_obsidian5.prepareFuzzySearch)(searchQuery);
        const results = [];
        this.matchReasons.clear();
        for (const cachedData of this.fileCache.values()) {
          const { file, displayName, aliases, isCustomDisplay } = cachedData;
          const matchReason = {
            matchedInTitle: false,
            matchedInFilename: false,
            matchedInAlias: false
          };
          let primaryMatch = null;
          let bestMatch = null;
          let matchType = null;
          if (isCustomDisplay) {
            primaryMatch = search(displayName);
            if (primaryMatch && primaryMatch.matches.length > 0) {
              matchReason.matchedInTitle = true;
              bestMatch = primaryMatch;
              matchType = "title";
            }
          }
          if (!matchType) {
            if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
                matchType = "filename";
              }
            } else if (!isCustomDisplay) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = filenameMatch;
                matchType = "filename";
              }
            }
          }
          if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
            for (const alias of aliases) {
              const aliasMatch = search(alias);
              if (aliasMatch && aliasMatch.matches.length > 0) {
                matchReason.matchedInAlias = true;
                matchReason.matchedAliasText = alias;
                bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
                matchType = "alias";
                break;
              }
            }
          }
          if (bestMatch && bestMatch.matches.length > 0) {
            results.push({ item: file, match: bestMatch });
            this.matchReasons.set(file.path, matchReason);
          }
        }
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
        if (!showExistingOnly) {
          const { unresolvedLinks } = this.app.metadataCache;
          const unresolvedSet = /* @__PURE__ */ new Set();
          for (const sourcePath in unresolvedLinks) {
            const links = Object.keys(unresolvedLinks[sourcePath]);
            links.forEach((link) => unresolvedSet.add(link));
          }
          for (const unresolved of unresolvedSet) {
            const unresolvedMatch = search(unresolved);
            if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
              const unresolvedItem = { isUnresolved: true, unresolvedText: unresolved };
              results.push({
                item: unresolvedItem,
                match: unresolvedMatch
              });
            }
          }
        }
        try {
          (0, import_obsidian5.sortSearchResults)(results);
          let filteredResults = results;
          if (showExistingOnly) {
            filteredResults = results.filter((r) => {
              return r.item instanceof import_obsidian5.TFile || "isNewNote" in r.item && r.item.isNewNote === true;
            });
          }
          const lowerQuery = searchQuery.toLowerCase();
          let exactMatch = filteredResults.some(
            (r) => {
              var _a2;
              return r.item instanceof import_obsidian5.TFile && (this.getDisplayName(r.item).toLowerCase() === lowerQuery || this.plugin.settings.includeFilenameInSearch && r.item.basename.toLowerCase() === lowerQuery || this.plugin.settings.includeAliasesInSearch && ((_a2 = this.fileCache.get(r.item.path)) == null ? void 0 : _a2.aliases.some((alias) => alias.toLowerCase() === lowerQuery)));
            }
          );
          if (!showExistingOnly && !exactMatch) {
            const { unresolvedLinks } = this.app.metadataCache;
            const unresolvedSet = /* @__PURE__ */ new Set();
            for (const sourcePath in unresolvedLinks) {
              const links = Object.keys(unresolvedLinks[sourcePath]);
              links.forEach((link) => unresolvedSet.add(link));
            }
            exactMatch = Array.from(unresolvedSet).some((link) => link.toLowerCase() === lowerQuery);
          }
          if (!exactMatch && searchQuery) {
            const newItem = { isNewNote: true, newName: searchQuery };
            filteredResults.unshift({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery.length]] }
            });
          }
          return filteredResults.slice(0, this.limit);
        } catch (e) {
          new import_obsidian5.Notice("Error updating quick switcher suggestions. Please check console for details.");
          return [];
        }
      }
      renderSuggestion(suggestion, el) {
        var _a;
        const { item } = suggestion;
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(unresolvedText);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": "Unresolved link - Enter to create" }
          });
          this.createFilePlusIcon(suggestionFlair);
          return;
        }
        const text = this.getItemText(item);
        if ("isNewNote" in item) {
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(text);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionAction = suggestionAux.createSpan({ cls: "suggestion-action" });
          suggestionAction.setText("Enter to create");
          return;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          if (item instanceof import_obsidian5.TFile) {
            el.setText(item.path.replace(".md", ""));
          } else {
            el.setText(text);
          }
        } else {
          if (!(item instanceof import_obsidian5.TFile)) {
            el.setText(text);
            return;
          }
          const cachedData = this.fileCache.get(item.path);
          const isCustomDisplay = (_a = cachedData == null ? void 0 : cachedData.isCustomDisplay) != null ? _a : false;
          const matchReason = this.matchReasons.get(item.path);
          if (!isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
            el.addClass("mod-complex");
            const suggestionContent = el.createDiv({ cls: "suggestion-content" });
            const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
            titleEl.setText(matchReason.matchedAliasText);
            const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
            pathEl.setText(item.path.replace(".md", ""));
            const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
            const suggestionFlair = suggestionAux.createSpan({
              cls: "suggestion-flair",
              attr: { "aria-label": "Alias Match" }
            });
            this.createForwardIcon(suggestionFlair);
          } else if (isCustomDisplay) {
            const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
            if (shouldShowIcon) {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": this.getIconLabel(matchReason) }
              });
              if (matchReason.matchedInTitle) {
                this.createTypeIcon(suggestionFlair);
              } else if (matchReason.matchedInFilename) {
                this.createFileIcon(suggestionFlair);
              } else if (matchReason.matchedInAlias) {
                this.createForwardIcon(suggestionFlair);
              }
            } else {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": "Property-based title" }
              });
              this.createTypeIcon(suggestionFlair);
            }
          } else {
            el.setText(text);
          }
        }
      }
      getIconLabel(matchReason) {
        if (matchReason.matchedInTitle) {
          return "Title/Property Match";
        } else if (matchReason.matchedInFilename) {
          return "File Name Match";
        } else if (matchReason.matchedInAlias) {
          return "Alias Match";
        }
        return "Match";
      }
      createTypeIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-type");
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "9");
        line1.setAttribute("y1", "20");
        line1.setAttribute("x2", "15");
        line1.setAttribute("y2", "20");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "12");
        line2.setAttribute("y1", "4");
        line2.setAttribute("x2", "12");
        line2.setAttribute("y2", "20");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      createFileIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-text");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "16");
        line1.setAttribute("y1", "13");
        line1.setAttribute("x2", "8");
        line1.setAttribute("y2", "13");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "16");
        line2.setAttribute("y1", "17");
        line2.setAttribute("x2", "8");
        line2.setAttribute("y2", "17");
        svg.appendChild(line2);
        const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline2.setAttribute("points", "10,9 9,9 8,9");
        svg.appendChild(polyline2);
        container.appendChild(svg);
      }
      createForwardIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-forward");
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "15 17 20 12 15 7");
        svg.appendChild(polyline);
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
        svg.appendChild(path);
        container.appendChild(svg);
      }
      createFilePlusIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-plus");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "12");
        line1.setAttribute("y1", "18");
        line1.setAttribute("x2", "12");
        line1.setAttribute("y2", "12");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "9");
        line2.setAttribute("y1", "15");
        line2.setAttribute("x2", "15");
        line2.setAttribute("y2", "15");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      isUsingCustomProperty(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
        if (propertyValue === void 0 || propertyValue === null) {
          return false;
        }
        const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
        return strValue.trim() !== "";
      }
      isUsingAlias(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
        if (!aliases) return false;
        const isUsingCustomProperty = this.isUsingCustomProperty(file);
        return !isUsingCustomProperty && Boolean(aliases);
      }
      onChooseItem(item, evt) {
        var _a, _b;
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
          const sourcePath = ((_a = activeView == null ? void 0 : activeView.file) == null ? void 0 : _a.path) || "";
          void this.app.workspace.openLinkText(unresolvedText, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian5.Notice(`Error creating note: ${message}`);
          });
          return;
        }
        if ("isNewNote" in item) {
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
          const sourcePath = ((_b = activeView == null ? void 0 : activeView.file) == null ? void 0 : _b.path) || "";
          void this.app.workspace.openLinkText(item.newName, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian5.Notice(`Error creating note: ${message}`);
          });
        } else if (item instanceof import_obsidian5.TFile) {
          if (evt instanceof KeyboardEvent) {
            if (evt.ctrlKey && evt.altKey) {
              const leaf = this.app.workspace.getLeaf(true);
              void leaf.openFile(item);
            } else if (evt.ctrlKey) {
              void this.app.workspace.getLeaf().openFile(item);
            } else if (evt.shiftKey) {
              void this.app.workspace.getLeaf().openFile(item);
            } else {
              void this.app.workspace.getLeaf().openFile(item);
            }
          } else {
            void this.app.workspace.getLeaf().openFile(item);
          }
        }
      }
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PropertyOverFileNamePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian12 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  propertyKey: "title",
  enableForLinking: true,
  enableForQuickSwitcher: true,
  includeFilenameInSearch: true,
  includeAliasesInSearch: true,
  enableForDragDrop: true,
  useSimpleSearch: false,
  enableForGraphView: true,
  enableForBacklinks: true,
  enableForTabs: true,
  enableForExplorer: false,
  folderNoteFilename: "",
  enableForWindowFrame: true,
  enableMdxSupport: false
};

// src/ui/LinkTitleSuggest.ts
var import_obsidian2 = require("obsidian");
init_search();
var LinkTitleSuggest = class extends import_obsidian2.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.fileCache = /* @__PURE__ */ new Map();
    this.searchTimeout = null;
    this.matchReasons = /* @__PURE__ */ new Map();
    this.plugin = plugin;
    void this.buildFileCache();
  }
  open() {
    super.open();
    const el = this.suggestEl;
    if (el) {
      el.addClass("property-over-filename-suggestion");
      if (!el.querySelector(".prompt-instructions")) {
        const instructions = el.createDiv({ cls: "prompt-instructions" });
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type # to link heading");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type ^ to link blocks");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type | to change display text");
      }
    }
    this.addKeyboardNavigation();
  }
  addKeyboardNavigation() {
    const el = this.suggestEl;
    if (!el) return;
    el.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        this.close();
        e.preventDefault();
        e.stopPropagation();
      }
    });
  }
  onTrigger(cursor, editor, file) {
    if (!this.plugin.settings.enableForLinking) return null;
    const line = editor.getLine(cursor.line).substring(0, cursor.ch);
    const match = /\[\[([^#^|\]]*)$/.exec(line);
    if (match) {
      return {
        start: { line: cursor.line, ch: line.lastIndexOf("[[") },
        end: cursor,
        query: match[1]
      };
    }
    return null;
  }
  async buildFileCache() {
    const mdFiles = this.app.vault.getMarkdownFiles();
    const allFiles = [...mdFiles];
    if (this.plugin.settings.enableMdxSupport) {
      const mdxFiles = this.app.vault.getFiles().filter(
        (f) => f instanceof import_obsidian2.TFile && f.extension === "mdx"
      );
      allFiles.push(...mdxFiles);
    }
    this.fileCache = await buildFileCache(
      allFiles,
      this.app.metadataCache,
      this.app,
      this.plugin.settings.propertyKey,
      this.plugin.settings
    );
  }
  async updateFileCache(file) {
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return;
    }
    const frontmatter = await getFrontmatter2(this.app, file, this.plugin.settings);
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    this.fileCache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  }
  getSuggestions(context) {
    const query = context.query.trim();
    return this.performSearch(query);
  }
  performSearch(query) {
    var _a;
    if (!query || query.trim() === "") {
      const suggestions2 = [];
      for (const cachedData of this.fileCache.values()) {
        suggestions2.push({
          file: cachedData.file,
          display: cachedData.displayName,
          isCustomDisplay: cachedData.isCustomDisplay
        });
      }
      return suggestions2;
    }
    const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian2.prepareSimpleSearch)(query) : (0, import_obsidian2.prepareFuzzySearch)(query);
    const searchableSuggestions = [];
    this.matchReasons.clear();
    for (const cachedData of this.fileCache.values()) {
      const { file, displayName, aliases, isCustomDisplay } = cachedData;
      const matchReason = {
        matchedInTitle: false,
        matchedInFilename: false,
        matchedInAlias: false
      };
      let primaryMatch = null;
      let bestMatch = null;
      let matchType = null;
      if (isCustomDisplay) {
        primaryMatch = search(displayName);
        if (primaryMatch && primaryMatch.matches.length > 0) {
          matchReason.matchedInTitle = true;
          bestMatch = primaryMatch;
          matchType = "title";
        }
      }
      if (!matchType) {
        if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
            matchType = "filename";
          }
        } else if (!isCustomDisplay) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = filenameMatch;
            matchType = "filename";
          }
        }
      }
      if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
        for (const alias of aliases) {
          const aliasMatch = search(alias);
          if (aliasMatch && aliasMatch.matches.length > 0) {
            matchReason.matchedInAlias = true;
            matchReason.matchedAliasText = alias;
            bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
            matchType = "alias";
            break;
          }
        }
      }
      if (bestMatch && bestMatch.matches.length > 0) {
        const suggestion = {
          file,
          display: displayName,
          isCustomDisplay
        };
        searchableSuggestions.push({ item: suggestion, match: bestMatch });
        this.matchReasons.set(file.path, matchReason);
      }
    }
    const quickSwitcherOptions = this.getQuickSwitcherOptions();
    const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
    if (!showExistingOnly) {
      const { unresolvedLinks } = this.app.metadataCache;
      const unresolvedSet = /* @__PURE__ */ new Set();
      for (const sourcePath in unresolvedLinks) {
        const links = Object.keys(unresolvedLinks[sourcePath]);
        links.forEach((link) => unresolvedSet.add(link));
      }
      for (const unresolved of unresolvedSet) {
        const unresolvedMatch = search(unresolved);
        if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
          searchableSuggestions.push({
            item: {
              display: unresolved,
              isCustomDisplay: false
              // No file property means it's unresolved
            },
            match: unresolvedMatch
          });
        }
      }
    }
    (0, import_obsidian2.sortSearchResults)(searchableSuggestions);
    let suggestions = searchableSuggestions.map((s) => s.item);
    if (showExistingOnly) {
      suggestions = suggestions.filter((s) => s.file !== void 0);
    }
    if (suggestions.length === 0 && query) {
      suggestions.push({
        display: "No match found",
        isCustomDisplay: false,
        isNoMatch: true
      });
    }
    return suggestions;
  }
  renderSuggestion(suggestion, el) {
    el.empty();
    if (suggestion.isNoMatch) {
      el.setText(suggestion.display);
      return;
    }
    if (suggestion.file) {
      const matchReason = this.matchReasons.get(suggestion.file.path);
      if (!suggestion.isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
        el.addClass("mod-complex");
        const suggestionContent = el.createDiv({ cls: "suggestion-content" });
        const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
        titleEl.setText(matchReason.matchedAliasText);
        const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
        pathEl.setText(suggestion.file.path.replace(".md", ""));
        const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
        const suggestionFlair = suggestionAux.createSpan({
          cls: "suggestion-flair",
          attr: { "aria-label": "Alias Match" }
        });
        this.createForwardIcon(suggestionFlair);
      } else if (suggestion.isCustomDisplay) {
        const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
        if (shouldShowIcon) {
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
          titleEl.setText(suggestion.display);
          const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
          pathEl.setText(suggestion.file.path.replace(".md", ""));
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": this.getIconLabel(matchReason) }
          });
          if (matchReason.matchedInTitle) {
            this.createTypeIcon(suggestionFlair);
          } else if (matchReason.matchedInFilename) {
            this.createFileIcon(suggestionFlair);
          } else if (matchReason.matchedInAlias) {
            this.createForwardIcon(suggestionFlair);
          }
        } else {
          el.setText(suggestion.display);
        }
      } else {
        el.setText(suggestion.display);
      }
    }
  }
  getIconLabel(matchReason) {
    if (matchReason.matchedInTitle) {
      return "Title/Property Match";
    } else if (matchReason.matchedInFilename) {
      return "File Name Match";
    } else if (matchReason.matchedInAlias) {
      return "Alias Match";
    }
    return "Match";
  }
  createTypeIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-type");
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "9");
    line1.setAttribute("y1", "20");
    line1.setAttribute("x2", "15");
    line1.setAttribute("y2", "20");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "12");
    line2.setAttribute("y1", "4");
    line2.setAttribute("x2", "12");
    line2.setAttribute("y2", "20");
    svg.appendChild(line2);
    container.appendChild(svg);
  }
  createFileIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-file-text");
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
    svg.appendChild(path);
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "14,2 14,8 20,8");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "16");
    line1.setAttribute("y1", "13");
    line1.setAttribute("x2", "8");
    line1.setAttribute("y2", "13");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "16");
    line2.setAttribute("y1", "17");
    line2.setAttribute("x2", "8");
    line2.setAttribute("y2", "17");
    svg.appendChild(line2);
    const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline2.setAttribute("points", "10,9 9,9 8,9");
    svg.appendChild(polyline2);
    container.appendChild(svg);
  }
  createForwardIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-forward");
    const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline.setAttribute("points", "15 17 20 12 15 7");
    svg.appendChild(polyline);
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
    svg.appendChild(path);
    container.appendChild(svg);
  }
  isUsingCustomProperty(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
    if (propertyValue === void 0 || propertyValue === null) {
      return false;
    }
    const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
    return strValue.trim() !== "";
  }
  isUsingAlias(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
    if (!aliases) return false;
    const isUsingCustomProperty = this.isUsingCustomProperty(file);
    return !isUsingCustomProperty && Boolean(aliases);
  }
  selectSuggestion(suggestion, evt) {
    var _a, _b;
    if (suggestion.isNoMatch) {
      return;
    }
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    if (!activeView || !this.context) return;
    const editor = activeView.editor;
    const { start, end } = this.context;
    const line = editor.getLine(start.line);
    let endPos = end;
    if (line.slice(end.ch, end.ch + 2) === "]]") {
      endPos = { line: end.line, ch: end.ch + 2 };
    }
    if (!suggestion.file) {
      return;
    }
    const vault = this.app.vault;
    const useMarkdownLinks = (_b = (_a = vault.getConfig) == null ? void 0 : _a.call(vault, "useMarkdownLinks")) != null ? _b : false;
    let linkText;
    if (suggestion.isCustomDisplay) {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.display}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}|${suggestion.display}]]`;
      }
    } else {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.file.path.replace(".md", "")}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}]]`;
      }
    }
    editor.replaceRange(linkText, { line: start.line, ch: start.ch }, endPos);
    const newCursorPos = start.ch + linkText.length;
    try {
      editor.setCursor({ line: start.line, ch: newCursorPos });
    } catch (e) {
      new import_obsidian2.Notice("Error setting cursor position. Please check console for details.");
    }
  }
  getQuickSwitcherOptions() {
    var _a;
    try {
      const internalPlugins = this.app.internalPlugins;
      if (!internalPlugins) return null;
      const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
      if (!switcherPlugin || !switcherPlugin.instance) {
        return null;
      }
      return switcherPlugin.instance.options || null;
    } catch (e) {
      return null;
    }
  }
};

// src/ui/SettingTab.ts
var import_obsidian4 = require("obsidian");

// src/utils/settings-compat.ts
var import_obsidian3 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading) {
  if ((0, import_obsidian3.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian3.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/SettingTab.ts
var SettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("property-over-filename-settings");
    const generalGroup = createSettingsGroup(containerEl);
    generalGroup.addSetting((setting) => {
      setting.setName("Property key").setDesc("The property to use as the display title. Falls back to the file name when no property is set for that item.").addText(
        (text) => text.setPlaceholder("Title").setValue(this.plugin.settings.propertyKey).onChange(async (value) => {
          this.plugin.settings.propertyKey = value.trim() || "title";
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
          this.plugin.updateGraphView();
          this.plugin.updateBacklinks();
          this.plugin.updateTabs();
          this.plugin.updateExplorer();
          this.plugin.updateWindowFrame();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When linking notes").setDesc("Enable property-based titles in the link suggester.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForLinking).onChange(async (value) => {
          this.plugin.settings.enableForLinking = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In quick switcher").setDesc("Enable property-based titles in the quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForQuickSwitcher).onChange(async (value) => {
          const prevQuickSwitcherState = this.plugin.settings.enableForQuickSwitcher;
          this.plugin.settings.enableForQuickSwitcher = value;
          await this.plugin.saveSettings(prevQuickSwitcherState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include file name in fuzzy searches").setDesc("Include note file names in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeFilenameInSearch).onChange(async (value) => {
          this.plugin.settings.includeFilenameInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include aliases in fuzzy searches").setDesc("Include property aliases in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeAliasesInSearch).onChange(async (value) => {
          this.plugin.settings.includeAliasesInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When dragging notes").setDesc("Use property-based titles when dragging notes from the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForDragDrop).onChange(async (value) => {
          this.plugin.settings.enableForDragDrop = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In graph view").setDesc("Use the property instead of the file name as the note's title in graph view.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForGraphView).onChange(async (value) => {
          this.plugin.settings.enableForGraphView = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateGraphView();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In backlinks and outgoing links").setDesc("Use the property instead of the file name in the linked mentions footer, dedicated backlinks panel, and outgoing links.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForBacklinks).onChange(async (value) => {
          this.plugin.settings.enableForBacklinks = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateBacklinks();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In tab titles").setDesc("Use the property instead of the file name in tab titles.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForTabs).onChange(async (value) => {
          const prevTabState = this.plugin.settings.enableForTabs;
          this.plugin.settings.enableForTabs = value;
          await this.plugin.saveSettings(void 0, prevTabState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In window frame title").setDesc("Use the property instead of the file name in the browser window title bar.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForWindowFrame).onChange(async (value) => {
          this.plugin.settings.enableForWindowFrame = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateWindowFrame();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In file explorer").setDesc("Use the property instead of the file name in the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForExplorer).onChange(async (value) => {
          this.plugin.settings.enableForExplorer = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateExplorer();
          this.display();
        })
      );
    });
    if (this.plugin.settings.enableForExplorer) {
      generalGroup.addSetting((setting) => {
        setting.setName("Folder note file name").setDesc("If a folder contains a file with this name that has the configured property, the folder will display that property value instead. This ensures compatibility with folder notes plugins. Leave blank to disable.").addText(
          (text) => text.setPlaceholder("Index").setValue(this.plugin.settings.folderNoteFilename).onChange(async (value) => {
            this.plugin.settings.folderNoteFilename = value.trim();
            await this.plugin.saveData(this.plugin.settings);
            this.plugin.updateExplorer();
          })
        );
      });
    }
    generalGroup.addSetting((setting) => {
      setting.setName("Use simple search").setDesc("Instead of using fuzzy search, simple search provides better performance with very large vaults (thousands of files).").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.useSimpleSearch).onChange(async (value) => {
          this.plugin.settings.useSimpleSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable MDX file support").setDesc("Enable support for .mdx files. When enabled, the plugin will read frontmatter from MDX files manually (Obsidian's metadata cache only works for .md files). Note: MDX support is partial - graph view is not supported due to technical limitations.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableMdxSupport).onChange(async (value) => {
          this.plugin.settings.enableMdxSupport = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.rebuildCache();
          this.plugin.updateLinkSuggester();
          this.plugin.updateQuickSwitcher();
          this.plugin.updateGraphView();
          this.plugin.updateBacklinks();
          this.plugin.updateTabs();
          this.plugin.updateExplorer();
          this.plugin.updateWindowFrame();
        })
      );
    });
  }
};

// src/commands/index.ts
var import_obsidian6 = require("obsidian");
function registerCommands(plugin) {
  plugin.addCommand({
    id: "open-quick-switcher",
    name: "Open quick switcher (property-based)",
    callback: async () => {
      const { QuickSwitchModal: QuickSwitchModal2 } = await Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports));
      new QuickSwitchModal2(plugin.app, plugin).open();
    }
  });
  plugin.addCommand({
    id: "toggle-linking",
    name: "Toggle property-based linking",
    callback: async () => {
      plugin.settings.enableForLinking = !plugin.settings.enableForLinking;
      await plugin.saveData(plugin.settings);
      plugin.updateLinkSuggester();
      new import_obsidian6.Notice(`Property-based linking ${plugin.settings.enableForLinking ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "toggle-quick-switcher",
    name: "Toggle property-based quick switcher",
    callback: async () => {
      const prevState = plugin.settings.enableForQuickSwitcher;
      plugin.settings.enableForQuickSwitcher = !plugin.settings.enableForQuickSwitcher;
      await plugin.saveSettings(prevState);
      new import_obsidian6.Notice(`Property-based Quick Switcher ${plugin.settings.enableForQuickSwitcher ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "rebuild-cache",
    name: "Rebuild file cache",
    callback: () => {
      plugin.rebuildCache();
      new import_obsidian6.Notice("File cache rebuilt");
    }
  });
  plugin.addCommand({
    id: "toggle-drag-drop",
    name: "Toggle property-based drag and drop",
    callback: async () => {
      plugin.settings.enableForDragDrop = !plugin.settings.enableForDragDrop;
      await plugin.saveData(plugin.settings);
      new import_obsidian6.Notice(`Property-based drag and drop ${plugin.settings.enableForDragDrop ? "enabled" : "disabled"}`);
    }
  });
}

// src/services/QuickSwitcherService.ts
var QuickSwitcherService = class {
  constructor(plugin) {
    this.isCommandOverridden = false;
    this.plugin = plugin;
  }
  updateQuickSwitcher() {
    if (this.plugin.settings.enableForQuickSwitcher && !this.isCommandOverridden) {
      this.overrideQuickSwitcherCommand();
    } else if (!this.plugin.settings.enableForQuickSwitcher && this.isCommandOverridden) {
      this.restoreOriginalCommand();
    }
  }
  overrideQuickSwitcherCommand() {
    var _a;
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"] && !this.originalSwitcherCommand) {
      const originalCmd = commands["switcher:open"];
      this.originalSwitcherCommand = {
        id: originalCmd.id || "switcher:open",
        name: originalCmd.name || "Quick Switcher",
        icon: originalCmd.icon,
        hotkeys: originalCmd.hotkeys ? [...originalCmd.hotkeys] : [],
        callback: originalCmd.callback
      };
    }
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    const customCommand = {
      id: "switcher:open",
      name: "Quick Switcher",
      icon: (_a = this.originalSwitcherCommand) == null ? void 0 : _a.icon,
      hotkeys: [{ modifiers: ["Mod"], key: "o" }],
      callback: () => {
        const workspace = this.plugin.app.workspace;
        if (workspace.switcher && typeof workspace.switcher.close === "function") {
          workspace.switcher.close();
        }
        const existingModals = document.querySelectorAll(".modal");
        existingModals.forEach((modal) => {
          if (modal instanceof HTMLElement && !modal.classList.contains("hidden")) {
            modal.addClass("hidden");
          }
        });
        try {
          Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports)).then(({ QuickSwitchModal: QuickSwitchModal2 }) => {
            const modal = new QuickSwitchModal2(this.plugin.app, this.plugin);
            modal.open();
          }).catch(() => {
            if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
              this.originalSwitcherCommand.callback();
            }
          });
        } catch (e) {
          if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
            this.originalSwitcherCommand.callback();
          }
        }
      }
    };
    commands["switcher:open"] = customCommand;
    this.isCommandOverridden = true;
  }
  restoreOriginalCommand() {
    if (!this.originalSwitcherCommand) {
      return;
    }
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    commands["switcher:open"] = {
      id: this.originalSwitcherCommand.id,
      name: this.originalSwitcherCommand.name,
      icon: this.originalSwitcherCommand.icon,
      hotkeys: this.originalSwitcherCommand.hotkeys,
      callback: this.originalSwitcherCommand.callback
    };
    this.isCommandOverridden = false;
  }
};

// src/services/DragDropService.ts
var import_obsidian7 = require("obsidian");
init_frontmatter();
var DragDropService = class {
  // Prevent duplicate processing within 100ms
  constructor(plugin) {
    this.lastDropTime = 0;
    this.lastDropData = null;
    this.DROP_DEBOUNCE_MS = 100;
    this.plugin = plugin;
  }
  handleDragDrop(event, editor) {
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath || !filePath.endsWith(".md") && !(filePath.endsWith(".mdx") && this.plugin.settings.enableMdxSupport)) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === filePath) {
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = filePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
    if (!file || !(file instanceof import_obsidian7.TFile)) {
      return;
    }
    if (file.extension === "md") {
      const displayName = this.getDisplayNameSync(file);
      if (displayName !== null) {
        setTimeout(() => {
          this.replaceLastInsertedLink(file, displayName, editor);
        }, 50);
      }
    } else if (file.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
      void (async () => {
        const displayName = await this.getDisplayName(file);
        if (displayName !== null) {
          let attempts = 0;
          const maxAttempts = 5;
          const attemptReplace = () => {
            attempts++;
            const replaced = this.replaceLastInsertedLink(file, displayName, editor);
            if (!replaced && attempts < maxAttempts) {
              setTimeout(attemptReplace, 50 * attempts);
            }
          };
          setTimeout(attemptReplace, 150);
        }
      })();
    }
  }
  handleDOMDrop(event) {
    const target = event.target;
    const editorElement = target == null ? void 0 : target.closest(".cm-editor");
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
    const hasActiveEditor = activeView && activeView.editor;
    if (!editorElement && !hasActiveEditor) {
      return;
    }
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath) {
      return;
    }
    let actualFilePath = filePath;
    if (filePath.startsWith("obsidian://open?")) {
      try {
        const url = new URL(filePath);
        const fileParam = url.searchParams.get("file");
        if (fileParam) {
          const decodedPath = decodeURIComponent(fileParam);
          if (decodedPath.endsWith(".mdx")) {
            actualFilePath = decodedPath;
          } else if (decodedPath.endsWith(".md")) {
            actualFilePath = decodedPath;
          } else {
            if (this.plugin.settings.enableMdxSupport) {
              const mdxFile = this.plugin.app.vault.getAbstractFileByPath(decodedPath + ".mdx");
              if (mdxFile) {
                actualFilePath = decodedPath + ".mdx";
              } else {
                actualFilePath = decodedPath + ".md";
              }
            } else {
              actualFilePath = decodedPath + ".md";
            }
          }
        } else {
          return;
        }
      } catch (e) {
        return;
      }
    } else if (!filePath.endsWith(".md") && !(filePath.endsWith(".mdx") && this.plugin.settings.enableMdxSupport)) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === actualFilePath) {
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = actualFilePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(actualFilePath);
    if (!file || !(file instanceof import_obsidian7.TFile)) {
      return;
    }
    void (async () => {
      if (file.extension === "md") {
        const displayName = this.getDisplayNameSync(file);
        if (displayName !== null) {
          setTimeout(() => {
            const activeView2 = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
            if (activeView2 && activeView2.editor) {
              this.replaceLastInsertedLink(file, displayName, activeView2.editor);
            }
          }, 50);
        }
      } else if (file.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
        void (async () => {
          const displayName = await this.getDisplayName(file);
          if (displayName !== null) {
            let attempts = 0;
            const maxAttempts = 5;
            const attemptReplace = () => {
              attempts++;
              const activeView2 = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
              if (activeView2 && activeView2.editor) {
                const replaced = this.replaceLastInsertedLink(file, displayName, activeView2.editor);
                if (!replaced && attempts < maxAttempts) {
                  setTimeout(attemptReplace, 50 * attempts);
                }
              } else if (attempts < maxAttempts) {
                setTimeout(attemptReplace, 50 * attempts);
              }
            };
            setTimeout(attemptReplace, 150);
          }
        })();
      }
    })();
  }
  /**
   * Synchronous version for .md files (fast, immediate)
   */
  getDisplayNameSync(file) {
    if (file.extension !== "md") {
      return null;
    }
    const frontmatter = getFrontmatterSync(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  /**
   * Async version for .mdx files (needs file reading)
   */
  async getDisplayName(file) {
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return null;
    }
    const frontmatter = await getFrontmatter2(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  replaceLastInsertedLink(file, displayName, editor) {
    var _a, _b;
    const content = editor.getValue();
    const cursor = editor.getCursor();
    const lines = content.split("\n");
    const currentLine = lines[cursor.line];
    const wikiLinkRegex = /\[\[([^\]]+)\]\]/g;
    const markdownLinkRegex = /\[([^\]]*)\]\(([^)]+)\)/g;
    let match;
    let lastMatch = null;
    while ((match = wikiLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkPath = lastMatch[1];
      const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
      const linkPathWithoutExt = linkPath.replace(/\.(md|mdx)$/, "");
      if (filePathWithoutExt === linkPathWithoutExt || file.path === linkPath || file.path.replace(/\.mdx$/, ".md") === linkPath) {
        const newLinkText = `[[${linkPath}|${displayName}]]`;
        const startPos = { line: cursor.line, ch: lastMatch.index };
        const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
        editor.replaceRange(newLinkText, startPos, endPos);
        return true;
      }
    }
    markdownLinkRegex.lastIndex = 0;
    lastMatch = null;
    while ((match = markdownLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkUrl = lastMatch[2];
      const linkUrlDecoded = decodeURIComponent(linkUrl);
      const filePathEncoded = encodeURI(file.path);
      const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
      const linkUrlWithoutExt = linkUrlDecoded.replace(/\.(md|mdx)$/, "");
      const matches = file.path === linkUrlDecoded || filePathEncoded === linkUrl || filePathWithoutExt === linkUrlWithoutExt || file.path.replace(/\.mdx$/, ".md") === linkUrlDecoded || file.path.replace(/\.md$/, ".mdx") === linkUrlDecoded || // Handle relative paths - check if link URL matches file basename
      file.basename === linkUrlDecoded.replace(/\.(md|mdx)$/, "") || file.basename + ".mdx" === linkUrlDecoded || file.basename + ".md" === linkUrlDecoded || // Handle paths with directory
      file.path.endsWith(linkUrlDecoded) || linkUrlDecoded.endsWith(file.path);
      if (matches) {
        const newLinkText = `[${displayName}](${linkUrl})`;
        const startPos = { line: cursor.line, ch: lastMatch.index };
        const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
        editor.replaceRange(newLinkText, startPos, endPos);
        return true;
      }
    } else {
      const searchRange = 3;
      for (let i = Math.max(0, cursor.line - searchRange); i <= Math.min(lines.length - 1, cursor.line + searchRange); i++) {
        const line = lines[i];
        const wikiMatches = [...line.matchAll(/\[\[([^\]]+)\]\]/g)];
        const markdownMatches = [...line.matchAll(/\[([^\]]*)\]\(([^)]+)\)/g)];
        for (const wikiMatch of wikiMatches) {
          const linkPath = wikiMatch[1];
          const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
          const linkPathWithoutExt = linkPath.replace(/\.(md|mdx)$/, "");
          if (filePathWithoutExt === linkPathWithoutExt || file.path === linkPath || file.path.replace(/\.mdx$/, ".md") === linkPath) {
            const newLinkText = `[[${linkPath}|${displayName}]]`;
            const matchIndex = (_a = wikiMatch.index) != null ? _a : 0;
            const startPos = { line: i, ch: matchIndex };
            const endPos = { line: i, ch: matchIndex + wikiMatch[0].length };
            editor.replaceRange(newLinkText, startPos, endPos);
            return true;
          }
        }
        for (const mdMatch of markdownMatches) {
          const linkUrl = mdMatch[2];
          const linkUrlDecoded = decodeURIComponent(linkUrl);
          const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
          const linkUrlWithoutExt = linkUrlDecoded.replace(/\.(md|mdx)$/, "");
          const matches = file.path === linkUrlDecoded || encodeURI(file.path) === linkUrl || file.path.replace(/\.mdx$/, ".md") === linkUrlDecoded || file.path.replace(/\.md$/, ".mdx") === linkUrlDecoded || filePathWithoutExt === linkUrlWithoutExt || // Handle relative paths - check if link URL matches file basename
          file.basename === linkUrlDecoded.replace(/\.(md|mdx)$/, "") || file.basename + ".mdx" === linkUrlDecoded || file.basename + ".md" === linkUrlDecoded || // Handle paths with directory
          file.path.endsWith(linkUrlDecoded) || linkUrlDecoded.endsWith(file.path);
          if (matches) {
            const newLinkText = `[${displayName}](${linkUrl})`;
            const matchIndex = (_b = mdMatch.index) != null ? _b : 0;
            const startPos = { line: i, ch: matchIndex };
            const endPos = { line: i, ch: matchIndex + mdMatch[0].length };
            editor.replaceRange(newLinkText, startPos, endPos);
            return true;
          }
        }
      }
    }
    return false;
  }
};

// src/services/CacheService.ts
var CacheService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  setSuggest(suggest) {
    this.suggest = suggest;
  }
  invalidateCache(file) {
    if (this.suggest) {
      void this.suggest.updateFileCache(file);
    }
  }
  rebuildCache() {
    if (this.suggest) {
      void this.suggest.buildFileCache();
    }
  }
};

// src/services/GraphViewService.ts
var import_obsidian8 = require("obsidian");

// src/utils/frontmatter-cache.ts
init_frontmatter();
var FrontmatterCache = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
    this.pending = /* @__PURE__ */ new Map();
  }
  async get(app, file, settings) {
    var _a;
    const key = file.path;
    if (this.cache.has(key)) {
      return (_a = this.cache.get(key)) != null ? _a : null;
    }
    if (this.pending.has(key)) {
      return await this.pending.get(key);
    }
    const promise = getFrontmatter(app, file, settings);
    this.pending.set(key, promise);
    try {
      const result = await promise;
      this.cache.set(key, result);
      return result;
    } finally {
      this.pending.delete(key);
    }
  }
  getSync(key) {
    return this.cache.get(key);
  }
  invalidate(key) {
    this.cache.delete(key);
    this.pending.delete(key);
  }
  clear() {
    this.cache.clear();
    this.pending.clear();
  }
};
var frontmatterCache = new FrontmatterCache();

// src/services/GraphViewService.ts
var GraphViewService = class {
  constructor(plugin) {
    this.modifiedPrototypes = [];
    this.plugin = plugin;
  }
  createGetDisplayText(app) {
    return function getDisplayText() {
      const plugin = this.pov_plugin;
      if (!plugin || !plugin.settings.enableForGraphView) {
        if (this.pov_originalGetDisplayText) {
          return this.pov_originalGetDisplayText();
        }
        throw new Error("pov_originalGetDisplayText does not exist on node");
      }
      const file = app.vault.getFileByPath(this.id);
      if (file) {
        if (file.extension === "md") {
          const fileCache = app.metadataCache.getFileCache(file);
          const mdFrontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
          if (mdFrontmatter && mdFrontmatter[plugin.settings.propertyKey] !== void 0 && mdFrontmatter[plugin.settings.propertyKey] !== null) {
            const propertyValue = String(mdFrontmatter[plugin.settings.propertyKey]).trim();
            if (propertyValue !== "") {
              return propertyValue;
            }
          }
        }
        if (file.extension === "mdx" && plugin.settings.enableMdxSupport) {
          const cached = frontmatterCache.getSync(file.path);
          if (!cached) {
            void frontmatterCache.get(app, file, plugin.settings);
          }
          const frontmatter = frontmatterCache.getSync(file.path);
          if (frontmatter && frontmatter[plugin.settings.propertyKey] !== void 0 && frontmatter[plugin.settings.propertyKey] !== null) {
            const propertyValue = String(frontmatter[plugin.settings.propertyKey]).trim();
            if (propertyValue !== "") {
              return propertyValue;
            }
          }
        }
      }
      if (this.pov_originalGetDisplayText) {
        return this.pov_originalGetDisplayText();
      }
      throw new Error("pov_originalGetDisplayText does not exist on node");
    };
  }
  getGraphLeaves() {
    const leaves = [];
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("graph"));
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("localgraph"));
    return [...new Set(leaves)];
  }
  overridePrototypes() {
    if (!this.plugin.settings.enableForGraphView) {
      return;
    }
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian8.View) || leaf.isDeferred) continue;
      const view = leaf.view;
      this.overridePrototype(view);
    }
  }
  overridePrototype(view) {
    if (this.plugin.settings.enableMdxSupport) {
      void (async () => {
        for (const node of view.renderer.nodes) {
          const file = this.plugin.app.vault.getFileByPath(node.id);
          if (file && file.extension === "mdx") {
            void frontmatterCache.get(this.plugin.app, file, this.plugin.settings);
          }
        }
      })();
    }
    let firstNode;
    const nodesWithFirst = view.renderer.nodes;
    if (typeof nodesWithFirst.first === "function") {
      firstNode = nodesWithFirst.first();
    } else if (view.renderer.nodes instanceof Set) {
      firstNode = view.renderer.nodes.values().next().value;
    } else {
      for (const node of view.renderer.nodes) {
        firstNode = node;
        break;
      }
    }
    if (firstNode) {
      const proto = firstNode.constructor.prototype;
      if (!proto.hasOwnProperty("pov_originalGetDisplayText") && !this.modifiedPrototypes.includes(proto)) {
        proto.pov_originalGetDisplayText = proto.getDisplayText;
        const getDisplayTextFn = this.createGetDisplayText(this.plugin.app);
        proto.getDisplayText = getDisplayTextFn;
        proto.pov_plugin = this.plugin;
        for (const node of view.renderer.nodes) {
          if (node.text) {
            node.text.text = node.getDisplayText();
          }
        }
        view.renderer.changed();
        this.modifiedPrototypes.push(proto);
      }
    }
  }
  restorePrototypes() {
    for (const proto of this.modifiedPrototypes) {
      if (typeof proto.pov_originalGetDisplayText === "function") {
        proto.getDisplayText = proto.pov_originalGetDisplayText;
        delete proto.pov_originalGetDisplayText;
      }
      delete proto.pov_plugin;
    }
    this.modifiedPrototypes = [];
    this.rewriteNames();
  }
  rewriteNames() {
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian8.View) || leaf.isDeferred) continue;
      const view = leaf.view;
      for (const node of view.renderer.nodes) {
        if (node.text) {
          node.text.text = node.getDisplayText();
        }
      }
      view.renderer.changed();
    }
  }
  onLayoutChange() {
    var _a, _b;
    if (!this.plugin.settings.enableForGraphView) {
      this.restorePrototypes();
      return;
    }
    const appInternal = this.plugin.app;
    const graphPlugin = (_b = (_a = appInternal.internalPlugins) == null ? void 0 : _a.getPluginById) == null ? void 0 : _b.call(_a, "graph");
    if (!(graphPlugin == null ? void 0 : graphPlugin._loaded)) return;
    this.overridePrototypes();
  }
  updateGraphView() {
    if (this.plugin.settings.enableForGraphView) {
      this.overridePrototypes();
    } else {
      this.restorePrototypes();
    }
  }
  refreshGraphView() {
    if (this.plugin.settings.enableForGraphView) {
      this.rewriteNames();
    }
  }
  onunload() {
    this.restorePrototypes();
  }
};

// src/services/BacklinkService.ts
var import_obsidian9 = require("obsidian");
var BacklinkService = class {
  constructor(plugin) {
    this.processedElements = /* @__PURE__ */ new WeakSet();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
    this.originalTextContentDescriptors = /* @__PURE__ */ new Map();
    this.plugin = plugin;
  }
  /**
   * Get display name from file's frontmatter property
   */
  async getDisplayName(file) {
    if (!this.plugin.settings.enableForBacklinks) {
      return null;
    }
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return null;
    }
    const frontmatter = await getFrontmatter2(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  /**
   * Update all backlink displays
   */
  updateBacklinks() {
    if (!this.plugin.settings.enableForBacklinks) {
      this.stopObserving();
      return;
    }
    this.updateEmbeddedBacklinks();
    void this.updateDedicatedBacklinksPanel();
    this.startObserving();
  }
  /**
   * Update embedded backlinks in markdown views
   */
  updateEmbeddedBacklinks() {
    for (const leaf of this.plugin.app.workspace.getLeavesOfType("markdown")) {
      if (!(leaf.view instanceof import_obsidian9.MarkdownView)) {
        continue;
      }
      const embeddedBacklinks = leaf.view.containerEl.querySelector(".embedded-backlinks");
      if (embeddedBacklinks) {
        this.updateBacklinkContainer(embeddedBacklinks);
      }
    }
  }
  /**
   * Update dedicated backlinks panel
   */
  async updateDedicatedBacklinksPanel() {
    const backlinksLeaves = this.plugin.app.workspace.getLeavesOfType("backlink");
    for (const leaf of backlinksLeaves) {
      await leaf.loadIfDeferred();
      if (leaf.view) {
        const container = leaf.view.containerEl;
        if (container) {
          const backlinksContainer = container.querySelector(".backlinks-pane") || container.querySelector(".backlink-pane");
          if (backlinksContainer) {
            this.updateBacklinkContainer(backlinksContainer);
          }
          const outgoingLinksContainer = container.querySelector(".outgoing-link-pane") || container.querySelector(".outgoing-links");
          if (outgoingLinksContainer) {
            this.updateBacklinkContainer(outgoingLinksContainer);
          }
        }
      }
    }
  }
  /**
   * Extract file path from an element or its parent link
   */
  extractFilePathFromElement(element) {
    var _a;
    const dataPath = element.getAttribute("data-path");
    if (dataPath) {
      const file = this.plugin.app.vault.getAbstractFileByPath(dataPath);
      if (file instanceof import_obsidian9.TFile) {
        return file;
      }
    }
    const link = element.closest("a") || element.querySelector("a");
    if (link) {
      const href = link instanceof HTMLAnchorElement ? link.href : link.getAttribute("href");
      if (href) {
        if (href.startsWith("obsidian://")) {
          try {
            const url = new URL(href);
            const fileParam = url.searchParams.get("file");
            if (fileParam) {
              const decodedPath = decodeURIComponent(fileParam);
              const file = this.plugin.app.vault.getAbstractFileByPath(decodedPath + ".md");
              if (file instanceof import_obsidian9.TFile) {
                return file;
              }
            }
          } catch (e) {
          }
        }
        const internalLinkMatch = href.match(/#file\/(.+)/);
        if (internalLinkMatch) {
          const filePath = decodeURIComponent(internalLinkMatch[1]);
          const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
          if (file instanceof import_obsidian9.TFile) {
            return file;
          }
        }
        const dataHref = link.getAttribute("data-href");
        if (dataHref) {
          const file = this.plugin.app.vault.getAbstractFileByPath(dataHref);
          if (file instanceof import_obsidian9.TFile) {
            return file;
          }
        }
      }
    }
    const textContent = (_a = element.textContent) == null ? void 0 : _a.trim();
    if (textContent) {
      const allFiles = this.plugin.app.vault.getMarkdownFiles();
      const matchingFile = allFiles.find((f) => f.basename === textContent);
      if (matchingFile) {
        return matchingFile;
      }
    }
    return null;
  }
  /**
   * Update a backlink container by replacing file names with property titles
   */
  updateBacklinkContainer(container) {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const fileElements = /* @__PURE__ */ new Set();
    selectors.forEach((selector) => {
      try {
        container.querySelectorAll(selector).forEach((el) => {
          fileElements.add(el);
        });
      } catch (e) {
      }
    });
    fileElements.forEach((element) => {
      if (this.processedElements.has(element)) {
        return;
      }
      const file = this.extractFilePathFromElement(element);
      if (file && file instanceof import_obsidian9.TFile) {
        this.updateElementWithFile(element, file);
      }
    });
  }
  /**
   * Update an element with file's display name
   */
  updateElementWithFile(element, file) {
    void (async () => {
      var _a;
      const displayName = await this.getDisplayName(file);
      if (displayName === null) {
        return;
      }
      this.processedElements.add(element);
      element.setAttribute("data-pov-processed", "true");
      const currentText = ((_a = element.textContent) == null ? void 0 : _a.trim()) || "";
      const basename = file.basename;
      if (currentText === basename || currentText === file.name || currentText.endsWith(basename)) {
        const link = element.closest("a") || element.querySelector("a");
        const targetElement = link || element;
        const updateTextInElement = (el) => {
          var _a2, _b;
          if (el.childNodes.length === 1 && el.childNodes[0].nodeType === Node.TEXT_NODE) {
            el.textContent = displayName;
            return true;
          }
          const textNodes = Array.from(el.childNodes).filter((node) => node.nodeType === Node.TEXT_NODE);
          if (textNodes.length > 0) {
            textNodes[0].textContent = displayName;
            for (let i = 1; i < textNodes.length; i++) {
              textNodes[i].remove();
            }
            return true;
          }
          if (((_a2 = el.textContent) == null ? void 0 : _a2.trim()) === basename || ((_b = el.textContent) == null ? void 0 : _b.trim()) === file.name) {
            el.textContent = displayName;
            return true;
          }
          return false;
        };
        if (!updateTextInElement(targetElement)) {
          updateTextInElement(element);
        }
      }
    })();
  }
  /**
   * Start observing DOM changes for backlinks
   */
  startObserving() {
    if (this.observer) {
      return;
    }
    this.overrideBacklinkElements();
    let updateTimeout = null;
    this.observer = new MutationObserver((mutations) => {
      let shouldUpdate = false;
      const newElements = [];
      for (const mutation of mutations) {
        if (mutation.type === "childList") {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              const embeddedBacklinks = node.closest(".embedded-backlinks");
              const backlinksPanel = node.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
              if (embeddedBacklinks || backlinksPanel) {
                shouldUpdate = true;
                const selectors = [".tree-item-inner", ".backlink-title", ".backlink-file-link", ".outgoing-link-file-link", ".tree-item-self", ".nav-file-title", "[data-path]", "a.internal-link"];
                selectors.forEach((selector) => {
                  var _a;
                  try {
                    const elements = (_a = node.querySelectorAll) == null ? void 0 : _a.call(node, selector);
                    elements == null ? void 0 : elements.forEach((el) => {
                      if (el instanceof HTMLElement) {
                        newElements.push(el);
                      }
                    });
                  } catch (e) {
                  }
                });
              }
            }
          }
        } else if (mutation.type === "characterData") {
          const target = mutation.target;
          if (target instanceof HTMLElement) {
            const embeddedBacklinks = target.closest(".embedded-backlinks");
            const backlinksPanel = target.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          } else if (target.parentElement) {
            const embeddedBacklinks = target.parentElement.closest(".embedded-backlinks");
            const backlinksPanel = target.parentElement.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          }
        }
      }
      newElements.forEach((el) => {
        this.overrideElementTextContent(el);
        const file = this.extractFilePathFromElement(el);
        if (file && file instanceof import_obsidian9.TFile) {
          void (async () => {
            var _a;
            const displayName = await this.getDisplayName(file);
            if (displayName) {
              const currentText = ((_a = el.textContent) == null ? void 0 : _a.trim()) || "";
              if (currentText === file.basename || currentText === file.name) {
                el.textContent = displayName;
                el.setAttribute("data-pov-processed", "true");
                this.processedElements.add(el);
              }
            }
          })();
        }
      });
      if (shouldUpdate) {
        this.processedElements = /* @__PURE__ */ new WeakSet();
        if (updateTimeout) {
          clearTimeout(updateTimeout);
        }
        updateTimeout = setTimeout(() => {
          this.updateBacklinks();
          this.overrideBacklinkElements();
          updateTimeout = null;
        }, 10);
      }
    });
    this.observer.observe(document.body, {
      childList: true,
      subtree: true,
      characterData: true
    });
  }
  /**
   * Override textContent on all backlink elements
   */
  overrideBacklinkElements() {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const containers = [
      ...Array.from(document.querySelectorAll(".embedded-backlinks")),
      ...Array.from(document.querySelectorAll(".backlinks-pane")),
      ...Array.from(document.querySelectorAll(".backlink-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-link-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-links")),
      ...Array.from(document.querySelectorAll(".backlink-container"))
    ];
    containers.forEach((container) => {
      selectors.forEach((selector) => {
        try {
          container.querySelectorAll(selector).forEach((el) => {
            if (el instanceof HTMLElement) {
              this.overrideElementTextContent(el);
            }
          });
        } catch (e) {
        }
      });
    });
  }
  /**
   * Override textContent setter on an element to intercept Obsidian's updates
   */
  overrideElementTextContent(element) {
    if (this.modifiedElements.has(element)) {
      return;
    }
    const proto = Object.getPrototypeOf(element);
    const originalDescriptor = Object.getOwnPropertyDescriptor(proto, "textContent");
    if (originalDescriptor && originalDescriptor.set) {
      this.originalTextContentDescriptors.set(element, originalDescriptor);
      try {
        Object.defineProperty(element, "textContent", {
          set: (value) => {
            const file = this.extractFilePathFromElement(element);
            if (file && file instanceof import_obsidian9.TFile) {
              void (async () => {
                const displayName = await this.getDisplayName(file);
                if (displayName && (value === file.basename || value === file.name || value.endsWith(file.basename))) {
                  originalDescriptor.set.call(element, displayName);
                  element.setAttribute("data-pov-processed", "true");
                  this.processedElements.add(element);
                  return;
                }
                originalDescriptor.set.call(element, value);
              })();
              return;
            }
            originalDescriptor.set.call(element, value);
            element.setAttribute("data-pov-processed", "true");
          },
          // eslint-disable-next-line @typescript-eslint/unbound-method
          get: originalDescriptor.get || (() => {
            var _a, _b;
            return ((_b = (_a = Object.getOwnPropertyDescriptor(HTMLElement.prototype, "textContent")) == null ? void 0 : _a.get) == null ? void 0 : _b.call(element)) || "";
          }),
          configurable: true,
          enumerable: true
        });
      } catch (e) {
        element.setAttribute("data-pov-processed", "true");
      }
    } else {
      element.setAttribute("data-pov-processed", "true");
    }
    this.modifiedElements.add(element);
  }
  /**
   * Stop observing DOM changes
   */
  stopObserving() {
    if (this.observer) {
      this.observer.disconnect();
      this.observer = void 0;
    }
  }
  /**
   * Handle layout changes
   */
  onLayoutChange() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateBacklinks();
      }, 100);
    } else {
      this.stopObserving();
    }
  }
  /**
   * Handle file open events
   */
  onFileOpen() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateEmbeddedBacklinks();
      }, 200);
    }
  }
  /**
   * Clean up on unload
   */
  onunload() {
    this.stopObserving();
    this.originalTextContentDescriptors.forEach((descriptor, element) => {
      try {
        Object.defineProperty(element, "textContent", descriptor);
      } catch (e) {
      }
    });
    this.originalTextContentDescriptors.clear();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
  }
};

// src/services/TabService.ts
init_frontmatter();
var TabService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Renames all markdown tabs to use the configured property value
   * Falls back to file basename if property is not found
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  async renameTabs() {
    const leaves = this.plugin.app.workspace.getLeavesOfType("markdown");
    leaves.forEach((leaf) => {
      var _a;
      const view = leaf.view;
      const state = leaf.getViewState();
      if (((_a = state.state) == null ? void 0 : _a.file) && !(view == null ? void 0 : view.file)) {
        void leaf.setViewState({ type: state.type, state: state.state });
      }
      if (view == null ? void 0 : view.file) {
        const file = view.file;
        void (async () => {
          const frontmatter = await getFrontmatter(this.plugin.app, file, this.plugin.settings);
          const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
          const tabHeaderEl = leaf.tabHeaderEl;
          if (tabHeaderEl) {
            tabHeaderEl.setAttribute("data-pov-title-set", "true");
            if (this.plugin.settings.enableForTabs) {
              const titleEl = tabHeaderEl.querySelector(".workspace-tab-header-inner-title");
              const displayText = propertyValue ? String(propertyValue) : file.basename;
              if (titleEl) {
                titleEl.setText(displayText);
              }
              tabHeaderEl.setAttribute("aria-label", displayText);
              tabHeaderEl.setAttribute("title", displayText);
            }
          }
        })();
      }
    });
  }
  /**
   * Register event listeners for tab renaming
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  async registerEvents() {
    await this.renameTabs();
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("active-leaf-change", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => this.renameTabs())
    );
  }
  /**
   * Update tabs (public method for manual updates)
   */
  updateTabs() {
    void this.renameTabs();
  }
  /**
   * Cleanup on unload
   */
  onunload() {
  }
};

// src/services/ExplorerService.ts
var import_obsidian10 = require("obsidian");
var ExplorerService = class {
  constructor(plugin) {
    // Public so ExplorerFileItemMutator can access it
    this.explorerView = null;
    this.modified = /* @__PURE__ */ new WeakMap();
    this.plugin = plugin;
  }
  /**
   * Get the file explorer view
   */
  getExplorerView() {
    if (this.explorerView === null) {
      const leaves = this.plugin.app.workspace.getLeavesOfType("file-explorer");
      if (leaves.length === 0) {
        return null;
      }
      const leaf = leaves[0];
      if (leaf && leaf.view) {
        this.explorerView = leaf.view;
      }
    }
    return this.explorerView;
  }
  /**
   * Get folder note title for a folder
   * Returns the frontmatter title property from the folder note file if it exists
   */
  getFolderNoteTitle(folder) {
    var _a;
    if (!this.plugin.settings.folderNoteFilename || this.plugin.settings.folderNoteFilename.trim() === "") {
      return null;
    }
    const folderNoteFilename = this.plugin.settings.folderNoteFilename.trim();
    const folderNotePath = `${folder.path}/${folderNoteFilename}.md`;
    const folderNoteFile = this.plugin.app.vault.getAbstractFileByPath(folderNotePath);
    if (folderNoteFile instanceof import_obsidian10.TFile) {
      const cache = this.plugin.app.metadataCache.getFileCache(folderNoteFile);
      const propertyValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
      if (propertyValue) {
        return String(propertyValue);
      }
    }
    return null;
  }
  /**
   * Resolve title for a file or folder
   * Public so ExplorerFileItemMutator can access it
   */
  async resolveTitle(item) {
    if (item.file instanceof import_obsidian10.TFile) {
      const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
      if (!isFileTypeSupported2(item.file.extension, this.plugin.settings)) {
        return null;
      }
      const frontmatter = await getFrontmatter2(this.plugin.app, item.file, this.plugin.settings);
      const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
      return propertyValue ? String(propertyValue) : null;
    } else if (item.file instanceof import_obsidian10.TFolder) {
      return this.getFolderNoteTitle(item.file);
    }
    return null;
  }
  /**
   * Update all file explorer items
   */
  updateAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (!this.modified.has(item)) {
        this.modified.set(item, new ExplorerFileItemMutator(item, this));
      }
      item.updateTitle();
    }
  }
  /**
   * Restore all original titles
   */
  restoreAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (this.modified.has(item)) {
        const mutator = this.modified.get(item);
        mutator == null ? void 0 : mutator.destroy();
        this.modified.delete(item);
        item.updateTitle();
      }
    }
  }
  /**
   * Register events and initialize
   */
  registerEvents() {
    if (!this.plugin.settings.enableForExplorer) {
      return;
    }
    this.plugin.app.workspace.onLayoutReady(() => {
      this.explorerView = null;
      this.updateAllItems();
    });
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        this.explorerView = null;
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.explorerView = null;
          setTimeout(() => this.updateAllItems(), 100);
        }
      })
    );
  }
  /**
   * Update explorer when settings change
   */
  updateExplorer() {
    if (this.plugin.settings.enableForExplorer) {
      this.explorerView = null;
      this.registerEvents();
      setTimeout(() => this.updateAllItems(), 100);
    } else {
      this.restoreAllItems();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.restoreAllItems();
    this.explorerView = null;
  }
};
var ExplorerFileItemMutator = class {
  constructor(item, service) {
    this.item = item;
    this.service = service;
    const proto = Object.getPrototypeOf(item);
    this.originalUpdateTitle = proto.updateTitle.bind(item);
    this.originalStartRename = proto.startRename ? proto.startRename.bind(item) : void 0;
    item.updateTitle = this.updateTitle.bind(this);
    if (proto.startRename) {
      item.startRename = this.startRename.bind(this);
    }
  }
  updateTitle() {
    this.originalUpdateTitle();
    if (this.service.plugin.settings.enableForExplorer) {
      void (async () => {
        const title = await this.service.resolveTitle(this.item);
        if (title && title.length > 0) {
          this.item.innerEl.setText(title);
        }
      })();
    }
  }
  startRename() {
    var _a;
    this.item.innerEl.setText(this.item.getTitle());
    return (_a = this.originalStartRename) == null ? void 0 : _a.call(this);
  }
  destroy() {
    const proto = Object.getPrototypeOf(this.item);
    this.item.updateTitle = this.originalUpdateTitle;
    if (proto.startRename && this.originalStartRename) {
      this.item.startRename = this.originalStartRename;
    }
  }
};

// src/services/WindowFrameService.ts
var import_obsidian11 = require("obsidian");
init_frontmatter();
var WindowFrameService = class {
  constructor(plugin) {
    this.originalUpdateTitle = null;
    this.enabled = false;
    this.plugin = plugin;
  }
  /**
   * Get the title for the active file
   */
  getActiveFileTitle() {
    var _a;
    const activeFile = this.plugin.app.workspace.getActiveFile();
    if (activeFile instanceof import_obsidian11.TFile) {
      if (activeFile.extension === "md") {
        const fileCache = this.plugin.app.metadataCache.getFileCache(activeFile);
        const propertyValue = (_a = fileCache == null ? void 0 : fileCache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
        if (propertyValue) {
          return String(propertyValue);
        }
        return activeFile.basename;
      }
      if (activeFile.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
        void (async () => {
          const frontmatter = await getFrontmatter(this.plugin.app, activeFile, this.plugin.settings);
          const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
          if (propertyValue) {
            const app = this.plugin.app;
            if (typeof app.getAppTitle === "function") {
              document.title = app.getAppTitle(String(propertyValue));
            } else {
              const vaultName = this.plugin.app.vault.getName();
              document.title = `${String(propertyValue)} - ${vaultName}`;
            }
          }
        })();
        return activeFile.basename;
      }
      return activeFile.basename;
    }
    return "";
  }
  /**
   * Override updateTitle to use property-based title
   */
  updateTitle() {
    if (!this.enabled) {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
      return;
    }
    const title = this.getActiveFileTitle();
    if (title) {
      const app = this.plugin.app;
      if (typeof app.getAppTitle === "function") {
        document.title = app.getAppTitle(title);
      } else {
        const vaultName = this.plugin.app.vault.getName();
        document.title = `${title} - ${vaultName}`;
      }
    } else {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
    }
  }
  /**
   * Enable the window frame feature
   */
  enable() {
    if (this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle) {
      this.originalUpdateTitle = workspace.updateTitle.bind(workspace);
      workspace.updateTitle = this.updateTitle.bind(this);
      this.updateTitle();
      this.enabled = true;
    }
  }
  /**
   * Disable the window frame feature
   */
  disable() {
    if (!this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle && this.originalUpdateTitle) {
      workspace.updateTitle = this.originalUpdateTitle;
      workspace.updateTitle();
      this.originalUpdateTitle = null;
      this.enabled = false;
    }
  }
  /**
   * Register events for window frame updates
   */
  registerEvents() {
    if (!this.plugin.settings.enableForWindowFrame) {
      return;
    }
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
  }
  /**
   * Update window frame when settings change
   */
  updateWindowFrame() {
    if (this.plugin.settings.enableForWindowFrame) {
      this.enable();
      this.registerEvents();
    } else {
      this.disable();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.disable();
  }
};

// src/main.ts
var PropertyOverFileNamePlugin = class extends import_obsidian12.Plugin {
  async onload() {
    await this.loadSettings();
    this.quickSwitcherService = new QuickSwitcherService(this);
    this.dragDropService = new DragDropService(this);
    this.cacheService = new CacheService(this);
    this.graphViewService = new GraphViewService(this);
    this.backlinkService = new BacklinkService(this);
    this.tabService = new TabService(this);
    this.explorerService = new ExplorerService(this);
    this.windowFrameService = new WindowFrameService(this);
    await this.tabService.registerEvents();
    this.explorerService.registerEvents();
    this.windowFrameService.registerEvents();
    if (this.settings.enableMdxSupport) {
      void (async () => {
        const mdxFiles = this.app.vault.getFiles().filter(
          (f) => f instanceof import_obsidian12.TFile && f.extension === "mdx"
        );
        for (const file of mdxFiles) {
          void frontmatterCache.get(this.app, file, this.settings);
        }
      })();
    }
    setTimeout(() => {
      this.updateLinkSuggester();
      this.updateQuickSwitcher();
      this.updateBacklinks();
      this.updateTabs();
      this.updateExplorer();
      this.updateWindowFrame();
    }, 1e3);
    this.app.workspace.onLayoutReady(() => {
      this.graphViewService.onLayoutChange();
      this.backlinkService.onLayoutChange();
      void this.tabService.renameTabs();
      this.updateExplorer();
      this.updateWindowFrame();
    });
    this.registerEvent(
      this.app.workspace.on("layout-change", () => {
        this.graphViewService.onLayoutChange();
        this.backlinkService.onLayoutChange();
      })
    );
    this.registerEvent(
      this.app.workspace.on("file-open", () => {
        this.backlinkService.onFileOpen();
      })
    );
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian12.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian12.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian12.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("changed", (file) => {
        if (file instanceof import_obsidian12.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.rebuildCache();
          if (this.settings.enableForGraphView) {
            this.graphViewService.refreshGraphView();
          }
          if (this.settings.enableForBacklinks) {
            this.backlinkService.updateBacklinks();
          }
          if (this.settings.enableForExplorer) {
            this.explorerService.updateExplorer();
          }
          if (this.settings.enableForWindowFrame) {
            this.windowFrameService.updateWindowFrame();
          }
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("resolved", () => {
        this.cacheService.rebuildCache();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-drop", (event, editor) => {
        if (this.settings.enableForDragDrop) {
          this.dragDropService.handleDragDrop(event, editor);
        }
      })
    );
    this.registerDomEvent(document, "drop", (event) => {
      if (this.settings.enableForDragDrop) {
        this.dragDropService.handleDOMDrop(event);
      }
    });
    registerCommands(this);
    this.addSettingTab(new SettingTab(this.app, this));
  }
  updateLinkSuggester() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (!editorSuggest) return;
    if (this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
      this.suggest = void 0;
    }
    if (this.settings.enableForLinking) {
      this.suggest = new LinkTitleSuggest(this);
      this.registerEditorSuggest(this.suggest);
      this.cacheService.setSuggest(this.suggest);
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => !s.constructor.name.includes("LinkSuggest"));
      editorSuggest.suggests.unshift(this.suggest);
    }
  }
  updateQuickSwitcher() {
    this.quickSwitcherService.updateQuickSwitcher();
  }
  updateGraphView() {
    this.graphViewService.updateGraphView();
  }
  updateBacklinks() {
    this.backlinkService.updateBacklinks();
  }
  updateTabs() {
    this.tabService.updateTabs();
  }
  updateExplorer() {
    this.explorerService.updateExplorer();
  }
  updateWindowFrame() {
    this.windowFrameService.updateWindowFrame();
  }
  rebuildCache() {
    this.cacheService.rebuildCache();
  }
  onunload() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (editorSuggest && this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
    }
    this.quickSwitcherService.restoreOriginalCommand();
    this.graphViewService.onunload();
    this.backlinkService.onunload();
    this.tabService.onunload();
    this.explorerService.onunload();
    this.windowFrameService.onunload();
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData != null ? loadedData : {});
  }
  async saveSettings(prevQuickSwitcherState, prevTabState) {
    await this.saveData(this.settings);
    if (prevQuickSwitcherState !== void 0 && prevQuickSwitcherState !== this.settings.enableForQuickSwitcher) {
      this.updateQuickSwitcher();
    }
    if (prevTabState !== void 0 && prevTabState !== this.settings.enableForTabs) {
      void this.tabService.registerEvents();
      this.updateTabs();
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3V0aWxzL2Zyb250bWF0dGVyLnRzIiwgInNyYy91dGlscy9zZWFyY2gudHMiLCAic3JjL3VpL1F1aWNrU3dpdGNoTW9kYWwudHMiLCAic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91aS9MaW5rVGl0bGVTdWdnZXN0LnRzIiwgInNyYy91aS9TZXR0aW5nVGFiLnRzIiwgInNyYy91dGlscy9zZXR0aW5ncy1jb21wYXQudHMiLCAic3JjL2NvbW1hbmRzL2luZGV4LnRzIiwgInNyYy9zZXJ2aWNlcy9RdWlja1N3aXRjaGVyU2VydmljZS50cyIsICJzcmMvc2VydmljZXMvRHJhZ0Ryb3BTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9DYWNoZVNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL0dyYXBoVmlld1NlcnZpY2UudHMiLCAic3JjL3V0aWxzL2Zyb250bWF0dGVyLWNhY2hlLnRzIiwgInNyYy9zZXJ2aWNlcy9CYWNrbGlua1NlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL1RhYlNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL0V4cGxvcmVyU2VydmljZS50cyIsICJzcmMvc2VydmljZXMvV2luZG93RnJhbWVTZXJ2aWNlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBURmlsZSwgQXBwLCBwYXJzZVlhbWwgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEdldCBmcm9udG1hdHRlciBmcm9tIGEgZmlsZSwgc3VwcG9ydGluZyBib3RoIC5tZCAodmlhIG1ldGFkYXRhIGNhY2hlKSBhbmQgLm1keCAodmlhIG1hbnVhbCBwYXJzaW5nKVxyXG4gKiBcclxuICogVGhpcyB1dGlsaXR5IGZ1bmN0aW9uIGhhbmRsZXMgdGhlIGZhY3QgdGhhdCBPYnNpZGlhbidzIG1ldGFkYXRhQ2FjaGUgb25seSB3b3JrcyBmb3IgLm1kIGZpbGVzLlxyXG4gKiBGb3IgLm1keCBmaWxlcyAod2hlbiBNRFggc3VwcG9ydCBpcyBlbmFibGVkKSwgd2UgcmVhZCB0aGUgcmF3IGZpbGUgY29udGVudCBhbmQgcGFyc2UgdGhlIGZyb250bWF0dGVyIG1hbnVhbGx5LlxyXG4gKiBcclxuICogQHBhcmFtIGFwcCAtIE9ic2lkaWFuIGFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gZmlsZSAtIFRoZSBmaWxlIHRvIGdldCBmcm9udG1hdHRlciBmcm9tXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFBsdWdpbiBzZXR0aW5ncyAodG8gY2hlY2sgZW5hYmxlTWR4U3VwcG9ydClcclxuICogQHJldHVybnMgVGhlIGZyb250bWF0dGVyIG9iamVjdCwgb3IgbnVsbCBpZiBub3QgZm91bmQvbm90IHN1cHBvcnRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEZyb250bWF0dGVyKFxyXG4gIGFwcDogQXBwLFxyXG4gIGZpbGU6IFRGaWxlLFxyXG4gIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5nc1xyXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbD4ge1xyXG4gIC8vIEZvciAubWQgZmlsZXMsIHVzZSBPYnNpZGlhbidzIG1ldGFkYXRhIGNhY2hlIChmYXN0IGFuZCByZWxpYWJsZSlcclxuICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgIGNvbnN0IGZpbGVDYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgIHJldHVybiBmaWxlQ2FjaGU/LmZyb250bWF0dGVyIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvLyBGb3IgLm1keCBmaWxlcywgb25seSBwcm9jZXNzIGlmIE1EWCBzdXBwb3J0IGlzIGVuYWJsZWRcclxuICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFJlYWQgcmF3IGZpbGUgY29udGVudCAod29ya3MgZm9yIGFueSBmaWxlIHR5cGUpXHJcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEV4dHJhY3QgZnJvbnRtYXR0ZXIgdXNpbmcgcmVnZXggKHNhbWUgZm9ybWF0IGFzIC5tZCBmaWxlcylcclxuICAgICAgLy8gTWF0Y2ggcGF0dGVybjogLS0tXFxuLi4uY29udGVudC4uLlxcbi0tLSAod2l0aCBvciB3aXRob3V0IHRyYWlsaW5nIG5ld2xpbmUpXHJcbiAgICAgIGNvbnN0IGZyb250bWF0dGVyUmVnZXggPSAvXi0tLVxcbihbXFxzXFxTXSo/KVxcbi0tLS87XHJcbiAgICAgIGNvbnN0IG1hdGNoID0gY29udGVudC5tYXRjaChmcm9udG1hdHRlclJlZ2V4KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xyXG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyVGV4dCA9IG1hdGNoWzFdO1xyXG4gICAgICAgIC8vIFBhcnNlIFlBTUwgdXNpbmcgT2JzaWRpYW4ncyBwYXJzZVlhbWwgdXRpbGl0eVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZVlhbWwoZnJvbnRtYXR0ZXJUZXh0KSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGwgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICByZXR1cm4gcGFyc2VkICYmIHR5cGVvZiBwYXJzZWQgPT09ICdvYmplY3QnID8gcGFyc2VkIDogbnVsbDtcclxuICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBGb3Igb3RoZXIgZmlsZSB0eXBlcyBvciBNRFggd2hlbiBzdXBwb3J0IGlzIGRpc2FibGVkLCByZXR1cm4gbnVsbFxyXG4gIHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogU3luY2hyb25vdXMgdmVyc2lvbiB0aGF0IHVzZXMgbWV0YWRhdGEgY2FjaGUgZm9yIC5tZCBmaWxlc1xyXG4gKiBGb3IgLm1keCBmaWxlcywgcmV0dXJucyBudWxsICh1c2UgYXN5bmMgdmVyc2lvbiBpbnN0ZWFkKVxyXG4gKiBcclxuICogQHBhcmFtIGFwcCAtIE9ic2lkaWFuIGFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gZmlsZSAtIFRoZSBmaWxlIHRvIGdldCBmcm9udG1hdHRlciBmcm9tXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFBsdWdpbiBzZXR0aW5ncyAodG8gY2hlY2sgZW5hYmxlTWR4U3VwcG9ydClcclxuICogQHJldHVybnMgVGhlIGZyb250bWF0dGVyIG9iamVjdCwgb3IgbnVsbCBpZiBub3QgZm91bmQvbm90IHN1cHBvcnRlZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZyb250bWF0dGVyU3luYyhcclxuICBhcHA6IEFwcCxcclxuICBmaWxlOiBURmlsZSxcclxuICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3NcclxuKTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCBudWxsIHtcclxuICAvLyBGb3IgLm1kIGZpbGVzLCB1c2UgT2JzaWRpYW4ncyBtZXRhZGF0YSBjYWNoZVxyXG4gIGlmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgY29uc3QgZmlsZUNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgcmV0dXJuIGZpbGVDYWNoZT8uZnJvbnRtYXR0ZXIgfHwgbnVsbDtcclxuICB9XHJcblxyXG4gIC8vIEZvciAubWR4IGZpbGVzLCB3ZSBjYW4ndCB1c2Ugc3luYyB2ZXJzaW9uIChuZWVkIHRvIHJlYWQgZmlsZSlcclxuICAvLyBSZXR1cm4gbnVsbCAtIGNhbGxlciBzaG91bGQgdXNlIGFzeW5jIHZlcnNpb24gaWYgTURYIHN1cHBvcnQgaXMgbmVlZGVkXHJcbiAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiBzZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICByZXR1cm4gbnVsbDsgLy8gSW5kaWNhdGVzIGFzeW5jIHZlcnNpb24gc2hvdWxkIGJlIHVzZWRcclxuICB9XHJcblxyXG4gIHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYSBmaWxlIGV4dGVuc2lvbiBpcyBzdXBwb3J0ZWQgYmFzZWQgb24gc2V0dGluZ3NcclxuICogXHJcbiAqIEBwYXJhbSBleHRlbnNpb24gLSBGaWxlIGV4dGVuc2lvbiAod2l0aG91dCBkb3QpXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFBsdWdpbiBzZXR0aW5nc1xyXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBmaWxlIHR5cGUgaXMgc3VwcG9ydGVkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNGaWxlVHlwZVN1cHBvcnRlZChleHRlbnNpb246IHN0cmluZywgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogYm9vbGVhbiB7XHJcbiAgaWYgKGV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgcmV0dXJuIHRydWU7IC8vIEFsd2F5cyBzdXBwb3J0ZWRcclxuICB9XHJcbiAgaWYgKGV4dGVuc2lvbiA9PT0gJ21keCcpIHtcclxuICAgIHJldHVybiBzZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0O1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBNZXRhZGF0YUNhY2hlLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IENhY2hlZEZpbGVEYXRhLCBQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgaXNGaWxlVHlwZVN1cHBvcnRlZCB9IGZyb20gJy4vZnJvbnRtYXR0ZXInO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZ1enp5TWF0Y2goc3RyOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICBsZXQgaSA9IDA7XHJcbiAgY29uc3QgbG93ZXJTdHIgPSBzdHIudG9Mb3dlckNhc2UoKTtcclxuICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcclxuICBmb3IgKGNvbnN0IGNoYXIgb2YgbG93ZXJRdWVyeSkge1xyXG4gICAgaSA9IGxvd2VyU3RyLmluZGV4T2YoY2hhciwgaSkgKyAxO1xyXG4gICAgaWYgKGkgPT09IDApIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXRjaFNjb3JlKGRpc3BsYXk6IHN0cmluZywgcXVlcnk6IHN0cmluZywgYmFzZW5hbWU6IHN0cmluZywgaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2g6IGJvb2xlYW4pOiBudW1iZXIge1xyXG4gIGxldCBzY29yZSA9IDA7XHJcbiAgY29uc3QgbG93ZXJEaXNwbGF5ID0gZGlzcGxheS50b0xvd2VyQ2FzZSgpO1xyXG4gIGNvbnN0IGxvd2VyQmFzZW5hbWUgPSBiYXNlbmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG4gIFxyXG4gIC8vIEV4YWN0IG1hdGNoZXMgZ2V0IGhpZ2hlc3Qgc2NvcmVcclxuICBpZiAobG93ZXJEaXNwbGF5ID09PSBsb3dlclF1ZXJ5KSBzY29yZSArPSAxMDAwO1xyXG4gIGVsc2UgaWYgKGxvd2VyQmFzZW5hbWUgPT09IGxvd2VyUXVlcnkpIHNjb3JlICs9IDkwMDtcclxuICBcclxuICAvLyBTdGFydHMgd2l0aCBxdWVyeSBnZXRzIGhpZ2ggc2NvcmVcclxuICBlbHNlIGlmIChsb3dlckRpc3BsYXkuc3RhcnRzV2l0aChsb3dlclF1ZXJ5KSkgc2NvcmUgKz0gMTAwO1xyXG4gIGVsc2UgaWYgKGluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIGxvd2VyQmFzZW5hbWUuc3RhcnRzV2l0aChsb3dlclF1ZXJ5KSkgc2NvcmUgKz0gODA7XHJcbiAgXHJcbiAgLy8gQ29udGFpbnMgcXVlcnkgZ2V0cyBtZWRpdW0gc2NvcmVcclxuICBlbHNlIGlmIChsb3dlckRpc3BsYXkuaW5jbHVkZXMobG93ZXJRdWVyeSkpIHNjb3JlICs9IDUwO1xyXG4gIGVsc2UgaWYgKGluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIGxvd2VyQmFzZW5hbWUuaW5jbHVkZXMobG93ZXJRdWVyeSkpIHNjb3JlICs9IDMwO1xyXG4gIFxyXG4gIC8vIFdvcmQgYm91bmRhcnkgbWF0Y2hlcyBnZXQgYm9udXNcclxuICBjb25zdCB3b3JkQm91bmRhcnlSZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHtsb3dlclF1ZXJ5fWAsICdpJyk7XHJcbiAgaWYgKHdvcmRCb3VuZGFyeVJlZ2V4LnRlc3QobG93ZXJEaXNwbGF5KSkgc2NvcmUgKz0gMjA7XHJcbiAgaWYgKGluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIHdvcmRCb3VuZGFyeVJlZ2V4LnRlc3QobG93ZXJCYXNlbmFtZSkpIHNjb3JlICs9IDE1O1xyXG4gIFxyXG4gIC8vIFBlbmFsdHkgZm9yIHZlcnkgbG9uZyBuYW1lc1xyXG4gIGNvbnN0IGxlbmd0aFBlbmFsdHkgPSBNYXRoLm1heCgwLCAoZGlzcGxheS5sZW5ndGggLSBxdWVyeS5sZW5ndGgpICogMC4xKTtcclxuICBzY29yZSAtPSBsZW5ndGhQZW5hbHR5O1xyXG4gIFxyXG4gIHJldHVybiBNYXRoLm1heCgwLCBzY29yZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZEZpbGVDYWNoZShcclxuICBmaWxlczogVEZpbGVbXSwgXHJcbiAgbWV0YWRhdGFDYWNoZTogTWV0YWRhdGFDYWNoZSxcclxuICBhcHA6IEFwcCxcclxuICBwcm9wZXJ0eUtleTogc3RyaW5nLFxyXG4gIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5nc1xyXG4pOiBQcm9taXNlPE1hcDxzdHJpbmcsIENhY2hlZEZpbGVEYXRhPj4ge1xyXG4gIGNvbnN0IGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIENhY2hlZEZpbGVEYXRhPigpO1xyXG4gIGNvbnN0IHsgZ2V0RnJvbnRtYXR0ZXIgfSA9IGF3YWl0IGltcG9ydCgnLi9mcm9udG1hdHRlcicpO1xyXG4gIFxyXG4gIC8vIFByb2Nlc3MgZmlsZXMgaW4gcGFyYWxsZWwgZm9yIGJldHRlciBwZXJmb3JtYW5jZVxyXG4gIGF3YWl0IFByb21pc2UuYWxsKGZpbGVzLm1hcChhc3luYyAoZmlsZSkgPT4ge1xyXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXHJcbiAgICBpZiAoIWlzRmlsZVR5cGVTdXBwb3J0ZWQoZmlsZS5leHRlbnNpb24sIHNldHRpbmdzKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlIHN5bmMgdmVyc2lvbiBmb3IgLm1kIGZpbGVzLCBhc3luYyBmb3IgLm1keCBmaWxlc1xyXG4gICAgbGV0IGZyb250bWF0dGVyOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw7XHJcbiAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgLy8gRm9yIC5tZCBmaWxlcywgdXNlIG1ldGFkYXRhIGNhY2hlIChmYXN0IHN5bmMgYWNjZXNzKVxyXG4gICAgICBjb25zdCBmaWxlQ2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgIGZyb250bWF0dGVyID0gZmlsZUNhY2hlPy5mcm9udG1hdHRlciB8fCBudWxsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gTURYIGZpbGVzIG5lZWQgYXN5bmMgcmVhZGluZ1xyXG4gICAgICBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKGFwcCwgZmlsZSwgc2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBkaXNwbGF5TmFtZSA9IGZpbGUuYmFzZW5hbWU7XHJcbiAgICBsZXQgaXNDdXN0b21EaXNwbGF5ID0gZmFsc2U7XHJcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbcHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbcHJvcGVydHlLZXldICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWVSYXcgPSBmcm9udG1hdHRlcltwcm9wZXJ0eUtleV07XHJcbiAgICAgIGxldCBwcm9wZXJ0eVZhbHVlOiBzdHJpbmc7XHJcbiAgICAgIGlmICh0eXBlb2YgcHJvcGVydHlWYWx1ZVJhdyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBwcm9wZXJ0eVZhbHVlID0gcHJvcGVydHlWYWx1ZVJhdy50cmltKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb3BlcnR5VmFsdWVSYXcgPT09ICdudW1iZXInIHx8IHR5cGVvZiBwcm9wZXJ0eVZhbHVlUmF3ID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKHByb3BlcnR5VmFsdWVSYXcpLnRyaW0oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBTa2lwIG9iamVjdHMvYXJyYXlzIC0gdGhleSBjYW4ndCBiZSB1c2VkIGFzIGRpc3BsYXkgbmFtZXNcclxuICAgICAgICBwcm9wZXJ0eVZhbHVlID0gJyc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgJiYgcHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcclxuICAgICAgICBkaXNwbGF5TmFtZSA9IHByb3BlcnR5VmFsdWU7XHJcbiAgICAgICAgaXNDdXN0b21EaXNwbGF5ID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChmcm9udG1hdHRlcj8uYWxpYXNlcykge1xyXG4gICAgICBjb25zdCBhbGlhc2VzUmF3ID0gZnJvbnRtYXR0ZXIuYWxpYXNlcyBhcyB1bmtub3duO1xyXG4gICAgICBhbGlhc2VzID0gQXJyYXkuaXNBcnJheShhbGlhc2VzUmF3KSA/IGFsaWFzZXNSYXcubWFwKGEgPT4gU3RyaW5nKGEpKSA6IFtTdHJpbmcoYWxpYXNlc1JhdyldO1xyXG4gICAgICBhbGlhc2VzID0gYWxpYXNlcy5tYXAoYWxpYXMgPT4gYWxpYXMudHJpbSgpKS5maWx0ZXIoYWxpYXMgPT4gYWxpYXMgIT09ICcnKTtcclxuICAgIH1cclxuXHJcbiAgICBjYWNoZS5zZXQoZmlsZS5wYXRoLCB7XHJcbiAgICAgIGZpbGUsXHJcbiAgICAgIGRpc3BsYXlOYW1lLFxyXG4gICAgICBhbGlhc2VzLFxyXG4gICAgICBsYXN0TW9kaWZpZWQ6IGZpbGUuc3RhdC5tdGltZSxcclxuICAgICAgaXNDdXN0b21EaXNwbGF5XHJcbiAgICB9KTtcclxuICB9KSk7XHJcbiAgXHJcbiAgcmV0dXJuIGNhY2hlO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBNYXJrZG93blZpZXcsIE5vdGljZSwgVEZpbGUsIHByZXBhcmVGdXp6eVNlYXJjaCwgcHJlcGFyZVNpbXBsZVNlYXJjaCwgRnV6enlNYXRjaCwgc29ydFNlYXJjaFJlc3VsdHMsIFNlYXJjaFJlc3VsdCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUXVpY2tTd2l0Y2hJdGVtLCBDYWNoZWRGaWxlRGF0YSwgU2VhcmNoTWF0Y2hSZWFzb24sIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VJbnRlcm5hbCwgUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlLCBVbnJlc29sdmVkTGlua0l0ZW0sIE5ld05vdGVJdGVtLCBBcHBJbnRlcm5hbCB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgYnVpbGRGaWxlQ2FjaGUgfSBmcm9tICcuLi91dGlscy9zZWFyY2gnO1xyXG5pbXBvcnQgeyBnZXRGcm9udG1hdHRlclN5bmMgfSBmcm9tICcuLi91dGlscy9mcm9udG1hdHRlcic7XHJcblxyXG5leHBvcnQgY2xhc3MgUXVpY2tTd2l0Y2hNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddPiB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgZmlsZUNhY2hlOiBNYXA8c3RyaW5nLCBDYWNoZWRGaWxlRGF0YT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSByZWNlbnRGaWxlczogVEZpbGVbXSA9IFtdO1xyXG4gIHByaXZhdGUgc2VhcmNoVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBtYXRjaFJlYXNvbnM6IE1hcDxzdHJpbmcsIFNlYXJjaE1hdGNoUmVhc29uPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIHRoaXMubGltaXQgPSA4OyAvLyBMaW1pdCB0byA4IGl0ZW1zIGZvciBjb21mb3J0YWJsZSBkaXNwbGF5XHJcbiAgICBcclxuICAgIC8vIFNldCBwbGFjZWhvbGRlciBiYXNlZCBvbiBzZXR0aW5nXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xyXG4gICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKCdUeXBlIHRvIHNlYXJjaCBub3RlcyBieSB0aXRsZSBvciBmaWxlIG5hbWUuLi4nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1R5cGUgdG8gc2VhcmNoIGZpbGVzLi4uJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHZvaWQgdGhpcy5idWlsZEZpbGVDYWNoZSgpO1xyXG4gICAgdGhpcy51cGRhdGVSZWNlbnRGaWxlcygpO1xyXG4gICAgdGhpcy5hZGRLZXlib2FyZE5hdmlnYXRpb24oKTtcclxuICAgIHRoaXMuYWRkRm9vdGVyKCk7XHJcbiAgICBcclxuICAgIC8vIE9ubHkgYWRkIHNjb3BpbmcgY2xhc3Mgd2hlbiBlbmFibGVkXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xyXG4gICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKCdwcm9wZXJ0eS1vdmVyLWZpbGVuYW1lLW1vZGFsJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZEtleWJvYXJkTmF2aWdhdGlvbigpOiB2b2lkIHtcclxuICAgIC8vIEFkZCBlc2NhcGUga2V5IGhhbmRsaW5nXHJcbiAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRGb290ZXIoKTogdm9pZCB7XHJcbiAgICAvLyBGaW5kIHRoZSAucHJvbXB0IGNvbnRhaW5lciBhbmQgYWRkIGZvb3RlciBpbnNpZGUgaXRcclxuICAgIGNvbnN0IHByb21wdENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnByb21wdCcpO1xyXG4gICAgaWYgKHByb21wdENvbnRhaW5lcikge1xyXG4gICAgICBjb25zdCBmb290ZXIgPSBwcm9tcHRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9ucycgfSk7XHJcbiAgICAgIC8vIENyZWF0ZSBuYXZpZ2F0aW9uIGluc3RydWN0aW9ucyB1c2luZyBET00gQVBJXHJcbiAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IFtcclxuICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxOTFcdTIxOTMnLCBhY3Rpb246ICd0byBuYXZpZ2F0ZScgfSxcclxuICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxQjUnLCBhY3Rpb246ICd0byBvcGVuJyB9LFxyXG4gICAgICAgIHsgY29tbWFuZDogJ2N0cmwgXHUyMUI1JywgYWN0aW9uOiAndG8gb3BlbiBpbiBuZXcgdGFiJyB9LFxyXG4gICAgICAgIHsgY29tbWFuZDogJ2N0cmwgYWx0IFx1MjFCNScsIGFjdGlvbjogJ3RvIG9wZW4gdG8gdGhlIHJpZ2h0JyB9LFxyXG4gICAgICAgIHsgY29tbWFuZDogJ3NoaWZ0IFx1MjFCNScsIGFjdGlvbjogJ3RvIGNyZWF0ZScgfSxcclxuICAgICAgICB7IGNvbW1hbmQ6ICdlc2MnLCBhY3Rpb246ICd0byBkaXNtaXNzJyB9XHJcbiAgICAgIF07XHJcbiAgICAgIFxyXG4gICAgICBpbnN0cnVjdGlvbnMuZm9yRWFjaCgoeyBjb21tYW5kLCBhY3Rpb24gfSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gZm9vdGVyLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogY29tbWFuZCB9KTtcclxuICAgICAgICBpbnN0cnVjdGlvbi5jcmVhdGVTcGFuKHsgdGV4dDogYWN0aW9uIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGJ1aWxkRmlsZUNhY2hlKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgZmlsZXMgPSB0aGlzLmdldEZpbHRlcmVkRmlsZXMoKTtcclxuICAgIHRoaXMuZmlsZUNhY2hlID0gYXdhaXQgYnVpbGRGaWxlQ2FjaGUoXHJcbiAgICAgIGZpbGVzLFxyXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLFxyXG4gICAgICB0aGlzLmFwcCxcclxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXksXHJcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVGaWxlQ2FjaGUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHsgZ2V0RnJvbnRtYXR0ZXIsIGlzRmlsZVR5cGVTdXBwb3J0ZWQgfSA9IGF3YWl0IGltcG9ydCgnLi4vdXRpbHMvZnJvbnRtYXR0ZXInKTtcclxuICAgIFxyXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXHJcbiAgICBpZiAoIWlzRmlsZVR5cGVTdXBwb3J0ZWQoZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBhd2FpdCBnZXRGcm9udG1hdHRlcih0aGlzLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgbGV0IGRpc3BsYXlOYW1lID0gZmlsZS5iYXNlbmFtZTtcclxuICAgIGxldCBpc0N1c3RvbURpc3BsYXkgPSBmYWxzZTtcclxuICAgIGxldCBhbGlhc2VzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0pLnRyaW0oKTtcclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgZGlzcGxheU5hbWUgPSBwcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgIGlzQ3VzdG9tRGlzcGxheSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZnJvbnRtYXR0ZXI/LmFsaWFzZXMpIHtcclxuICAgICAgY29uc3QgYWxpYXNlc1JhdyA9IGZyb250bWF0dGVyLmFsaWFzZXMgYXMgdW5rbm93bjtcclxuICAgICAgYWxpYXNlcyA9IEFycmF5LmlzQXJyYXkoYWxpYXNlc1JhdykgPyBhbGlhc2VzUmF3Lm1hcChhID0+IFN0cmluZyhhKSkgOiBbU3RyaW5nKGFsaWFzZXNSYXcpXTtcclxuICAgICAgYWxpYXNlcyA9IGFsaWFzZXMubWFwKGFsaWFzID0+IGFsaWFzLnRyaW0oKSkuZmlsdGVyKGFsaWFzID0+IGFsaWFzICE9PSAnJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5maWxlQ2FjaGUuc2V0KGZpbGUucGF0aCwge1xyXG4gICAgICBmaWxlLFxyXG4gICAgICBkaXNwbGF5TmFtZSxcclxuICAgICAgYWxpYXNlcyxcclxuICAgICAgbGFzdE1vZGlmaWVkOiBmaWxlLnN0YXQubXRpbWUsXHJcbiAgICAgIGlzQ3VzdG9tRGlzcGxheVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZVJlY2VudEZpbGVzKCk6IHZvaWQge1xyXG4gICAgLy8gVXNlIE9ic2lkaWFuJ3MgaW50ZXJuYWwgcmVjZW50IGZpbGVzIG1lY2hhbmlzbSBmb3IgcGVyZmVjdCBjb21wYXRpYmlsaXR5XHJcbiAgICBsZXQgcmVjZW50RmlsZXM6IFRGaWxlW10gPSBbXTtcclxuICAgIFxyXG4gICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5hcHAud29ya3NwYWNlIGFzIHVua25vd24gYXMgV29ya3NwYWNlSW50ZXJuYWwgJiB7IHJlY2VudEZpbGVUcmFja2VyPzogeyBnZXRMYXN0T3BlbkZpbGVzKCk6IHN0cmluZ1tdIH0gfTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgUXVpY2sgU3dpdGNoZXIgc2V0dGluZ3MgdG8gZGV0ZXJtaW5lIHdoYXQgZmlsZSB0eXBlcyB0byBpbmNsdWRlXHJcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcclxuICAgIGNvbnN0IHNob3dBdHRhY2htZW50cyA9IHF1aWNrU3dpdGNoZXJPcHRpb25zPy5zaG93QXR0YWNobWVudHMgPz8gdHJ1ZTtcclxuICAgIFxyXG4gICAgLy8gQWNjZXNzIE9ic2lkaWFuJ3MgcmVjZW50RmlsZVRyYWNrZXIgdG8gZ2V0IHRoZSBzYW1lIGZpbGVzIGFzIGRlZmF1bHQgcXVpY2sgc3dpdGNoZXJcclxuICAgIGlmICh3b3Jrc3BhY2UucmVjZW50RmlsZVRyYWNrZXI/LmdldExhc3RPcGVuRmlsZXMpIHtcclxuICAgICAgY29uc3QgbGFzdE9wZW5GaWxlcyA9IHdvcmtzcGFjZS5yZWNlbnRGaWxlVHJhY2tlci5nZXRMYXN0T3BlbkZpbGVzKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb252ZXJ0IGZpbGUgcGF0aHMgdG8gVEZpbGUgb2JqZWN0c1xyXG4gICAgICByZWNlbnRGaWxlcyA9IGxhc3RPcGVuRmlsZXNcclxuICAgICAgICAubWFwKChmaWxlUGF0aDogc3RyaW5nKSA9PiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpKVxyXG4gICAgICAgIC5maWx0ZXIoKGZpbGU6IHVua25vd24pOiBmaWxlIGlzIFRGaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZhbGxiYWNrIGlmIHJlY2VudEZpbGVUcmFja2VyIGlzIG5vdCBhdmFpbGFibGVcclxuICAgIGlmIChyZWNlbnRGaWxlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc3Qgb3BlbkZpbGVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKVxyXG4gICAgICAgIC5tYXAobGVhZiA9PiBsZWFmLnZpZXcpXHJcbiAgICAgICAgLmZpbHRlcigodmlldyk6IHZpZXcgaXMgTWFya2Rvd25WaWV3ID0+IHZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpXHJcbiAgICAgICAgLm1hcCh2aWV3ID0+IHZpZXcuZmlsZSlcclxuICAgICAgICAuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlICE9PSBudWxsKVxyXG4gICAgICAgIC5maWx0ZXIoKGZpbGUsIGluZGV4LCBzZWxmKSA9PiBzZWxmLmluZGV4T2YoZmlsZSkgPT09IGluZGV4KTtcclxuICAgICAgXHJcbiAgICAgIHJlY2VudEZpbGVzID0gWy4uLm9wZW5GaWxlc107XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZpbHRlciBiYXNlZCBvbiBRdWljayBTd2l0Y2hlciBzZXR0aW5ncyBCRUZPUkUgYmFja2ZpbGxpbmdcclxuICAgIGlmICghc2hvd0F0dGFjaG1lbnRzKSB7XHJcbiAgICAgIC8vIEZpbHRlciBvdXQgYXR0YWNobWVudHMgLSBvbmx5IHNob3cgbWFya2Rvd24gZmlsZXMgKGFuZCBNRFggaWYgZW5hYmxlZClcclxuICAgICAgcmVjZW50RmlsZXMgPSByZWNlbnRGaWxlcy5maWx0ZXIoZmlsZSA9PiBcclxuICAgICAgICBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCBcclxuICAgICAgICAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEFsd2F5cyBiYWNrZmlsbCB0byA4IGl0ZW1zIChvciBhcyBtYW55IGFzIGF2YWlsYWJsZSlcclxuICAgIGNvbnN0IHRhcmdldENvdW50ID0gODtcclxuICAgIGNvbnN0IGV4aXN0aW5nUGF0aHMgPSBuZXcgU2V0KHJlY2VudEZpbGVzLm1hcChmID0+IGYucGF0aCkpO1xyXG4gICAgXHJcbiAgICBpZiAocmVjZW50RmlsZXMubGVuZ3RoIDwgdGFyZ2V0Q291bnQpIHtcclxuICAgICAgaWYgKHNob3dBdHRhY2htZW50cykge1xyXG4gICAgICAgIC8vIEluY2x1ZGUgYWxsIGZpbGUgdHlwZXMgKG1hcmtkb3duICsgYXR0YWNobWVudHMpXHJcbiAgICAgICAgY29uc3QgYWxsRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZmlsZSk6IGZpbGUgaXMgVEZpbGUgPT4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlKTtcclxuICAgICAgICBjb25zdCBhZGRpdGlvbmFsRmlsZXMgPSBhbGxGaWxlc1xyXG4gICAgICAgICAgLmZpbHRlcihmaWxlID0+ICFleGlzdGluZ1BhdGhzLmhhcyhmaWxlLnBhdGgpKVxyXG4gICAgICAgICAgLnNsaWNlKDAsIHRhcmdldENvdW50IC0gcmVjZW50RmlsZXMubGVuZ3RoKTtcclxuICAgICAgICByZWNlbnRGaWxlcy5wdXNoKC4uLmFkZGl0aW9uYWxGaWxlcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gT25seSBtYXJrZG93biBmaWxlcyAoYW5kIE1EWCBpZiBlbmFibGVkKVxyXG4gICAgICAgIGNvbnN0IGFsbE1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgY29uc3QgbWR4RmlsZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0XHJcbiAgICAgICAgICA/IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIChmKTogZiBpcyBURmlsZSA9PiBmIGluc3RhbmNlb2YgVEZpbGUgJiYgZi5leHRlbnNpb24gPT09ICdtZHgnXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgIDogW107XHJcbiAgICAgICAgY29uc3QgYWxsU3VwcG9ydGVkRmlsZXMgPSBbLi4uYWxsTWFya2Rvd25GaWxlcywgLi4ubWR4RmlsZXNdO1xyXG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxGaWxlcyA9IGFsbFN1cHBvcnRlZEZpbGVzXHJcbiAgICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWV4aXN0aW5nUGF0aHMuaGFzKGZpbGUucGF0aCkpXHJcbiAgICAgICAgICAuc2xpY2UoMCwgdGFyZ2V0Q291bnQgLSByZWNlbnRGaWxlcy5sZW5ndGgpO1xyXG4gICAgICAgIHJlY2VudEZpbGVzLnB1c2goLi4uYWRkaXRpb25hbEZpbGVzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBMaW1pdCB0byA4IGZpbGVzXHJcbiAgICB0aGlzLnJlY2VudEZpbGVzID0gcmVjZW50RmlsZXMuc2xpY2UoMCwgdGFyZ2V0Q291bnQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbXMoKTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ11bXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRGaWx0ZXJlZEZpbGVzKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZpbHRlcmVkRmlsZXMoKTogVEZpbGVbXSB7XHJcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcclxuICAgIFxyXG4gICAgLy8gU3RhcnQgd2l0aCBtYXJrZG93biBmaWxlc1xyXG4gICAgbGV0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgXHJcbiAgICAvLyBBZGQgTURYIGZpbGVzIGlmIE1EWCBzdXBwb3J0IGlzIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgIGNvbnN0IG1keEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoXHJcbiAgICAgICAgKGYpOiBmIGlzIFRGaWxlID0+IGYgaW5zdGFuY2VvZiBURmlsZSAmJiBmLmV4dGVuc2lvbiA9PT0gJ21keCdcclxuICAgICAgKTtcclxuICAgICAgZmlsZXMgPSBbLi4uZmlsZXMsIC4uLm1keEZpbGVzXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSWYgd2UgY2FuIGFjY2VzcyBRdWljayBTd2l0Y2hlciBvcHRpb25zIGFuZCBhdHRhY2htZW50cyBhcmUgZW5hYmxlZCwgaW5jbHVkZSB0aGVtXHJcbiAgICBpZiAocXVpY2tTd2l0Y2hlck9wdGlvbnM/LnNob3dBdHRhY2htZW50cykge1xyXG4gICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xyXG4gICAgICAvLyBJbmNsdWRlIG1hcmtkb3duIGZpbGVzLCBNRFggZmlsZXMgKGlmIGVuYWJsZWQpLCBhbmQgYXR0YWNobWVudHNcclxuICAgICAgZmlsZXMgPSBhbGxGaWxlcy5maWx0ZXIoKGZpbGUpOiBmaWxlIGlzIFRGaWxlID0+IFxyXG4gICAgICAgIGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiAoXHJcbiAgICAgICAgICBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCBcclxuICAgICAgICAgIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkgfHxcclxuICAgICAgICAgIHRoaXMuaXNBdHRhY2htZW50KGZpbGUpXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgLy8gSWYgc2hvd0F0dGFjaG1lbnRzIGlzIGZhbHNlIG9yIHdlIGNhbid0IGFjY2VzcyBvcHRpb25zLCBvbmx5IHNob3cgbWFya2Rvd24gZmlsZXMgKGFuZCBNRFggaWYgZW5hYmxlZClcclxuXHJcbiAgICByZXR1cm4gZmlsZXM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzQXR0YWNobWVudChmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgYXR0YWNobWVudEV4dGVuc2lvbnMgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdnaWYnLCAnc3ZnJywgJ3dlYnAnLCAncGRmJywgJ21wNCcsICdtcDMnLCAnd2F2JywgJ29nZycsICd3ZWJtJ107XHJcbiAgICByZXR1cm4gYXR0YWNobWVudEV4dGVuc2lvbnMuaW5jbHVkZXMoZmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFF1aWNrU3dpdGNoZXJPcHRpb25zKCk6IFF1aWNrU3dpdGNoZXJQbHVnaW5JbnN0YW5jZVsnb3B0aW9ucyddIHwgbnVsbCB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBY2Nlc3MgdGhlIGludGVybmFsIFF1aWNrIFN3aXRjaGVyIHBsdWdpbiB0aGUgc2FtZSB3YXkgUXVpY2sgU3dpdGNoICsrIGRvZXNcclxuICAgICAgY29uc3QgaW50ZXJuYWxQbHVnaW5zID0gKHRoaXMuYXBwIGFzIHVua25vd24gYXMgQXBwSW50ZXJuYWwpLmludGVybmFsUGx1Z2lucztcclxuICAgICAgaWYgKCFpbnRlcm5hbFBsdWdpbnMpIHJldHVybiBudWxsO1xyXG4gICAgICBcclxuICAgICAgY29uc3Qgc3dpdGNoZXJQbHVnaW4gPSBpbnRlcm5hbFBsdWdpbnMuZ2V0UGx1Z2luQnlJZD8uKCdzd2l0Y2hlcicpO1xyXG4gICAgICBpZiAoIXN3aXRjaGVyUGx1Z2luIHx8ICFzd2l0Y2hlclBsdWdpbi5pbnN0YW5jZSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gc3dpdGNoZXJQbHVnaW4uaW5zdGFuY2Uub3B0aW9ucyB8fCBudWxsO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbVRleHQoaXRlbTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10pOiBzdHJpbmcge1xyXG4gICAgaWYgKCdpc05ld05vdGUnIGluIGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0ubmV3TmFtZTsgLy8gSnVzdCByZXR1cm4gdGhlIG5hbWUsIE9ic2lkaWFuIHdpbGwgaGFuZGxlIHRoZSBcIkVudGVyIHRvIGNyZWF0ZVwiIHRleHRcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKCdpc1VucmVzb2x2ZWQnIGluIGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0udW5yZXNvbHZlZFRleHQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFdoZW4gZGlzYWJsZWQsIHNob3cganVzdCB0aGUgZmlsZSBuYW1lIGxpa2UgZGVmYXVsdCBPYnNpZGlhblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKSB7XHJcbiAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBkaXNwbGF5ID0gdGhpcy5nZXREaXNwbGF5TmFtZShpdGVtKTtcclxuICAgIHJldHVybiBkaXNwbGF5O1xyXG4gIH1cclxuXHJcbiAgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBzdHJpbmcge1xyXG4gICAgLy8gVHJ5IHRvIGdldCBmcm9tIGNhY2hlIGZpcnN0IChmYXN0LCB3b3JrcyBmb3IgYm90aCBNRCBhbmQgTURYIGlmIGNhY2hlZClcclxuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuZmlsZUNhY2hlLmdldChmaWxlLnBhdGgpO1xyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICByZXR1cm4gY2FjaGVkLmRpc3BsYXlOYW1lO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGYWxsYmFjazogdXNlIHN5bmMgdmVyc2lvbiBmb3IgLm1kIGZpbGVzLCBvciByZXR1cm4gYmFzZW5hbWUgZm9yIC5tZHggKHdpbGwgYmUgY2FjaGVkIGFzeW5jKVxyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBnZXRGcm9udG1hdHRlclN5bmModGhpcy5hcHAsIGZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgIFxyXG4gICAgaWYgKGZyb250bWF0dGVyKSB7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV07XHJcbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSB1bmRlZmluZWQgJiYgcHJvcGVydHlWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IHRyaW1tZWQgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlLnRyaW0oKSA6ICh0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdib29sZWFuJyA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6ICcnKS50cmltKCk7XHJcbiAgICAgICAgaWYgKHRyaW1tZWQgIT09ICcnKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJpbW1lZDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGZpbGUuYmFzZW5hbWU7XHJcbiAgfVxyXG5cclxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcclxuICAgICAgLy8gV2hlbiBkaXNhYmxlZCwgdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3IgLSBzaG93IGFsbCBmaWxlcyB3aXRoIGRlZmF1bHQgc2VhcmNoXHJcbiAgICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFzZWFyY2hRdWVyeSkge1xyXG4gICAgICAgIC8vIFNob3cgcmVjZW50IGZpbGVzIGxpa2UgZGVmYXVsdCBPYnNpZGlhblxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlY2VudEZpbGVzUmVzdWx0cygpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBVc2UgZGVmYXVsdCBPYnNpZGlhbiBzZWFyY2ggLSBqdXN0IHNob3cgZmlsZXMgd2l0aCBmaWxlIG5hbWUgbWF0Y2hpbmdcclxuICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmdldEZpbHRlcmVkRmlsZXMoKTtcclxuICAgICAgY29uc3Qgc2VhcmNoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU2ltcGxlU2VhcmNoIFxyXG4gICAgICAgID8gcHJlcGFyZVNpbXBsZVNlYXJjaChzZWFyY2hRdWVyeSlcclxuICAgICAgICA6IHByZXBhcmVGdXp6eVNlYXJjaChzZWFyY2hRdWVyeSk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdHM6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10gPSBbXTtcclxuICAgICAgXHJcbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gc2VhcmNoKGZpbGUuYmFzZW5hbWUpID8/IHsgc2NvcmU6IDAsIG1hdGNoZXM6IFtdIH07XHJcbiAgICAgICAgaWYgKG1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHsgaXRlbTogZmlsZSwgbWF0Y2ggfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XHJcbiAgICAgIHNvcnRTZWFyY2hSZXN1bHRzKHJlc3VsdHMpO1xyXG4gICAgICBcclxuICAgICAgLy8gQWx3YXlzIGFkZCBuZXcgbm90ZSBvcHRpb24gaWYgbm8gcmVzdWx0c1xyXG4gICAgICAvLyBcIlNob3cgZXhpc3Rpbmcgb25seVwiIG9ubHkgYWZmZWN0cyBzaG93aW5nIHVucmVzb2x2ZWQgbGlua3MsIG5vdCBjcmVhdGluZyBuZXcgbm90ZXNcclxuICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29uc3QgbmV3SXRlbTogTmV3Tm90ZUl0ZW0gPSB7IGlzTmV3Tm90ZTogdHJ1ZSwgbmV3TmFtZTogc2VhcmNoUXVlcnkgfTtcclxuICAgICAgICByZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgaXRlbTogbmV3SXRlbSxcclxuICAgICAgICAgIG1hdGNoOiB7IHNjb3JlOiAxMDAwLCBtYXRjaGVzOiBbWzAsIHNlYXJjaFF1ZXJ5Lmxlbmd0aF1dIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiByZXN1bHRzLnNsaWNlKDAsIHRoaXMubGltaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xyXG4gICAgXHJcbiAgICAvLyBDbGVhciBwcmV2aW91cyB0aW1lb3V0XHJcbiAgICBpZiAodGhpcy5zZWFyY2hUaW1lb3V0KSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNlYXJjaFRpbWVvdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIHF1ZXJ5LCBzaG93IHJlY2VudCBmaWxlc1xyXG4gICAgaWYgKCFzZWFyY2hRdWVyeSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5nZXRSZWNlbnRGaWxlc1Jlc3VsdHMoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5wZXJmb3JtU2VhcmNoKHNlYXJjaFF1ZXJ5KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UmVjZW50RmlsZXNSZXN1bHRzKCk6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10ge1xyXG4gICAgLy8gVXBkYXRlIHJlY2VudCBmaWxlcyAodGhpcyBhbHJlYWR5IGhhbmRsZXMgZmlsdGVyaW5nIGFuZCBiYWNrZmlsbGluZylcclxuICAgIHRoaXMudXBkYXRlUmVjZW50RmlsZXMoKTtcclxuICAgIFxyXG4gICAgLy8gQ2xlYXIgbWF0Y2ggcmVhc29ucyBmb3IgcmVjZW50IGZpbGVzIHNpbmNlIHRoZXkncmUgbm90IHNlYXJjaCByZXN1bHRzXHJcbiAgICB0aGlzLm1hdGNoUmVhc29ucy5jbGVhcigpO1xyXG4gICAgXHJcbiAgICAvLyBSZXR1cm4gdGhlIHJlY2VudCBmaWxlcyAoYWxyZWFkeSBmaWx0ZXJlZCBhbmQgYmFja2ZpbGxlZCBpbiB1cGRhdGVSZWNlbnRGaWxlcylcclxuICAgIHJldHVybiB0aGlzLnJlY2VudEZpbGVzLm1hcChmaWxlID0+ICh7XHJcbiAgICAgIGl0ZW06IGZpbGUsXHJcbiAgICAgIG1hdGNoOiB7IHNjb3JlOiAxMDAwLCBtYXRjaGVzOiBbXSB9XHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBlcmZvcm1TZWFyY2goc2VhcmNoUXVlcnk6IHN0cmluZyk6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10ge1xyXG4gICAgLy8gVXNlIHNpbXBsZSBzZWFyY2ggZm9yIGxhcmdlIHZhdWx0cyBpZiBlbmFibGVkLCBvdGhlcndpc2UgdXNlIGZ1enp5IHNlYXJjaFxyXG4gICAgY29uc3Qgc2VhcmNoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU2ltcGxlU2VhcmNoIFxyXG4gICAgICA/IHByZXBhcmVTaW1wbGVTZWFyY2goc2VhcmNoUXVlcnkpXHJcbiAgICAgIDogcHJlcGFyZUZ1enp5U2VhcmNoKHNlYXJjaFF1ZXJ5KTtcclxuICAgIGNvbnN0IHJlc3VsdHM6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10gPSBbXTtcclxuICAgIHRoaXMubWF0Y2hSZWFzb25zLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIG1hdGNoIHJlYXNvbnNcclxuXHJcbiAgICAvLyBVc2UgY2FjaGVkIGRhdGEgZm9yIG11Y2ggZmFzdGVyIHNlYXJjaFxyXG4gICAgZm9yIChjb25zdCBjYWNoZWREYXRhIG9mIHRoaXMuZmlsZUNhY2hlLnZhbHVlcygpKSB7XHJcbiAgICAgIGNvbnN0IHsgZmlsZSwgZGlzcGxheU5hbWUsIGFsaWFzZXMsIGlzQ3VzdG9tRGlzcGxheSB9ID0gY2FjaGVkRGF0YTtcclxuICAgICAgXHJcbiAgICAgIC8vIFRyYWNrIHdoaWNoIGZpZWxkcyBjYXVzZWQgdGhlIG1hdGNoXHJcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uOiBTZWFyY2hNYXRjaFJlYXNvbiA9IHtcclxuICAgICAgICBtYXRjaGVkSW5UaXRsZTogZmFsc2UsXHJcbiAgICAgICAgbWF0Y2hlZEluRmlsZW5hbWU6IGZhbHNlLFxyXG4gICAgICAgIG1hdGNoZWRJbkFsaWFzOiBmYWxzZVxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgLy8gUHJpbWFyeSBtYXRjaDogc2VhcmNoIHRpdGxlL3Byb3BlcnR5IGZpcnN0IChvbmx5IGlmIG5vdGUgaGFzIGN1c3RvbSBkaXNwbGF5KVxyXG4gICAgICBsZXQgcHJpbWFyeU1hdGNoOiBTZWFyY2hSZXN1bHQgfCBudWxsID0gbnVsbDtcclxuICAgICAgbGV0IGJlc3RNYXRjaDogU2VhcmNoUmVzdWx0IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgIGxldCBtYXRjaFR5cGU6ICd0aXRsZScgfCAnZmlsZW5hbWUnIHwgJ2FsaWFzJyB8IG51bGwgPSBudWxsO1xyXG4gICAgICBcclxuICAgICAgaWYgKGlzQ3VzdG9tRGlzcGxheSkge1xyXG4gICAgICAgIC8vIE9ubHkgc2VhcmNoIHRpdGxlL3Byb3BlcnR5IGlmIG5vdGUgYWN0dWFsbHkgaGFzIGEgY3VzdG9tIHByb3BlcnR5XHJcbiAgICAgICAgcHJpbWFyeU1hdGNoID0gc2VhcmNoKGRpc3BsYXlOYW1lKTtcclxuICAgICAgICBpZiAocHJpbWFyeU1hdGNoICYmIHByaW1hcnlNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlID0gdHJ1ZTtcclxuICAgICAgICAgIGJlc3RNYXRjaCA9IHByaW1hcnlNYXRjaDtcclxuICAgICAgICAgIG1hdGNoVHlwZSA9ICd0aXRsZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBJZiBubyB0aXRsZSBtYXRjaCAob3Igbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHkpLCBzZWFyY2ggZmlsZW5hbWVcclxuICAgICAgaWYgKCFtYXRjaFR5cGUpIHtcclxuICAgICAgICAvLyBTZWFyY2ggZmlsZW5hbWUgaWYgaXQncyBkaWZmZXJlbnQgZnJvbSBkaXNwbGF5TmFtZSwgb3IgaWYgbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHlcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgZmlsZS5iYXNlbmFtZSAhPT0gZGlzcGxheU5hbWUpIHtcclxuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lTWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSk7XHJcbiAgICAgICAgICBpZiAoZmlsZW5hbWVNYXRjaCAmJiBmaWxlbmFtZU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIERvd25yYW5rIGZpbGVuYW1lIG1hdGNoZXMgYnkgLTFcclxuICAgICAgICAgICAgYmVzdE1hdGNoID0geyAuLi5maWxlbmFtZU1hdGNoLCBzY29yZTogZmlsZW5hbWVNYXRjaC5zY29yZSAtIDEgfTtcclxuICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2ZpbGVuYW1lJztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKCFpc0N1c3RvbURpc3BsYXkpIHtcclxuICAgICAgICAgIC8vIElmIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5LCBkaXNwbGF5TmFtZSBlcXVhbHMgZmlsZW5hbWUsIHNvIHNlYXJjaCBmaWxlbmFtZVxyXG4gICAgICAgICAgY29uc3QgZmlsZW5hbWVNYXRjaCA9IHNlYXJjaChmaWxlLmJhc2VuYW1lKTtcclxuICAgICAgICAgIGlmIChmaWxlbmFtZU1hdGNoICYmIGZpbGVuYW1lTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lID0gdHJ1ZTtcclxuICAgICAgICAgICAgYmVzdE1hdGNoID0gZmlsZW5hbWVNYXRjaDtcclxuICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2ZpbGVuYW1lJztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFRlcnRpYXJ5IG1hdGNoOiBzZWFyY2ggYWxpYXNlcyAod2l0aCBkb3ducmFua2luZylcclxuICAgICAgaWYgKCFtYXRjaFR5cGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUFsaWFzZXNJblNlYXJjaCAmJiBhbGlhc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGFsaWFzIG9mIGFsaWFzZXMpIHtcclxuICAgICAgICAgIGNvbnN0IGFsaWFzTWF0Y2ggPSBzZWFyY2goYWxpYXMpO1xyXG4gICAgICAgICAgaWYgKGFsaWFzTWF0Y2ggJiYgYWxpYXNNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMgPSB0cnVlO1xyXG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0ID0gYWxpYXM7IC8vIFN0b3JlIHdoaWNoIGFsaWFzIG1hdGNoZWRcclxuICAgICAgICAgICAgLy8gRG93bnJhbmsgYWxpYXMgbWF0Y2hlcyBieSAtMVxyXG4gICAgICAgICAgICBiZXN0TWF0Y2ggPSB7IC4uLmFsaWFzTWF0Y2gsIHNjb3JlOiBhbGlhc01hdGNoLnNjb3JlIC0gMSB9O1xyXG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnYWxpYXMnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIElmIHdlIGhhdmUgYW55IG1hdGNoLCBhZGQgdG8gcmVzdWx0c1xyXG4gICAgICBpZiAoYmVzdE1hdGNoICYmIGJlc3RNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXN1bHRzLnB1c2goeyBpdGVtOiBmaWxlLCBtYXRjaDogYmVzdE1hdGNoIH0pO1xyXG4gICAgICAgIHRoaXMubWF0Y2hSZWFzb25zLnNldChmaWxlLnBhdGgsIG1hdGNoUmVhc29uKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCB1bnJlc29sdmVkIGxpbmtzIGlmIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgaXMgZGlzYWJsZWRcclxuICAgIC8vIFRoaXMgbWF0Y2hlcyBRdWljayBTd2l0Y2ggKysgYmVoYXZpb3I6IHVucmVzb2x2ZWQ6ICFzZXR0aW5ncy5zaG93RXhpc3RpbmdPbmx5XHJcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcclxuICAgIGNvbnN0IHNob3dFeGlzdGluZ09ubHkgPSBxdWlja1N3aXRjaGVyT3B0aW9ucz8uc2hvd0V4aXN0aW5nT25seSA/PyBmYWxzZTtcclxuICAgIFxyXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XHJcbiAgICAgIC8vIEdldCB1bnJlc29sdmVkIGxpbmtzIGZyb20gbWV0YWRhdGEgY2FjaGUgKGxpa2UgUXVpY2sgU3dpdGNoICsrIGRvZXMpXHJcbiAgICAgIGNvbnN0IHsgdW5yZXNvbHZlZExpbmtzIH0gPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlO1xyXG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb2xsZWN0IGFsbCB1bnJlc29sdmVkIGxpbmtzIGZyb20gYWxsIGZpbGVzXHJcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcclxuICAgICAgICBjb25zdCBsaW5rcyA9IE9iamVjdC5rZXlzKHVucmVzb2x2ZWRMaW5rc1tzb3VyY2VQYXRoXSk7XHJcbiAgICAgICAgbGlua3MuZm9yRWFjaChsaW5rID0+IHVucmVzb2x2ZWRTZXQuYWRkKGxpbmspKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gU2VhcmNoIHVucmVzb2x2ZWQgbGlua3MgYW5kIGFkZCBtYXRjaGVzXHJcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XHJcbiAgICAgICAgY29uc3QgdW5yZXNvbHZlZE1hdGNoID0gc2VhcmNoKHVucmVzb2x2ZWQpO1xyXG4gICAgICAgIGlmICh1bnJlc29sdmVkTWF0Y2ggJiYgdW5yZXNvbHZlZE1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxyXG4gICAgICAgICAgLy8gVXNlIGEgc3BlY2lhbCBvYmplY3QgdG8gcmVwcmVzZW50IHVucmVzb2x2ZWQgbGlua3NcclxuICAgICAgICAgIGNvbnN0IHVucmVzb2x2ZWRJdGVtOiBVbnJlc29sdmVkTGlua0l0ZW0gPSB7IGlzVW5yZXNvbHZlZDogdHJ1ZSwgdW5yZXNvbHZlZFRleHQ6IHVucmVzb2x2ZWQgfTtcclxuICAgICAgICAgIHJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICAgIGl0ZW06IHVucmVzb2x2ZWRJdGVtLFxyXG4gICAgICAgICAgICBtYXRjaDogdW5yZXNvbHZlZE1hdGNoXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XHJcbiAgICAgIHNvcnRTZWFyY2hSZXN1bHRzKHJlc3VsdHMpO1xyXG4gICAgICBcclxuICAgICAgLy8gRmlsdGVyIG91dCB1bnJlc29sdmVkIGxpbmtzIGlmIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgaXMgZW5hYmxlZFxyXG4gICAgICAvLyBVbnJlc29sdmVkIGxpbmtzIGFyZSBpdGVtcyB3aXRoIGlzVW5yZXNvbHZlZCBwcm9wZXJ0eSwgYnV0IGtlZXAgXCJjcmVhdGUgbmV3IG5vdGVcIiBvcHRpb25zXHJcbiAgICAgIGxldCBmaWx0ZXJlZFJlc3VsdHMgPSByZXN1bHRzO1xyXG4gICAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xyXG4gICAgICAgIGZpbHRlcmVkUmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4ge1xyXG4gICAgICAgICAgLy8gS2VlcCBmaWxlcyBhbmQgbmV3IG5vdGUgaXRlbXMsIGZpbHRlciBvdXQgdW5yZXNvbHZlZCBsaW5rc1xyXG4gICAgICAgICAgcmV0dXJuIHIuaXRlbSBpbnN0YW5jZW9mIFRGaWxlIHx8ICgnaXNOZXdOb3RlJyBpbiByLml0ZW0gJiYgci5pdGVtLmlzTmV3Tm90ZSA9PT0gdHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciBleGFjdCBtYXRjaGVzIGluIGV4aXN0aW5nIGZpbGVzXHJcbiAgICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBzZWFyY2hRdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICBsZXQgZXhhY3RNYXRjaCA9IGZpbHRlcmVkUmVzdWx0cy5zb21lKHIgPT4gXHJcbiAgICAgICAgci5pdGVtIGluc3RhbmNlb2YgVEZpbGUgJiYgKFxyXG4gICAgICAgICAgdGhpcy5nZXREaXNwbGF5TmFtZShyLml0ZW0pLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyUXVlcnkgfHxcclxuICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiByLml0ZW0uYmFzZW5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbG93ZXJRdWVyeSkgfHxcclxuICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlQWxpYXNlc0luU2VhcmNoICYmIHRoaXMuZmlsZUNhY2hlLmdldChyLml0ZW0ucGF0aCk/LmFsaWFzZXMuc29tZShhbGlhcyA9PiBhbGlhcy50b0xvd2VyQ2FzZSgpID09PSBsb3dlclF1ZXJ5KSlcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBBbHNvIGNoZWNrIHVucmVzb2x2ZWQgbGlua3MgaWYgdGhleSdyZSBiZWluZyBzaG93blxyXG4gICAgICBpZiAoIXNob3dFeGlzdGluZ09ubHkgJiYgIWV4YWN0TWF0Y2gpIHtcclxuICAgICAgICBjb25zdCB7IHVucmVzb2x2ZWRMaW5rcyB9ID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZTtcclxuICAgICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgICAgZm9yIChjb25zdCBzb3VyY2VQYXRoIGluIHVucmVzb2x2ZWRMaW5rcykge1xyXG4gICAgICAgICAgY29uc3QgbGlua3MgPSBPYmplY3Qua2V5cyh1bnJlc29sdmVkTGlua3Nbc291cmNlUGF0aF0pO1xyXG4gICAgICAgICAgbGlua3MuZm9yRWFjaChsaW5rID0+IHVucmVzb2x2ZWRTZXQuYWRkKGxpbmspKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgcXVlcnkgZXhhY3RseSBtYXRjaGVzIGFueSB1bnJlc29sdmVkIGxpbmtcclxuICAgICAgICBleGFjdE1hdGNoID0gQXJyYXkuZnJvbSh1bnJlc29sdmVkU2V0KS5zb21lKGxpbmsgPT4gbGluay50b0xvd2VyQ2FzZSgpID09PSBsb3dlclF1ZXJ5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQWx3YXlzIGFkZCBuZXcgbm90ZSBvcHRpb24gaWYgbm8gZXhhY3QgbWF0Y2ggZXhpc3RzXHJcbiAgICAgIC8vIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgb25seSBhZmZlY3RzIHNob3dpbmcgdW5yZXNvbHZlZCBsaW5rcywgbm90IGNyZWF0aW5nIG5ldyBub3Rlc1xyXG4gICAgICBpZiAoIWV4YWN0TWF0Y2ggJiYgc2VhcmNoUXVlcnkpIHtcclxuICAgICAgICBjb25zdCBuZXdJdGVtOiBOZXdOb3RlSXRlbSA9IHsgaXNOZXdOb3RlOiB0cnVlLCBuZXdOYW1lOiBzZWFyY2hRdWVyeSB9O1xyXG4gICAgICAgIGZpbHRlcmVkUmVzdWx0cy51bnNoaWZ0KHtcclxuICAgICAgICAgIGl0ZW06IG5ld0l0ZW0sXHJcbiAgICAgICAgICBtYXRjaDogeyBzY29yZTogMTAwMCwgbWF0Y2hlczogW1swLCBzZWFyY2hRdWVyeS5sZW5ndGhdXSB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZmlsdGVyZWRSZXN1bHRzLnNsaWNlKDAsIHRoaXMubGltaXQpO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIHVwZGF0aW5nIHF1aWNrIHN3aXRjaGVyIHN1Z2dlc3Rpb25zLiBQbGVhc2UgY2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy4nKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyU3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBGdXp6eU1hdGNoPFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddPiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGl0ZW0gfSA9IHN1Z2dlc3Rpb247XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSB1bnJlc29sdmVkIGxpbmtzIC0gc2hvdyBmaWxlLXBsdXMgaWNvbiBpbnN0ZWFkIG9mIFwiRW50ZXIgdG8gY3JlYXRlXCIgdGV4dFxyXG4gICAgaWYgKCdpc1VucmVzb2x2ZWQnIGluIGl0ZW0gJiYgaXRlbS5pc1VucmVzb2x2ZWQpIHtcclxuICAgICAgY29uc3QgdW5yZXNvbHZlZFRleHQgPSBpdGVtLnVucmVzb2x2ZWRUZXh0O1xyXG4gICAgICBlbC5lbXB0eSgpO1xyXG4gICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcclxuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xyXG4gICAgICBjb25zdCBzdWdnZXN0aW9uVGl0bGUgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcclxuICAgICAgc3VnZ2VzdGlvblRpdGxlLnNldFRleHQodW5yZXNvbHZlZFRleHQpO1xyXG4gICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xyXG4gICAgICBjb25zdCBzdWdnZXN0aW9uRmxhaXIgPSBzdWdnZXN0aW9uQXV4LmNyZWF0ZVNwYW4oeyBcclxuICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdVbnJlc29sdmVkIGxpbmsgLSBFbnRlciB0byBjcmVhdGUnIH0gXHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmNyZWF0ZUZpbGVQbHVzSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHRleHQgPSB0aGlzLmdldEl0ZW1UZXh0KGl0ZW0pO1xyXG4gICAgXHJcbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xyXG4gICAgICAvLyBGb3IgbmV3IG5vdGVzLCB1c2UgdGhlIGV4YWN0IEhUTUwgc3RydWN0dXJlIGZyb20gZGVmYXVsdCBPYnNpZGlhblxyXG4gICAgICBlbC5lbXB0eSgpO1xyXG4gICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIE1haW4gc3VnZ2VzdGlvbiBjb250ZW50XHJcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcclxuICAgICAgY29uc3Qgc3VnZ2VzdGlvblRpdGxlID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XHJcbiAgICAgIHN1Z2dlc3Rpb25UaXRsZS5zZXRUZXh0KHRleHQpO1xyXG4gICAgICBcclxuICAgICAgLy8gQWRkIFwiRW50ZXIgdG8gY3JlYXRlXCIgdGV4dCBvbiB0aGUgcmlnaHQgdXNpbmcgdGhlIGNvcnJlY3QgY2xhc3NcclxuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcclxuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkFjdGlvbiA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IGNsczogJ3N1Z2dlc3Rpb24tYWN0aW9uJyB9KTtcclxuICAgICAgc3VnZ2VzdGlvbkFjdGlvbi5zZXRUZXh0KCdFbnRlciB0byBjcmVhdGUnKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBXaGVuIGRpc2FibGVkLCB1c2UgZGVmYXVsdCBPYnNpZGlhbiBzdHlsaW5nIChubyBjdXN0b20gY2xhc3NlcyBvciBpY29ucylcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xyXG4gICAgICAvLyBVc2UgZGVmYXVsdCBPYnNpZGlhbiBzaW5nbGUtbGluZSBkaXNwbGF5XHJcbiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICBlbC5zZXRUZXh0KGl0ZW0ucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVsLnNldFRleHQodGV4dCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFdoZW4gZW5hYmxlZCwgdXNlIG91ciBjdXN0b20gc3R5bGluZyB3aXRoIGljb25zXHJcbiAgICAgIC8vIE9ubHkgc2hvdyBpY29ucyBmb3IgVEZpbGUgaXRlbXMsIG5vdCB1bnJlc29sdmVkIGxpbmtzXHJcbiAgICAgIGlmICghKGl0ZW0gaW5zdGFuY2VvZiBURmlsZSkpIHtcclxuICAgICAgICBlbC5zZXRUZXh0KHRleHQpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBmaWxlIGhhcyBhIGN1c3RvbSBwcm9wZXJ0eVxyXG4gICAgICBjb25zdCBjYWNoZWREYXRhID0gdGhpcy5maWxlQ2FjaGUuZ2V0KGl0ZW0ucGF0aCk7XHJcbiAgICAgIGNvbnN0IGlzQ3VzdG9tRGlzcGxheSA9IGNhY2hlZERhdGE/LmlzQ3VzdG9tRGlzcGxheSA/PyBmYWxzZTtcclxuICAgICAgY29uc3QgbWF0Y2hSZWFzb24gPSB0aGlzLm1hdGNoUmVhc29ucy5nZXQoaXRlbS5wYXRoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFNwZWNpYWwgY2FzZTogbm90ZXMgd2l0aG91dCBwcm9wZXJ0eSB0aGF0IG1hdGNoZWQgdmlhIGFsaWFzIHNob3VsZCBzaG93IGFsaWFzIHdpdGggaWNvblxyXG4gICAgICBpZiAoIWlzQ3VzdG9tRGlzcGxheSAmJiBtYXRjaFJlYXNvbj8ubWF0Y2hlZEluQWxpYXMgJiYgbWF0Y2hSZWFzb24ubWF0Y2hlZEFsaWFzVGV4dCkge1xyXG4gICAgICAgIC8vIFNob3cgYWxpYXMgYXMgbWFpbiB0ZXh0LCBmaWxlbmFtZSBiZWxvdywgd2l0aCBhbGlhcyBpY29uIChsaWtlIGRlZmF1bHQgT2JzaWRpYW4pXHJcbiAgICAgICAgZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XHJcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE1haW4gdGl0bGUgLSBzaG93IHRoZSBhbGlhcyB0aGF0IG1hdGNoZWRcclxuICAgICAgICBjb25zdCB0aXRsZUVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XHJcbiAgICAgICAgdGl0bGVFbC5zZXRUZXh0KG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZpbGUgcGF0aCBiZWxvd1xyXG4gICAgICAgIGNvbnN0IHBhdGhFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tbm90ZScgfSk7XHJcbiAgICAgICAgcGF0aEVsLnNldFRleHQoaXRlbS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIHN1Z2dlc3Rpb24tYXV4IHdpdGggYWxpYXMgaWNvblxyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XHJcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkZsYWlyID0gc3VnZ2VzdGlvbkF1eC5jcmVhdGVTcGFuKHsgXHJcbiAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ0FsaWFzIE1hdGNoJyB9IFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlRm9yd2FyZEljb24oc3VnZ2VzdGlvbkZsYWlyKTtcclxuICAgICAgfSBlbHNlIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcclxuICAgICAgICAvLyBOb3RlcyB3aXRoIHRoZSBwcm9wZXJ0eSAtIGtlZXAgZXhpc3RpbmcgYmVoYXZpb3JcclxuICAgICAgICBjb25zdCBzaG91bGRTaG93SWNvbiA9IG1hdGNoUmVhc29uICYmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSB8fCBtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSB8fCBtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHNob3VsZFNob3dJY29uKSB7XHJcbiAgICAgICAgICAvLyBBZGQgbW9kLWNvbXBsZXggY2xhc3MgdG8gbWF0Y2ggT2JzaWRpYW4ncyBzdHJ1Y3R1cmVcclxuICAgICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG5cclxuICAgICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBzdWdnZXN0aW9uIGNvbnRhaW5lclxyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBNYWluIHRpdGxlXHJcbiAgICAgICAgICBjb25zdCB0aXRsZUVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XHJcbiAgICAgICAgICB0aXRsZUVsLnNldFRleHQodGV4dCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIEZpbGUgcGF0aCBiZWxvd1xyXG4gICAgICAgICAgY29uc3QgcGF0aEVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1ub3RlJyB9KTtcclxuICAgICAgICAgIHBhdGhFbC5zZXRUZXh0KGl0ZW0ucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhcHByb3ByaWF0ZSBpY29uIGJhc2VkIG9uIG1hdGNoIHJlYXNvblxyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcclxuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxyXG4gICAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiB0aGlzLmdldEljb25MYWJlbChtYXRjaFJlYXNvbikgfSBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBEZXRlcm1pbmUgaWNvbiBiYXNlZCBvbiBwcmlvcml0eTogdGl0bGUgPiBmaWxlIG5hbWUgPiBhbGlhc1xyXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XHJcbiAgICAgICAgICAgIC8vIFR5cGUgaWNvbiBmb3IgdGl0bGUvcHJvcGVydHkgbWF0Y2hlc1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVR5cGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XHJcbiAgICAgICAgICAgIC8vIEZpbGUgaWNvbiBmb3IgZmlsZSBuYW1lIG1hdGNoZXNcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVGaWxlSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xyXG4gICAgICAgICAgICAvLyBBcnJvdyBpY29uIGZvciBhbGlhcyBtYXRjaGVzXHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlRm9yd2FyZEljb24oc3VnZ2VzdGlvbkZsYWlyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gTm90ZSBoYXMgcHJvcGVydHkgYnV0IG5vIG1hdGNoIHJlYXNvbiAoZS5nLiwgcmVjZW50IGZpbGVzKVxyXG4gICAgICAgICAgLy8gU2hvdyBjb21wbGV4IGxheW91dCB3aXRoIGljb24gaWYgdXNpbmcgcHJvcGVydHktYmFzZWQgdGl0bGVcclxuICAgICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xyXG4gICAgICAgICAgY29uc3QgdGl0bGVFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xyXG4gICAgICAgICAgdGl0bGVFbC5zZXRUZXh0KHRleHQpO1xyXG4gICAgICAgICAgY29uc3QgcGF0aEVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1ub3RlJyB9KTtcclxuICAgICAgICAgIHBhdGhFbC5zZXRUZXh0KGl0ZW0ucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBTaG93IFwiVFwiIGljb24gZm9yIHByb3BlcnR5LWJhc2VkIHRpdGxlc1xyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcclxuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxyXG4gICAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnUHJvcGVydHktYmFzZWQgdGl0bGUnIH0gXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHRoaXMuY3JlYXRlVHlwZUljb24oc3VnZ2VzdGlvbkZsYWlyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRm9yIG5vdGVzIHdpdGhvdXQgdGhlIHByb3BlcnR5IChhbmQgbm90IG1hdGNoZWQgdmlhIGFsaWFzKSwgc2hvdyBzaW1wbGUgZGlzcGxheSAobm8gaWNvbiwgbm8gZHVwbGljYXRlIG5hbWUpXHJcbiAgICAgICAgZWwuc2V0VGV4dCh0ZXh0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRJY29uTGFiZWwobWF0Y2hSZWFzb246IFNlYXJjaE1hdGNoUmVhc29uKTogc3RyaW5nIHtcclxuICAgIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSkge1xyXG4gICAgICByZXR1cm4gJ1RpdGxlL1Byb3BlcnR5IE1hdGNoJztcclxuICAgIH0gZWxzZSBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUpIHtcclxuICAgICAgcmV0dXJuICdGaWxlIE5hbWUgTWF0Y2gnO1xyXG4gICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xyXG4gICAgICByZXR1cm4gJ0FsaWFzIE1hdGNoJztcclxuICAgIH1cclxuICAgIHJldHVybiAnTWF0Y2gnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVUeXBlSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcclxuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtdHlwZScpO1xyXG4gICAgXHJcbiAgICBjb25zdCBwb2x5bGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XHJcbiAgICBwb2x5bGluZTEuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnNCA3IDQgNCAyMCA0IDIwIDcnKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTEpO1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICc5Jyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kxJywgJzIwJyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzE1Jyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQobGluZTEpO1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MScsICcxMicpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MScsICc0Jyk7XHJcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzEyJyk7XHJcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQobGluZTIpO1xyXG4gICAgXHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRmlsZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZpbGUtdGV4dCcpO1xyXG4gICAgXHJcbiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XHJcbiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsICdNMTQuNSAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWNy41TDE0LjUgMnonKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcclxuICAgIFxyXG4gICAgY29uc3QgcG9seWxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xyXG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUxKTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcclxuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDEnLCAnMTYnKTtcclxuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTEnLCAnMTMnKTtcclxuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnOCcpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcxMycpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTYnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTcnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDInLCAnOCcpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcxNycpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcclxuICAgIFxyXG4gICAgY29uc3QgcG9seWxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xyXG4gICAgcG9seWxpbmUyLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzEwLDkgOSw5IDgsOScpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMik7XHJcbiAgICBcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVGb3J3YXJkSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcclxuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZm9yd2FyZCcpO1xyXG4gICAgXHJcbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcclxuICAgIHBvbHlsaW5lLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE1IDE3IDIwIDEyIDE1IDcnKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcclxuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ000IDE4di0yYTQgNCAwIDAgMSA0LTRoMTInKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcclxuICAgIFxyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUZpbGVQbHVzSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcclxuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZmlsZS1wbHVzJyk7XHJcbiAgICBcclxuICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcclxuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xyXG4gICAgXHJcbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcclxuICAgIHBvbHlsaW5lLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUpO1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICcxMicpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcxOCcpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MicsICcxMicpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcxMicpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnOScpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MScsICcxNScpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MicsICcxNScpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcxNScpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcclxuICAgIFxyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzVXNpbmdDdXN0b21Qcm9wZXJ0eShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xyXG4gICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHVua25vd247XHJcbiAgICBpZiAocHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHByb3BlcnR5VmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc3RyVmFsdWUgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlIDogKHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ2Jvb2xlYW4nID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogJycpO1xyXG4gICAgcmV0dXJuIHN0clZhbHVlLnRyaW0oKSAhPT0gJyc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzVXNpbmdBbGlhcyhmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBmaWxlIGhhcyBhbGlhc2VzIGFuZCBpZiB3ZSdyZSBjdXJyZW50bHkgc2VhcmNoaW5nXHJcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XHJcbiAgICBjb25zdCBhbGlhc2VzID0gZnJvbnRtYXR0ZXI/LmFsaWFzZXMgYXMgdW5rbm93bjtcclxuICAgIFxyXG4gICAgaWYgKCFhbGlhc2VzKSByZXR1cm4gZmFsc2U7XHJcbiAgICBcclxuICAgIC8vIEZvciBub3csIHNob3cgYWxpYXMgaWNvbiBpZiB0aGUgZmlsZSBoYXMgYWxpYXNlcyBhbmQgd2UncmUgbm90IHVzaW5nIGEgY3VzdG9tIHByb3BlcnR5XHJcbiAgICBjb25zdCBpc1VzaW5nQ3VzdG9tUHJvcGVydHkgPSB0aGlzLmlzVXNpbmdDdXN0b21Qcm9wZXJ0eShmaWxlKTtcclxuICAgIHJldHVybiAhaXNVc2luZ0N1c3RvbVByb3BlcnR5ICYmIEJvb2xlYW4oYWxpYXNlcyk7XHJcbiAgfVxyXG5cclxuICBvbkNob29zZUl0ZW0oaXRlbTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuICAgIC8vIEhhbmRsZSB1bnJlc29sdmVkIGxpbmtzIC0gY3JlYXRlIHRoZSBmaWxlIHVzaW5nIG9wZW5MaW5rVGV4dCB0byByZXNwZWN0IG5ldyBub3RlIGxvY2F0aW9uIHNldHRpbmdzXHJcbiAgICBpZiAoJ2lzVW5yZXNvbHZlZCcgaW4gaXRlbSAmJiBpdGVtLmlzVW5yZXNvbHZlZCkge1xyXG4gICAgICBjb25zdCB1bnJlc29sdmVkVGV4dCA9IGl0ZW0udW5yZXNvbHZlZFRleHQ7XHJcbiAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICBjb25zdCBzb3VyY2VQYXRoID0gYWN0aXZlVmlldz8uZmlsZT8ucGF0aCB8fCAnJztcclxuICAgICAgXHJcbiAgICAgIC8vIFVzZSBvcGVuTGlua1RleHQgd2hpY2ggcmVzcGVjdHMgT2JzaWRpYW4ncyBkZWZhdWx0IG5ldyBub3RlIGxvY2F0aW9uIHNldHRpbmdzXHJcbiAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh1bnJlc29sdmVkVGV4dCwgc291cmNlUGF0aCkuY2F0Y2goKGVycjogdW5rbm93bikgPT4ge1xyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogU3RyaW5nKGVycik7XHJcbiAgICAgICAgbmV3IE5vdGljZShgRXJyb3IgY3JlYXRpbmcgbm90ZTogJHttZXNzYWdlfWApO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xyXG4gICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgY29uc3Qgc291cmNlUGF0aCA9IGFjdGl2ZVZpZXc/LmZpbGU/LnBhdGggfHwgJyc7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVc2Ugb3BlbkxpbmtUZXh0IHdoaWNoIHJlc3BlY3RzIE9ic2lkaWFuJ3MgZGVmYXVsdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xyXG4gICAgICB2b2lkIHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoaXRlbS5uZXdOYW1lLCBzb3VyY2VQYXRoKS5jYXRjaCgoZXJyOiB1bmtub3duKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBTdHJpbmcoZXJyKTtcclxuICAgICAgICBuZXcgTm90aWNlKGBFcnJvciBjcmVhdGluZyBub3RlOiAke21lc3NhZ2V9YCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBtb2RpZmllciBrZXlzIGxpa2UgZGVmYXVsdCBPYnNpZGlhblxyXG4gICAgICBpZiAoZXZ0IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGlmIChldnQuY3RybEtleSAmJiBldnQuYWx0S2V5KSB7XHJcbiAgICAgICAgICAvLyBPcGVuIHRvIHRoZSByaWdodFxyXG4gICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xyXG4gICAgICAgICAgdm9pZCBsZWFmLm9wZW5GaWxlKGl0ZW0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZ0LmN0cmxLZXkpIHtcclxuICAgICAgICAgIC8vIE9wZW4gaW4gbmV3IHRhYlxyXG4gICAgICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGl0ZW0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZ0LnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAvLyBDcmVhdGUgbmV3IG5vdGUgKHRoaXMgc2hvdWxkbid0IGhhcHBlbiBmb3IgZXhpc3RpbmcgZmlsZXMsIGJ1dCBrZWVwaW5nIGZvciBjb25zaXN0ZW5jeSlcclxuICAgICAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShpdGVtKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gRGVmYXVsdDogb3BlbiBpbiBjdXJyZW50IHRhYlxyXG4gICAgICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBNb3VzZSBjbGljazogZGVmYXVsdCBiZWhhdmlvclxyXG4gICAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShpdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IFBsdWdpbiwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzLCBXb3Jrc3BhY2VJbnRlcm5hbCwgRWRpdG9yU3VnZ2VzdCB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IExpbmtUaXRsZVN1Z2dlc3QgfSBmcm9tICcuL3VpL0xpbmtUaXRsZVN1Z2dlc3QnO1xyXG5pbXBvcnQgeyBTZXR0aW5nVGFiIH0gZnJvbSAnLi91aS9TZXR0aW5nVGFiJztcclxuaW1wb3J0IHsgcmVnaXN0ZXJDb21tYW5kcyB9IGZyb20gJy4vY29tbWFuZHMnO1xyXG5pbXBvcnQgeyBRdWlja1N3aXRjaGVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvUXVpY2tTd2l0Y2hlclNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEcmFnRHJvcFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL0RyYWdEcm9wU2VydmljZSc7XHJcbmltcG9ydCB7IENhY2hlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvQ2FjaGVTZXJ2aWNlJztcclxuaW1wb3J0IHsgR3JhcGhWaWV3U2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvR3JhcGhWaWV3U2VydmljZSc7XHJcbmltcG9ydCB7IEJhY2tsaW5rU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvQmFja2xpbmtTZXJ2aWNlJztcclxuaW1wb3J0IHsgVGFiU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvVGFiU2VydmljZSc7XHJcbmltcG9ydCB7IEV4cGxvcmVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvRXhwbG9yZXJTZXJ2aWNlJztcclxuaW1wb3J0IHsgV2luZG93RnJhbWVTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9XaW5kb3dGcmFtZVNlcnZpY2UnO1xyXG5pbXBvcnQgeyBmcm9udG1hdHRlckNhY2hlIH0gZnJvbSAnLi91dGlscy9mcm9udG1hdHRlci1jYWNoZSc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgc2V0dGluZ3MhOiBQbHVnaW5TZXR0aW5ncztcclxuICBzdWdnZXN0PzogTGlua1RpdGxlU3VnZ2VzdDtcclxuICBwcml2YXRlIHF1aWNrU3dpdGNoZXJTZXJ2aWNlITogUXVpY2tTd2l0Y2hlclNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBkcmFnRHJvcFNlcnZpY2UhOiBEcmFnRHJvcFNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBjYWNoZVNlcnZpY2UhOiBDYWNoZVNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBncmFwaFZpZXdTZXJ2aWNlITogR3JhcGhWaWV3U2VydmljZTtcclxuICBwcml2YXRlIGJhY2tsaW5rU2VydmljZSE6IEJhY2tsaW5rU2VydmljZTtcclxuICBwcml2YXRlIHRhYlNlcnZpY2UhOiBUYWJTZXJ2aWNlO1xyXG4gIHByaXZhdGUgZXhwbG9yZXJTZXJ2aWNlITogRXhwbG9yZXJTZXJ2aWNlO1xyXG4gIHByaXZhdGUgd2luZG93RnJhbWVTZXJ2aWNlITogV2luZG93RnJhbWVTZXJ2aWNlO1xyXG5cclxuICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG4gICAgXHJcbiAgICAvLyBJbml0aWFsaXplIHNlcnZpY2VzXHJcbiAgICB0aGlzLnF1aWNrU3dpdGNoZXJTZXJ2aWNlID0gbmV3IFF1aWNrU3dpdGNoZXJTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy5kcmFnRHJvcFNlcnZpY2UgPSBuZXcgRHJhZ0Ryb3BTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy5jYWNoZVNlcnZpY2UgPSBuZXcgQ2FjaGVTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlID0gbmV3IEdyYXBoVmlld1NlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLmJhY2tsaW5rU2VydmljZSA9IG5ldyBCYWNrbGlua1NlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLnRhYlNlcnZpY2UgPSBuZXcgVGFiU2VydmljZSh0aGlzKTtcclxuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlID0gbmV3IEV4cGxvcmVyU2VydmljZSh0aGlzKTtcclxuICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlID0gbmV3IFdpbmRvd0ZyYW1lU2VydmljZSh0aGlzKTtcclxuICAgIFxyXG4gICAgLy8gUmVnaXN0ZXIgdGFiIHNlcnZpY2UgZXZlbnRzIGFuZCByZW5hbWUgdGFicyBpbW1lZGlhdGVseVxyXG4gICAgYXdhaXQgdGhpcy50YWJTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICBcclxuICAgIC8vIFJlZ2lzdGVyIGV4cGxvcmVyIGFuZCB3aW5kb3cgZnJhbWUgc2VydmljZXNcclxuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICB0aGlzLndpbmRvd0ZyYW1lU2VydmljZS5yZWdpc3RlckV2ZW50cygpO1xyXG4gICAgXHJcbiAgICAvLyBQcmUtcG9wdWxhdGUgZnJvbnRtYXR0ZXIgY2FjaGUgZm9yIE1EWCBmaWxlcyBpZiBlbmFibGVkXHJcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBtZHhGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKFxyXG4gICAgICAgICAgKGYpOiBmIGlzIFRGaWxlID0+IGYgaW5zdGFuY2VvZiBURmlsZSAmJiBmLmV4dGVuc2lvbiA9PT0gJ21keCdcclxuICAgICAgICApO1xyXG4gICAgICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZSBpbiBiYWNrZ3JvdW5kXHJcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIG1keEZpbGVzKSB7XHJcbiAgICAgICAgICB2b2lkIGZyb250bWF0dGVyQ2FjaGUuZ2V0KHRoaXMuYXBwLCBmaWxlLCB0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2FpdCBhIGJpdCBmb3IgbWV0YWRhdGEgY2FjaGUgdG8gYmUgZnVsbHkgcG9wdWxhdGVkXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlUXVpY2tTd2l0Y2hlcigpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICB0aGlzLnVwZGF0ZVRhYnMoKTtcclxuICAgICAgdGhpcy51cGRhdGVFeHBsb3JlcigpO1xyXG4gICAgICB0aGlzLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuXHJcbiAgICAvLyBTZXQgdXAgZ3JhcGggdmlldyBoYW5kbGluZ1xyXG4gICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG4gICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcclxuICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcclxuICAgICAgdm9pZCB0aGlzLnRhYlNlcnZpY2UucmVuYW1lVGFicygpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlLm9uTGF5b3V0Q2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gU2V0IHVwIGJhY2tsaW5rcyBoYW5kbGluZ1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtb3BlbicsICgpID0+IHtcclxuICAgICAgICB0aGlzLmJhY2tsaW5rU2VydmljZS5vbkZpbGVPcGVuKCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGZpbGUgY2hhbmdlIGV2ZW50cyB0byBpbnZhbGlkYXRlIGNhY2hlXHJcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSkpIHtcclxuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLmludmFsaWRhdGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgIC8vIEFsc28gaW52YWxpZGF0ZSBmcm9udG1hdHRlciBjYWNoZVxyXG4gICAgICAgICAgZnJvbnRtYXR0ZXJDYWNoZS5pbnZhbGlkYXRlKGZpbGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSkpIHtcclxuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLmludmFsaWRhdGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgIC8vIEFsc28gaW52YWxpZGF0ZSBmcm9udG1hdHRlciBjYWNoZVxyXG4gICAgICAgICAgZnJvbnRtYXR0ZXJDYWNoZS5pbnZhbGlkYXRlKGZpbGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSkpIHtcclxuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLmludmFsaWRhdGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgIC8vIEFsc28gaW52YWxpZGF0ZSBmcm9udG1hdHRlciBjYWNoZVxyXG4gICAgICAgICAgZnJvbnRtYXR0ZXJDYWNoZS5pbnZhbGlkYXRlKGZpbGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBSZWdpc3RlciBtZXRhZGF0YSBjYWNoZSBjaGFuZ2UgZXZlbnRzIHRvIHJlYnVpbGQgY2FjaGVcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIChmaWxlKSA9PiB7XHJcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcgfHwgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpKSkge1xyXG4gICAgICAgICAgdGhpcy5jYWNoZVNlcnZpY2UucmVidWlsZENhY2hlKCk7XHJcbiAgICAgICAgICAvLyBSZWZyZXNoIGdyYXBoIHZpZXcgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzICh0byB1cGRhdGUgdmlzaWJsZSBub2RlcylcclxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICAgICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2UucmVmcmVzaEdyYXBoVmlldygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gUmVmcmVzaCBiYWNrbGlua3Mgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXHJcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2UudXBkYXRlQmFja2xpbmtzKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBSZWZyZXNoIGV4cGxvcmVyIHdoZW4gbWV0YWRhdGEgY2hhbmdlc1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBsb3JlclNlcnZpY2UudXBkYXRlRXhwbG9yZXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIFJlZnJlc2ggd2luZG93IGZyYW1lIHdoZW4gbWV0YWRhdGEgY2hhbmdlc1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yV2luZG93RnJhbWUpIHtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dGcmFtZVNlcnZpY2UudXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbigncmVzb2x2ZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gUmVidWlsZCBjYWNoZSB3aGVuIG1ldGFkYXRhIGNhY2hlIGlzIGZ1bGx5IHJlc29sdmVkXHJcbiAgICAgICAgdGhpcy5jYWNoZVNlcnZpY2UucmVidWlsZENhY2hlKCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGRyYWcgYW5kIGRyb3AgZXZlbnQgaGFuZGxpbmdcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItZHJvcCcsIChldmVudCwgZWRpdG9yKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3ApIHtcclxuICAgICAgICAgIHRoaXMuZHJhZ0Ryb3BTZXJ2aWNlLmhhbmRsZURyYWdEcm9wKGV2ZW50LCBlZGl0b3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gQWxzbyB0cnkgRE9NIGV2ZW50cyBhcyBiYWNrdXBcclxuICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2Ryb3AnLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3ApIHtcclxuICAgICAgICB0aGlzLmRyYWdEcm9wU2VydmljZS5oYW5kbGVET01Ecm9wKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gTm90ZTogTW9iaWxlIHF1aWNrIHN3aXRjaGVyIGlzIGhhbmRsZWQgYnkgdGhlIFF1aWNrU3dpdGNoZXJTZXJ2aWNlXHJcbiAgICAvLyB3aGljaCBvdmVycmlkZXMgdGhlICdzd2l0Y2hlcjpvcGVuJyBjb21tYW5kLiBUaGUgcXVpY2stcHJldmlldyBldmVudFxyXG4gICAgLy8gd2FzIGNhdXNpbmcgY29uZmxpY3RzIHdpdGggbm9ybWFsIHR5cGluZywgc28gd2UgcmVtb3ZlZCB0aGF0IGFwcHJvYWNoLlxyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcbiAgICByZWdpc3RlckNvbW1hbmRzKHRoaXMpO1xyXG5cclxuICAgIC8vIEFkZCBzZXR0aW5nIHRhYlxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaW5rU3VnZ2VzdGVyKCkge1xyXG4gICAgY29uc3QgZWRpdG9yU3VnZ2VzdCA9ICh0aGlzLmFwcC53b3Jrc3BhY2UgYXMgV29ya3NwYWNlSW50ZXJuYWwpLmVkaXRvclN1Z2dlc3Q7XHJcbiAgICBpZiAoIWVkaXRvclN1Z2dlc3QpIHJldHVybjtcclxuXHJcbiAgICBpZiAodGhpcy5zdWdnZXN0KSB7XHJcbiAgICAgIGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMgPSBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzLmZpbHRlcigoczogRWRpdG9yU3VnZ2VzdCkgPT4gcyAhPT0gdGhpcy5zdWdnZXN0KTtcclxuICAgICAgdGhpcy5zdWdnZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckxpbmtpbmcpIHtcclxuICAgICAgdGhpcy5zdWdnZXN0ID0gbmV3IExpbmtUaXRsZVN1Z2dlc3QodGhpcyk7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFZGl0b3JTdWdnZXN0KHRoaXMuc3VnZ2VzdCk7XHJcbiAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLnNldFN1Z2dlc3QodGhpcy5zdWdnZXN0KTtcclxuICAgICAgZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cyA9IGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMuZmlsdGVyKChzOiBFZGl0b3JTdWdnZXN0KSA9PiAhcy5jb25zdHJ1Y3Rvci5uYW1lLmluY2x1ZGVzKCdMaW5rU3VnZ2VzdCcpKTtcclxuICAgICAgZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cy51bnNoaWZ0KHRoaXMuc3VnZ2VzdCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB1cGRhdGVRdWlja1N3aXRjaGVyKCkge1xyXG4gICAgdGhpcy5xdWlja1N3aXRjaGVyU2VydmljZS51cGRhdGVRdWlja1N3aXRjaGVyKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVHcmFwaFZpZXcoKSB7XHJcbiAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2UudXBkYXRlR3JhcGhWaWV3KCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVCYWNrbGlua3MoKSB7XHJcbiAgICB0aGlzLmJhY2tsaW5rU2VydmljZS51cGRhdGVCYWNrbGlua3MoKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVRhYnMoKSB7XHJcbiAgICB0aGlzLnRhYlNlcnZpY2UudXBkYXRlVGFicygpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlRXhwbG9yZXIoKSB7XHJcbiAgICB0aGlzLmV4cGxvcmVyU2VydmljZS51cGRhdGVFeHBsb3JlcigpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlV2luZG93RnJhbWUoKSB7XHJcbiAgICB0aGlzLndpbmRvd0ZyYW1lU2VydmljZS51cGRhdGVXaW5kb3dGcmFtZSgpO1xyXG4gIH1cclxuXHJcbiAgcmVidWlsZENhY2hlKCkge1xyXG4gICAgdGhpcy5jYWNoZVNlcnZpY2UucmVidWlsZENhY2hlKCk7XHJcbiAgfVxyXG5cclxuICBvbnVubG9hZCgpIHtcclxuICAgIC8vIENsZWFuIHVwIGVkaXRvciBzdWdnZXN0ZXJcclxuICAgIGNvbnN0IGVkaXRvclN1Z2dlc3QgPSAodGhpcy5hcHAud29ya3NwYWNlIGFzIFdvcmtzcGFjZUludGVybmFsKS5lZGl0b3JTdWdnZXN0O1xyXG4gICAgaWYgKGVkaXRvclN1Z2dlc3QgJiYgdGhpcy5zdWdnZXN0KSB7XHJcbiAgICAgIGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMgPSBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzLmZpbHRlcigoczogRWRpdG9yU3VnZ2VzdCkgPT4gcyAhPT0gdGhpcy5zdWdnZXN0KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXN0b3JlIHRoZSBvcmlnaW5hbCBRdWljayBTd2l0Y2hlciBjb21tYW5kXHJcbiAgICB0aGlzLnF1aWNrU3dpdGNoZXJTZXJ2aWNlLnJlc3RvcmVPcmlnaW5hbENvbW1hbmQoKTtcclxuXHJcbiAgICAvLyBDbGVhbiB1cCBncmFwaCB2aWV3XHJcbiAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2Uub251bmxvYWQoKTtcclxuXHJcbiAgICAvLyBDbGVhbiB1cCBiYWNrbGlua3Mgc2VydmljZVxyXG4gICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub251bmxvYWQoKTtcclxuXHJcbiAgICAvLyBDbGVhbiB1cCB0YWIgc2VydmljZVxyXG4gICAgdGhpcy50YWJTZXJ2aWNlLm9udW5sb2FkKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgZXhwbG9yZXIgc2VydmljZVxyXG4gICAgdGhpcy5leHBsb3JlclNlcnZpY2Uub251bmxvYWQoKTtcclxuXHJcbiAgICAvLyBDbGVhbiB1cCB3aW5kb3cgZnJhbWUgc2VydmljZVxyXG4gICAgdGhpcy53aW5kb3dGcmFtZVNlcnZpY2Uub251bmxvYWQoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgIGNvbnN0IGxvYWRlZERhdGEgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyBQbHVnaW5TZXR0aW5ncyB8IG51bGw7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgbG9hZGVkRGF0YSA/PyB7fSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlU2V0dGluZ3MocHJldlF1aWNrU3dpdGNoZXJTdGF0ZT86IGJvb2xlYW4sIHByZXZUYWJTdGF0ZT86IGJvb2xlYW4pIHtcclxuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICAvLyBPbmx5IHVwZGF0ZSBjb21wb25lbnRzIHdoZW4gcmVsZXZhbnQgc2V0dGluZ3MgY2hhbmdlXHJcbiAgICBpZiAocHJldlF1aWNrU3dpdGNoZXJTdGF0ZSAhPT0gdW5kZWZpbmVkICYmIHByZXZRdWlja1N3aXRjaGVyU3RhdGUgIT09IHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xyXG4gICAgICB0aGlzLnVwZGF0ZVF1aWNrU3dpdGNoZXIoKTtcclxuICAgIH1cclxuICAgIGlmIChwcmV2VGFiU3RhdGUgIT09IHVuZGVmaW5lZCAmJiBwcmV2VGFiU3RhdGUgIT09IHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yVGFicykge1xyXG4gICAgICAvLyBBbHdheXMgcmUtcmVnaXN0ZXIgZXZlbnRzIHRvIGVuc3VyZSB0YWJzIGFyZSBtYXJrZWQgYXMgcHJvY2Vzc2VkXHJcbiAgICAgIC8vIChldmVuIHdoZW4gZGlzYWJsZWQsIHdlIG5lZWQgdG8gbWFyayB0YWJzIHNvIHRoZXkncmUgdmlzaWJsZSlcclxuICAgICAgdm9pZCB0aGlzLnRhYlNlcnZpY2UucmVnaXN0ZXJFdmVudHMoKTtcclxuICAgICAgdGhpcy51cGRhdGVUYWJzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBsdWdpblNldHRpbmdzID0ge1xyXG4gIHByb3BlcnR5S2V5OiAndGl0bGUnLFxyXG4gIGVuYWJsZUZvckxpbmtpbmc6IHRydWUsXHJcbiAgZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjogdHJ1ZSxcclxuICBpbmNsdWRlRmlsZW5hbWVJblNlYXJjaDogdHJ1ZSxcclxuICBpbmNsdWRlQWxpYXNlc0luU2VhcmNoOiB0cnVlLFxyXG4gIGVuYWJsZUZvckRyYWdEcm9wOiB0cnVlLFxyXG4gIHVzZVNpbXBsZVNlYXJjaDogZmFsc2UsXHJcbiAgZW5hYmxlRm9yR3JhcGhWaWV3OiB0cnVlLFxyXG4gIGVuYWJsZUZvckJhY2tsaW5rczogdHJ1ZSxcclxuICBlbmFibGVGb3JUYWJzOiB0cnVlLFxyXG4gIGVuYWJsZUZvckV4cGxvcmVyOiBmYWxzZSxcclxuICBmb2xkZXJOb3RlRmlsZW5hbWU6ICcnLFxyXG4gIGVuYWJsZUZvcldpbmRvd0ZyYW1lOiB0cnVlLFxyXG4gIGVuYWJsZU1keFN1cHBvcnQ6IGZhbHNlLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogeyBpc1ZhbGlkOiBib29sZWFuOyBlcnJvcnM6IHN0cmluZ1tdIH0ge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuICBcclxuICBpZiAoIXNldHRpbmdzLnByb3BlcnR5S2V5IHx8IHNldHRpbmdzLnByb3BlcnR5S2V5LnRyaW0oKSA9PT0gJycpIHtcclxuICAgIGVycm9ycy5wdXNoKCdQcm9wZXJ0eSBrZXkgY2Fubm90IGJlIGVtcHR5Jyk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzXHJcbiAgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBFZGl0b3JQb3NpdGlvbiwgRWRpdG9yU3VnZ2VzdCwgRWRpdG9yU3VnZ2VzdENvbnRleHQsIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFRGaWxlLCBwcmVwYXJlRnV6enlTZWFyY2gsIHByZXBhcmVTaW1wbGVTZWFyY2gsIFNlYXJjaFJlc3VsdCwgc29ydFNlYXJjaFJlc3VsdHMgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFN1Z2dlc3Rpb25JdGVtLCBDYWNoZWRGaWxlRGF0YSwgRWRpdG9yU3VnZ2VzdEludGVybmFsLCBTZWFyY2hNYXRjaFJlYXNvbiwgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4sIFZhdWx0SW50ZXJuYWwsIFF1aWNrU3dpdGNoZXJQbHVnaW5JbnN0YW5jZSwgQXBwSW50ZXJuYWwgfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGJ1aWxkRmlsZUNhY2hlIH0gZnJvbSAnLi4vdXRpbHMvc2VhcmNoJztcclxuXHJcbmV4cG9ydCBjbGFzcyBMaW5rVGl0bGVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxTdWdnZXN0aW9uSXRlbT4ge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIGZpbGVDYWNoZTogTWFwPHN0cmluZywgQ2FjaGVkRmlsZURhdGE+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgc2VhcmNoVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBtYXRjaFJlYXNvbnM6IE1hcDxzdHJpbmcsIFNlYXJjaE1hdGNoUmVhc29uPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcCk7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIHZvaWQgdGhpcy5idWlsZEZpbGVDYWNoZSgpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpOiB2b2lkIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIGNvbnN0IGVsID0gKHRoaXMgYXMgRWRpdG9yU3VnZ2VzdEludGVybmFsKS5zdWdnZXN0RWw7XHJcbiAgICBpZiAoZWwpIHtcclxuICAgICAgLy8gQWRkIHNjb3BpbmcgY2xhc3MgdG8gcHJldmVudCBDU1MgZnJvbSBhZmZlY3Rpbmcgb3RoZXIgc3VnZ2VzdGlvbiBzeXN0ZW1zXHJcbiAgICAgIGVsLmFkZENsYXNzKCdwcm9wZXJ0eS1vdmVyLWZpbGVuYW1lLXN1Z2dlc3Rpb24nKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvcignLnByb21wdC1pbnN0cnVjdGlvbnMnKSkge1xyXG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbnMnIH0pO1xyXG4gICAgICAgIGluc3RydWN0aW9ucy5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24nIH0pLnNldFRleHQoJ1R5cGUgIyB0byBsaW5rIGhlYWRpbmcnKTtcclxuICAgICAgICBpbnN0cnVjdGlvbnMuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KS5zZXRUZXh0KCdUeXBlIF4gdG8gbGluayBibG9ja3MnKTtcclxuICAgICAgICBpbnN0cnVjdGlvbnMuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KS5zZXRUZXh0KCdUeXBlIHwgdG8gY2hhbmdlIGRpc3BsYXkgdGV4dCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEFkZCBrZXlib2FyZCBuYXZpZ2F0aW9uIGltcHJvdmVtZW50c1xyXG4gICAgdGhpcy5hZGRLZXlib2FyZE5hdmlnYXRpb24oKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkS2V5Ym9hcmROYXZpZ2F0aW9uKCk6IHZvaWQge1xyXG4gICAgY29uc3QgZWwgPSAodGhpcyBhcyBFZGl0b3JTdWdnZXN0SW50ZXJuYWwpLnN1Z2dlc3RFbDtcclxuICAgIGlmICghZWwpIHJldHVybjtcclxuXHJcbiAgICAvLyBBZGQgZXNjYXBlIGtleSBoYW5kbGluZ1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25UcmlnZ2VyKGN1cnNvcjogRWRpdG9yUG9zaXRpb24sIGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSB8IG51bGwpOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZykgcmV0dXJuIG51bGw7XHJcbiAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpLnN1YnN0cmluZygwLCBjdXJzb3IuY2gpO1xyXG4gICAgY29uc3QgbWF0Y2ggPSAvXFxbXFxbKFteI158XFxdXSopJC8uZXhlYyhsaW5lKTtcclxuICAgIGlmIChtYXRjaCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXJ0OiB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGluZS5sYXN0SW5kZXhPZignW1snKSB9LFxyXG4gICAgICAgIGVuZDogY3Vyc29yLFxyXG4gICAgICAgIHF1ZXJ5OiBtYXRjaFsxXSxcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgYnVpbGRGaWxlQ2FjaGUoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAvLyBHZXQgYWxsIG1hcmtkb3duIGZpbGVzIGFuZCBNRFggZmlsZXMgKGlmIGVuYWJsZWQpXHJcbiAgICBjb25zdCBtZEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgY29uc3QgYWxsRmlsZXMgPSBbLi4ubWRGaWxlc107XHJcbiAgICBcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgIGNvbnN0IG1keEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoXHJcbiAgICAgICAgKGYpOiBmIGlzIFRGaWxlID0+IGYgaW5zdGFuY2VvZiBURmlsZSAmJiBmLmV4dGVuc2lvbiA9PT0gJ21keCdcclxuICAgICAgKTtcclxuICAgICAgYWxsRmlsZXMucHVzaCguLi5tZHhGaWxlcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRoaXMuZmlsZUNhY2hlID0gYXdhaXQgYnVpbGRGaWxlQ2FjaGUoXHJcbiAgICAgIGFsbEZpbGVzLFxyXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLFxyXG4gICAgICB0aGlzLmFwcCxcclxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXksXHJcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlRmlsZUNhY2hlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCB7IGdldEZyb250bWF0dGVyLCBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3V0aWxzL2Zyb250bWF0dGVyJyk7XHJcbiAgICBcclxuICAgIC8vIFNraXAgdW5zdXBwb3J0ZWQgZmlsZSB0eXBlc1xyXG4gICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGZpbGUuZXh0ZW5zaW9uLCB0aGlzLnBsdWdpbi5zZXR0aW5ncykpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gYXdhaXQgZ2V0RnJvbnRtYXR0ZXIodGhpcy5hcHAsIGZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgIGxldCBkaXNwbGF5TmFtZSA9IGZpbGUuYmFzZW5hbWU7XHJcbiAgICBsZXQgaXNDdXN0b21EaXNwbGF5ID0gZmFsc2U7XHJcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XHJcbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xyXG4gICAgICAgIGRpc3BsYXlOYW1lID0gcHJvcGVydHlWYWx1ZTtcclxuICAgICAgICBpc0N1c3RvbURpc3BsYXkgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZyb250bWF0dGVyPy5hbGlhc2VzKSB7XHJcbiAgICAgIGNvbnN0IGFsaWFzZXNSYXcgPSBmcm9udG1hdHRlci5hbGlhc2VzIGFzIHVua25vd247XHJcbiAgICAgIGFsaWFzZXMgPSBBcnJheS5pc0FycmF5KGFsaWFzZXNSYXcpID8gYWxpYXNlc1Jhdy5tYXAoYSA9PiBTdHJpbmcoYSkpIDogW1N0cmluZyhhbGlhc2VzUmF3KV07XHJcbiAgICAgIGFsaWFzZXMgPSBhbGlhc2VzLm1hcChhbGlhcyA9PiBhbGlhcy50cmltKCkpLmZpbHRlcihhbGlhcyA9PiBhbGlhcyAhPT0gJycpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZmlsZUNhY2hlLnNldChmaWxlLnBhdGgsIHtcclxuICAgICAgZmlsZSxcclxuICAgICAgZGlzcGxheU5hbWUsXHJcbiAgICAgIGFsaWFzZXMsXHJcbiAgICAgIGxhc3RNb2RpZmllZDogZmlsZS5zdGF0Lm10aW1lLFxyXG4gICAgICBpc0N1c3RvbURpc3BsYXlcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBTdWdnZXN0aW9uSXRlbVtdIHtcclxuICAgIGNvbnN0IHF1ZXJ5ID0gY29udGV4dC5xdWVyeS50cmltKCk7XHJcbiAgICByZXR1cm4gdGhpcy5wZXJmb3JtU2VhcmNoKHF1ZXJ5KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcGVyZm9ybVNlYXJjaChxdWVyeTogc3RyaW5nKTogU3VnZ2VzdGlvbkl0ZW1bXSB7XHJcbiAgICAvLyBJZiBubyBxdWVyeSwgc2hvdyBhbGwgZmlsZXNcclxuICAgIGlmICghcXVlcnkgfHwgcXVlcnkudHJpbSgpID09PSAnJykge1xyXG4gICAgICBjb25zdCBzdWdnZXN0aW9uczogU3VnZ2VzdGlvbkl0ZW1bXSA9IFtdO1xyXG4gICAgICBmb3IgKGNvbnN0IGNhY2hlZERhdGEgb2YgdGhpcy5maWxlQ2FjaGUudmFsdWVzKCkpIHtcclxuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHsgXHJcbiAgICAgICAgICBmaWxlOiBjYWNoZWREYXRhLmZpbGUsIFxyXG4gICAgICAgICAgZGlzcGxheTogY2FjaGVkRGF0YS5kaXNwbGF5TmFtZSwgXHJcbiAgICAgICAgICBpc0N1c3RvbURpc3BsYXk6IGNhY2hlZERhdGEuaXNDdXN0b21EaXNwbGF5IFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2Ugc2ltcGxlIHNlYXJjaCBmb3IgbGFyZ2UgdmF1bHRzIGlmIGVuYWJsZWQsIG90aGVyd2lzZSB1c2UgZnV6enkgc2VhcmNoXHJcbiAgICBjb25zdCBzZWFyY2ggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2ggXHJcbiAgICAgID8gcHJlcGFyZVNpbXBsZVNlYXJjaChxdWVyeSlcclxuICAgICAgOiBwcmVwYXJlRnV6enlTZWFyY2gocXVlcnkpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgYSBzdHJ1Y3R1cmUgY29tcGF0aWJsZSB3aXRoIHNvcnRTZWFyY2hSZXN1bHRzXHJcbiAgICBpbnRlcmZhY2UgU2VhcmNoYWJsZVN1Z2dlc3Rpb24ge1xyXG4gICAgICBpdGVtOiBTdWdnZXN0aW9uSXRlbTtcclxuICAgICAgbWF0Y2g6IFNlYXJjaFJlc3VsdDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3Qgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zOiBTZWFyY2hhYmxlU3VnZ2VzdGlvbltdID0gW107XHJcbiAgICB0aGlzLm1hdGNoUmVhc29ucy5jbGVhcigpOyAvLyBDbGVhciBwcmV2aW91cyBtYXRjaCByZWFzb25zXHJcblxyXG4gICAgLy8gVXNlIGNhY2hlZCBkYXRhIGZvciBtdWNoIGZhc3RlciBzZWFyY2hcclxuICAgIGZvciAoY29uc3QgY2FjaGVkRGF0YSBvZiB0aGlzLmZpbGVDYWNoZS52YWx1ZXMoKSkge1xyXG4gICAgICBjb25zdCB7IGZpbGUsIGRpc3BsYXlOYW1lLCBhbGlhc2VzLCBpc0N1c3RvbURpc3BsYXkgfSA9IGNhY2hlZERhdGE7XHJcbiAgICAgIFxyXG4gICAgICAvLyBUcmFjayB3aGljaCBmaWVsZHMgY2F1c2VkIHRoZSBtYXRjaFxyXG4gICAgICBjb25zdCBtYXRjaFJlYXNvbjogU2VhcmNoTWF0Y2hSZWFzb24gPSB7XHJcbiAgICAgICAgbWF0Y2hlZEluVGl0bGU6IGZhbHNlLFxyXG4gICAgICAgIG1hdGNoZWRJbkZpbGVuYW1lOiBmYWxzZSxcclxuICAgICAgICBtYXRjaGVkSW5BbGlhczogZmFsc2VcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIC8vIFByaW1hcnkgbWF0Y2g6IHNlYXJjaCB0aXRsZS9wcm9wZXJ0eSBmaXJzdCAob25seSBpZiBub3RlIGhhcyBjdXN0b20gZGlzcGxheSlcclxuICAgICAgbGV0IHByaW1hcnlNYXRjaDogU2VhcmNoUmVzdWx0IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgIGxldCBiZXN0TWF0Y2g6IFNlYXJjaFJlc3VsdCB8IG51bGwgPSBudWxsO1xyXG4gICAgICBsZXQgbWF0Y2hUeXBlOiAndGl0bGUnIHwgJ2ZpbGVuYW1lJyB8ICdhbGlhcycgfCBudWxsID0gbnVsbDtcclxuICAgICAgXHJcbiAgICAgIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcclxuICAgICAgICAvLyBPbmx5IHNlYXJjaCB0aXRsZS9wcm9wZXJ0eSBpZiBub3RlIGFjdHVhbGx5IGhhcyBhIGN1c3RvbSBwcm9wZXJ0eVxyXG4gICAgICAgIHByaW1hcnlNYXRjaCA9IHNlYXJjaChkaXNwbGF5TmFtZSk7XHJcbiAgICAgICAgaWYgKHByaW1hcnlNYXRjaCAmJiBwcmltYXJ5TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSA9IHRydWU7XHJcbiAgICAgICAgICBiZXN0TWF0Y2ggPSBwcmltYXJ5TWF0Y2g7XHJcbiAgICAgICAgICBtYXRjaFR5cGUgPSAndGl0bGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gSWYgbm8gdGl0bGUgbWF0Y2ggKG9yIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5KSwgc2VhcmNoIGZpbGVuYW1lXHJcbiAgICAgIGlmICghbWF0Y2hUeXBlKSB7XHJcbiAgICAgICAgLy8gU2VhcmNoIGZpbGVuYW1lIGlmIGl0J3MgZGlmZmVyZW50IGZyb20gZGlzcGxheU5hbWUsIG9yIGlmIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIGZpbGUuYmFzZW5hbWUgIT09IGRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZU1hdGNoID0gc2VhcmNoKGZpbGUuYmFzZW5hbWUpO1xyXG4gICAgICAgICAgaWYgKGZpbGVuYW1lTWF0Y2ggJiYgZmlsZW5hbWVNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyBEb3ducmFuayBmaWxlbmFtZSBtYXRjaGVzIGJ5IC0xXHJcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IHsgLi4uZmlsZW5hbWVNYXRjaCwgc2NvcmU6IGZpbGVuYW1lTWF0Y2guc2NvcmUgLSAxIH07XHJcbiAgICAgICAgICAgIG1hdGNoVHlwZSA9ICdmaWxlbmFtZSc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICghaXNDdXN0b21EaXNwbGF5KSB7XHJcbiAgICAgICAgICAvLyBJZiBub3RlIGRvZXNuJ3QgaGF2ZSBwcm9wZXJ0eSwgZGlzcGxheU5hbWUgZXF1YWxzIGZpbGVuYW1lLCBzbyBzZWFyY2ggZmlsZW5hbWVcclxuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lTWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSk7XHJcbiAgICAgICAgICBpZiAoZmlsZW5hbWVNYXRjaCAmJiBmaWxlbmFtZU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IGZpbGVuYW1lTWF0Y2g7XHJcbiAgICAgICAgICAgIG1hdGNoVHlwZSA9ICdmaWxlbmFtZSc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAgIC8vIFRlcnRpYXJ5IG1hdGNoOiBzZWFyY2ggYWxpYXNlcyAod2l0aCBkb3ducmFua2luZylcclxuICAgICAgICBpZiAoIW1hdGNoVHlwZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlQWxpYXNlc0luU2VhcmNoICYmIGFsaWFzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgZm9yIChjb25zdCBhbGlhcyBvZiBhbGlhc2VzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFsaWFzTWF0Y2ggPSBzZWFyY2goYWxpYXMpO1xyXG4gICAgICAgICAgICBpZiAoYWxpYXNNYXRjaCAmJiBhbGlhc01hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkFsaWFzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0ID0gYWxpYXM7IC8vIFN0b3JlIHdoaWNoIGFsaWFzIG1hdGNoZWRcclxuICAgICAgICAgICAgICAvLyBEb3ducmFuayBhbGlhcyBtYXRjaGVzIGJ5IC0xXHJcbiAgICAgICAgICAgICAgYmVzdE1hdGNoID0geyAuLi5hbGlhc01hdGNoLCBzY29yZTogYWxpYXNNYXRjaC5zY29yZSAtIDEgfTtcclxuICAgICAgICAgICAgICBtYXRjaFR5cGUgPSAnYWxpYXMnO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gSWYgd2UgaGF2ZSBhbnkgbWF0Y2gsIGFkZCB0byByZXN1bHRzXHJcbiAgICAgIGlmIChiZXN0TWF0Y2ggJiYgYmVzdE1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb246IFN1Z2dlc3Rpb25JdGVtID0geyBcclxuICAgICAgICAgIGZpbGUsIFxyXG4gICAgICAgICAgZGlzcGxheTogZGlzcGxheU5hbWUsIFxyXG4gICAgICAgICAgaXNDdXN0b21EaXNwbGF5IFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zLnB1c2goeyBpdGVtOiBzdWdnZXN0aW9uLCBtYXRjaDogYmVzdE1hdGNoIH0pO1xyXG4gICAgICAgIHRoaXMubWF0Y2hSZWFzb25zLnNldChmaWxlLnBhdGgsIG1hdGNoUmVhc29uKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCB1bnJlc29sdmVkIGxpbmtzIGlmIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgaXMgZGlzYWJsZWRcclxuICAgIC8vIFRoaXMgbWF0Y2hlcyBRdWljayBTd2l0Y2ggKysgYmVoYXZpb3I6IHVucmVzb2x2ZWQ6ICFzZXR0aW5ncy5zaG93RXhpc3RpbmdPbmx5XHJcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcclxuICAgIGNvbnN0IHNob3dFeGlzdGluZ09ubHkgPSBxdWlja1N3aXRjaGVyT3B0aW9ucz8uc2hvd0V4aXN0aW5nT25seSA/PyBmYWxzZTtcclxuICAgIFxyXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XHJcbiAgICAgIC8vIEdldCB1bnJlc29sdmVkIGxpbmtzIGZyb20gbWV0YWRhdGEgY2FjaGUgKGxpa2UgUXVpY2sgU3dpdGNoICsrIGRvZXMpXHJcbiAgICAgIGNvbnN0IHsgdW5yZXNvbHZlZExpbmtzIH0gPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlO1xyXG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb2xsZWN0IGFsbCB1bnJlc29sdmVkIGxpbmtzIGZyb20gYWxsIGZpbGVzXHJcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcclxuICAgICAgICBjb25zdCBsaW5rcyA9IE9iamVjdC5rZXlzKHVucmVzb2x2ZWRMaW5rc1tzb3VyY2VQYXRoXSk7XHJcbiAgICAgICAgbGlua3MuZm9yRWFjaChsaW5rID0+IHVucmVzb2x2ZWRTZXQuYWRkKGxpbmspKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gU2VhcmNoIHVucmVzb2x2ZWQgbGlua3MgYW5kIGFkZCBtYXRjaGVzXHJcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XHJcbiAgICAgICAgY29uc3QgdW5yZXNvbHZlZE1hdGNoID0gc2VhcmNoKHVucmVzb2x2ZWQpO1xyXG4gICAgICAgIGlmICh1bnJlc29sdmVkTWF0Y2ggJiYgdW5yZXNvbHZlZE1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxyXG4gICAgICAgICAgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICBpdGVtOiB7XHJcbiAgICAgICAgICAgICAgZGlzcGxheTogdW5yZXNvbHZlZCxcclxuICAgICAgICAgICAgICBpc0N1c3RvbURpc3BsYXk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIC8vIE5vIGZpbGUgcHJvcGVydHkgbWVhbnMgaXQncyB1bnJlc29sdmVkXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1hdGNoOiB1bnJlc29sdmVkTWF0Y2hcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFVzZSBPYnNpZGlhbidzIG5hdGl2ZSBzb3J0aW5nIGZvciBleGFjdCB2YW5pbGxhIGNvbXBhdGliaWxpdHlcclxuICAgIHNvcnRTZWFyY2hSZXN1bHRzKHNlYXJjaGFibGVTdWdnZXN0aW9ucyk7XHJcbiAgICBcclxuICAgIC8vIEV4dHJhY3Qgc3VnZ2VzdGlvbnMgZnJvbSBzb3J0ZWQgcmVzdWx0c1xyXG4gICAgbGV0IHN1Z2dlc3Rpb25zID0gc2VhcmNoYWJsZVN1Z2dlc3Rpb25zLm1hcChzID0+IHMuaXRlbSk7XHJcbiAgICBcclxuICAgIC8vIEZpbHRlciBvdXQgdW5yZXNvbHZlZCBsaW5rcyBpZiBcIlNob3cgZXhpc3Rpbmcgb25seVwiIGlzIGVuYWJsZWRcclxuICAgIC8vIFVucmVzb2x2ZWQgbGlua3MgYXJlIGl0ZW1zIHdpdGhvdXQgYSBmaWxlIHByb3BlcnR5XHJcbiAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xyXG4gICAgICBzdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLmZpbHRlcihzID0+IHMuZmlsZSAhPT0gdW5kZWZpbmVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBMaW5rIHN1Z2dlc3RlciBzaG91bGQgTk9UIHNob3cgXCJjcmVhdGUgbmV3IG5vdGVcIiBvcHRpb24gLSB0aGF0J3MgUXVpY2sgU3dpdGNoZXIgYmVoYXZpb3JcclxuICAgIC8vIEJ1dCBpZiB0aGVyZSBhcmUgbm8gbWF0Y2hlcyBhbmQgdGhlcmUncyBhIHF1ZXJ5LCBzaG93IFwiTm8gbWF0Y2ggZm91bmRcIiBsaWtlIHZhbmlsbGEgT2JzaWRpYW5cclxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDAgJiYgcXVlcnkpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XHJcbiAgICAgICAgZGlzcGxheTogJ05vIG1hdGNoIGZvdW5kJyxcclxuICAgICAgICBpc0N1c3RvbURpc3BsYXk6IGZhbHNlLFxyXG4gICAgICAgIGlzTm9NYXRjaDogdHJ1ZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyU3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBTdWdnZXN0aW9uSXRlbSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBlbC5lbXB0eSgpO1xyXG4gICAgXHJcbiAgICBpZiAoc3VnZ2VzdGlvbi5pc05vTWF0Y2gpIHtcclxuICAgICAgLy8gRm9yIFwiTm8gbWF0Y2ggZm91bmRcIiwgc2hvdyBqdXN0IHRoZSB0ZXh0XHJcbiAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoc3VnZ2VzdGlvbi5maWxlKSB7XHJcbiAgICAgIC8vIEdldCB0aGUgbWF0Y2ggcmVhc29uIGZvciB0aGlzIGZpbGVcclxuICAgICAgY29uc3QgbWF0Y2hSZWFzb24gPSB0aGlzLm1hdGNoUmVhc29ucy5nZXQoc3VnZ2VzdGlvbi5maWxlLnBhdGgpO1xyXG4gICAgICBcclxuICAgICAgLy8gU3BlY2lhbCBjYXNlOiBub3RlcyB3aXRob3V0IHByb3BlcnR5IHRoYXQgbWF0Y2hlZCB2aWEgYWxpYXMgc2hvdWxkIHNob3cgYWxpYXMgd2l0aCBpY29uXHJcbiAgICAgIGlmICghc3VnZ2VzdGlvbi5pc0N1c3RvbURpc3BsYXkgJiYgbWF0Y2hSZWFzb24/Lm1hdGNoZWRJbkFsaWFzICYmIG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpIHtcclxuICAgICAgICAvLyBTaG93IGFsaWFzIGFzIG1haW4gdGV4dCwgZmlsZW5hbWUgYmVsb3csIHdpdGggYWxpYXMgaWNvbiAobGlrZSBkZWZhdWx0IE9ic2lkaWFuKVxyXG4gICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNYWluIHRpdGxlIC0gc2hvdyB0aGUgYWxpYXMgdGhhdCBtYXRjaGVkXHJcbiAgICAgICAgY29uc3QgdGl0bGVFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xyXG4gICAgICAgIHRpdGxlRWwuc2V0VGV4dChtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBGaWxlIHBhdGggYmVsb3dcclxuICAgICAgICBjb25zdCBwYXRoRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLW5vdGUnIH0pO1xyXG4gICAgICAgIHBhdGhFbC5zZXRUZXh0KHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIHN1Z2dlc3Rpb24tYXV4IHdpdGggYWxpYXMgaWNvblxyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XHJcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkZsYWlyID0gc3VnZ2VzdGlvbkF1eC5jcmVhdGVTcGFuKHsgXHJcbiAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ0FsaWFzIE1hdGNoJyB9IFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlRm9yd2FyZEljb24oc3VnZ2VzdGlvbkZsYWlyKTtcclxuICAgICAgfSBlbHNlIGlmIChzdWdnZXN0aW9uLmlzQ3VzdG9tRGlzcGxheSkge1xyXG4gICAgICAgIC8vIE5vdGVzIHdpdGggdGhlIHByb3BlcnR5IC0ga2VlcCBleGlzdGluZyBiZWhhdmlvclxyXG4gICAgICAgIGNvbnN0IHNob3VsZFNob3dJY29uID0gbWF0Y2hSZWFzb24gJiYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkFsaWFzKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoc2hvdWxkU2hvd0ljb24pIHtcclxuICAgICAgICAgIC8vIEFkZCBtb2QtY29tcGxleCBjbGFzcyB0byBtYXRjaCBPYnNpZGlhbidzIHN0cnVjdHVyZVxyXG4gICAgICAgICAgZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XHJcblxyXG4gICAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIHN1Z2dlc3Rpb24gY29udGFpbmVyXHJcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIE1haW4gdGl0bGVcclxuICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcclxuICAgICAgICAgIHRpdGxlRWwuc2V0VGV4dChzdWdnZXN0aW9uLmRpc3BsYXkpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBGaWxlIHBhdGggYmVsb3dcclxuICAgICAgICAgIGNvbnN0IHBhdGhFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tbm90ZScgfSk7XHJcbiAgICAgICAgICBwYXRoRWwuc2V0VGV4dChzdWdnZXN0aW9uLmZpbGUucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhcHByb3ByaWF0ZSBpY29uIGJhc2VkIG9uIG1hdGNoIHJlYXNvblxyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcclxuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxyXG4gICAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXHJcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiB0aGlzLmdldEljb25MYWJlbChtYXRjaFJlYXNvbikgfSBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBEZXRlcm1pbmUgaWNvbiBiYXNlZCBvbiBwcmlvcml0eTogdGl0bGUgPiBmaWxlIG5hbWUgPiBhbGlhc1xyXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XHJcbiAgICAgICAgICAgIC8vIFR5cGUgaWNvbiBmb3IgdGl0bGUvcHJvcGVydHkgbWF0Y2hlc1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVR5cGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XHJcbiAgICAgICAgICAgIC8vIEZpbGUgaWNvbiBmb3IgZmlsZSBuYW1lIG1hdGNoZXNcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVGaWxlSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xyXG4gICAgICAgICAgICAvLyBBcnJvdyBpY29uIGZvciBhbGlhcyBtYXRjaGVzXHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlRm9yd2FyZEljb24oc3VnZ2VzdGlvbkZsYWlyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gTm90ZSBoYXMgcHJvcGVydHkgYnV0IG5vIG1hdGNoIHJlYXNvbiAoc2hvdWxkbid0IGhhcHBlbiwgYnV0IGhhbmRsZSBncmFjZWZ1bGx5KVxyXG4gICAgICAgICAgLy8gU2hvdyBzaW1wbGUgZGlzcGxheSB3aXRoIGp1c3QgdGhlIGRpc3BsYXkgbmFtZVxyXG4gICAgICAgICAgZWwuc2V0VGV4dChzdWdnZXN0aW9uLmRpc3BsYXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGb3Igbm90ZXMgd2l0aG91dCB0aGUgcHJvcGVydHkgKGFuZCBub3QgbWF0Y2hlZCB2aWEgYWxpYXMpLCBzaG93IHNpbXBsZSBkaXNwbGF5IChubyBpY29uLCBubyBkdXBsaWNhdGUgbmFtZSlcclxuICAgICAgICBlbC5zZXRUZXh0KHN1Z2dlc3Rpb24uZGlzcGxheSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0SWNvbkxhYmVsKG1hdGNoUmVhc29uOiBTZWFyY2hNYXRjaFJlYXNvbik6IHN0cmluZyB7XHJcbiAgICBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluVGl0bGUpIHtcclxuICAgICAgcmV0dXJuICdUaXRsZS9Qcm9wZXJ0eSBNYXRjaCc7XHJcbiAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XHJcbiAgICAgIHJldHVybiAnRmlsZSBOYW1lIE1hdGNoJztcclxuICAgIH0gZWxzZSBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpIHtcclxuICAgICAgcmV0dXJuICdBbGlhcyBNYXRjaCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJ01hdGNoJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlVHlwZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLXR5cGUnKTtcclxuICAgIFxyXG4gICAgY29uc3QgcG9seWxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xyXG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzQgNyA0IDQgMjAgNCAyMCA3Jyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUxKTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcclxuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDEnLCAnOScpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcyMCcpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MicsICcxNScpO1xyXG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTInKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnNCcpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MicsICcxMicpO1xyXG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcclxuICAgIFxyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUZpbGVJY29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnY3VycmVudENvbG9yJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xyXG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS1maWxlLXRleHQnKTtcclxuICAgIFxyXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xyXG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCAnTTE0LjUgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjcuNUwxNC41IDJ6Jyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHBvbHlsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcclxuICAgIHBvbHlsaW5lMS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNCwyIDE0LDggMjAsOCcpO1xyXG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gxJywgJzE2Jyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kxJywgJzEzJyk7XHJcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcclxuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTInLCAnMTMnKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XHJcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gxJywgJzE2Jyk7XHJcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzE3Jyk7XHJcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcclxuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTInLCAnMTcnKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XHJcbiAgICBcclxuICAgIGNvbnN0IHBvbHlsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcclxuICAgIHBvbHlsaW5lMi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxMCw5IDksOSA4LDknKTtcclxuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTIpO1xyXG4gICAgXHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRm9yd2FyZEljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcclxuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XHJcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xyXG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XHJcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZvcndhcmQnKTtcclxuICAgIFxyXG4gICAgY29uc3QgcG9seWxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XHJcbiAgICBwb2x5bGluZS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNSAxNyAyMCAxMiAxNSA3Jyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUpO1xyXG4gICAgXHJcbiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XHJcbiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsICdNNCAxOHYtMmE0IDQgMCAwIDEgNC00aDEyJyk7XHJcbiAgICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7XHJcbiAgICBcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc1VzaW5nQ3VzdG9tUHJvcGVydHkoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcclxuICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyB1bmtub3duO1xyXG4gICAgaWYgKHByb3BlcnR5VmFsdWUgPT09IHVuZGVmaW5lZCB8fCBwcm9wZXJ0eVZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGNvbnN0IHN0clZhbHVlID0gdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdzdHJpbmcnID8gcHJvcGVydHlWYWx1ZSA6ICh0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdib29sZWFuJyA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6ICcnKTtcclxuICAgIHJldHVybiBzdHJWYWx1ZS50cmltKCkgIT09ICcnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc1VzaW5nQWxpYXMoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcclxuICAgIC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYWxpYXNlcyBhbmQgaWYgd2UncmUgY3VycmVudGx5IHNlYXJjaGluZ1xyXG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xyXG4gICAgY29uc3QgYWxpYXNlcyA9IGZyb250bWF0dGVyPy5hbGlhc2VzIGFzIHVua25vd247XHJcbiAgICBcclxuICAgIGlmICghYWxpYXNlcykgcmV0dXJuIGZhbHNlO1xyXG4gICAgXHJcbiAgICAvLyBGb3Igbm93LCBzaG93IGFsaWFzIGljb24gaWYgdGhlIGZpbGUgaGFzIGFsaWFzZXMgYW5kIHdlJ3JlIG5vdCB1c2luZyBhIGN1c3RvbSBwcm9wZXJ0eVxyXG4gICAgY29uc3QgaXNVc2luZ0N1c3RvbVByb3BlcnR5ID0gdGhpcy5pc1VzaW5nQ3VzdG9tUHJvcGVydHkoZmlsZSk7XHJcbiAgICByZXR1cm4gIWlzVXNpbmdDdXN0b21Qcm9wZXJ0eSAmJiBCb29sZWFuKGFsaWFzZXMpO1xyXG4gIH1cclxuXHJcbiAgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBTdWdnZXN0aW9uSXRlbSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG4gICAgLy8gRG9uJ3QgZG8gYW55dGhpbmcgZm9yIFwiTm8gbWF0Y2ggZm91bmRcIlxyXG4gICAgaWYgKHN1Z2dlc3Rpb24uaXNOb01hdGNoKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgIXRoaXMuY29udGV4dCkgcmV0dXJuO1xyXG4gICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XHJcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuY29udGV4dDtcclxuICAgIGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydC5saW5lKTtcclxuICAgIGxldCBlbmRQb3MgPSBlbmQ7XHJcbiAgICBpZiAobGluZS5zbGljZShlbmQuY2gsIGVuZC5jaCArIDIpID09PSAnXV0nKSB7XHJcbiAgICAgIGVuZFBvcyA9IHsgbGluZTogZW5kLmxpbmUsIGNoOiBlbmQuY2ggKyAyIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSBleGlzdGluZyBmaWxlXHJcbiAgICBpZiAoIXN1Z2dlc3Rpb24uZmlsZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHZhdWx0ID0gdGhpcy5hcHAudmF1bHQgYXMgdW5rbm93biBhcyBWYXVsdEludGVybmFsO1xyXG4gICAgY29uc3QgdXNlTWFya2Rvd25MaW5rcyA9IHZhdWx0LmdldENvbmZpZz8uKCd1c2VNYXJrZG93bkxpbmtzJykgPz8gZmFsc2U7XHJcbiAgICBsZXQgbGlua1RleHQ6IHN0cmluZztcclxuXHJcbiAgICAvLyBPbmx5IGFkZCBkaXNwbGF5IHRleHQgaWYgdGhlIG5vdGUgaGFzIHRoZSBjdXN0b20gcHJvcGVydHlcclxuICAgIC8vIE90aGVyd2lzZSwgdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3IgKG5vIGRpc3BsYXkgdGV4dClcclxuICAgIGlmIChzdWdnZXN0aW9uLmlzQ3VzdG9tRGlzcGxheSkge1xyXG4gICAgICBpZiAodXNlTWFya2Rvd25MaW5rcykge1xyXG4gICAgICAgIGxpbmtUZXh0ID0gYFske3N1Z2dlc3Rpb24uZGlzcGxheX1dKCR7ZW5jb2RlVVJJKHN1Z2dlc3Rpb24uZmlsZS5wYXRoKX0pYDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBsaW5rUGF0aCA9IHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKTtcclxuICAgICAgICBsaW5rVGV4dCA9IGBbWyR7bGlua1BhdGh9fCR7c3VnZ2VzdGlvbi5kaXNwbGF5fV1dYDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gRGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvciAtIG5vIGRpc3BsYXkgdGV4dFxyXG4gICAgICBpZiAodXNlTWFya2Rvd25MaW5rcykge1xyXG4gICAgICAgIGxpbmtUZXh0ID0gYFske3N1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKX1dKCR7ZW5jb2RlVVJJKHN1Z2dlc3Rpb24uZmlsZS5wYXRoKX0pYDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBsaW5rUGF0aCA9IHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKTtcclxuICAgICAgICBsaW5rVGV4dCA9IGBbWyR7bGlua1BhdGh9XV1gO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGxpbmtUZXh0LCB7IGxpbmU6IHN0YXJ0LmxpbmUsIGNoOiBzdGFydC5jaCB9LCBlbmRQb3MpO1xyXG4gICAgY29uc3QgbmV3Q3Vyc29yUG9zID0gc3RhcnQuY2ggKyBsaW5rVGV4dC5sZW5ndGg7XHJcbiAgICB0cnkge1xyXG4gICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogc3RhcnQubGluZSwgY2g6IG5ld0N1cnNvclBvcyB9KTtcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICBuZXcgTm90aWNlKCdFcnJvciBzZXR0aW5nIGN1cnNvciBwb3NpdGlvbi4gUGxlYXNlIGNoZWNrIGNvbnNvbGUgZm9yIGRldGFpbHMuJyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTogUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlWydvcHRpb25zJ10gfCBudWxsIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEFjY2VzcyB0aGUgaW50ZXJuYWwgUXVpY2sgU3dpdGNoZXIgcGx1Z2luIHRoZSBzYW1lIHdheSBRdWljayBTd2l0Y2ggKysgZG9lc1xyXG4gICAgICBjb25zdCBpbnRlcm5hbFBsdWdpbnMgPSAodGhpcy5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuaW50ZXJuYWxQbHVnaW5zO1xyXG4gICAgICBpZiAoIWludGVybmFsUGx1Z2lucykgcmV0dXJuIG51bGw7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBzd2l0Y2hlclBsdWdpbiA9IGludGVybmFsUGx1Z2lucy5nZXRQbHVnaW5CeUlkPy4oJ3N3aXRjaGVyJyk7XHJcbiAgICAgIGlmICghc3dpdGNoZXJQbHVnaW4gfHwgIXN3aXRjaGVyUGx1Z2luLmluc3RhbmNlKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBzd2l0Y2hlclBsdWdpbi5pbnN0YW5jZS5vcHRpb25zIHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGNyZWF0ZVNldHRpbmdzR3JvdXAgfSBmcm9tICcuLi91dGlscy9zZXR0aW5ncy1jb21wYXQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICBcclxuICAgIC8vIEFkZCBzY29waW5nIGNsYXNzIHRvIHByZXZlbnQgQ1NTIGZyb20gYWZmZWN0aW5nIG90aGVyIHNldHRpbmdzXHJcbiAgICBjb250YWluZXJFbC5hZGRDbGFzcygncHJvcGVydHktb3Zlci1maWxlbmFtZS1zZXR0aW5ncycpO1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIHNpbmdsZSBzZXR0aW5ncyBncm91cCB3aXRoIG5vIGhlYWRpbmcgKGZvbGxvd2luZyBVSSBUd2Vha2VyIHBhdHRlcm4pXHJcbiAgICBjb25zdCBnZW5lcmFsR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsKTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ1Byb3BlcnR5IGtleScpXHJcbiAgICAgICAgLnNldERlc2MoJ1RoZSBwcm9wZXJ0eSB0byB1c2UgYXMgdGhlIGRpc3BsYXkgdGl0bGUuIEZhbGxzIGJhY2sgdG8gdGhlIGZpbGUgbmFtZSB3aGVuIG5vIHByb3BlcnR5IGlzIHNldCBmb3IgdGhhdCBpdGVtLicpXHJcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignVGl0bGUnKVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXkpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleSA9IHZhbHVlLnRyaW0oKSB8fCAndGl0bGUnO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlR3JhcGhWaWV3KCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQmFja2xpbmtzKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlVGFicygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdXaGVuIGxpbmtpbmcgbm90ZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdFbmFibGUgcHJvcGVydHktYmFzZWQgdGl0bGVzIGluIHRoZSBsaW5rIHN1Z2dlc3Rlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZylcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckxpbmtpbmcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlTGlua1N1Z2dlc3RlcigpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIHF1aWNrIHN3aXRjaGVyJylcclxuICAgICAgICAuc2V0RGVzYygnRW5hYmxlIHByb3BlcnR5LWJhc2VkIHRpdGxlcyBpbiB0aGUgcXVpY2sgc3dpdGNoZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBwcmV2UXVpY2tTd2l0Y2hlclN0YXRlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKHByZXZRdWlja1N3aXRjaGVyU3RhdGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgZmlsZSBuYW1lIGluIGZ1enp5IHNlYXJjaGVzJylcclxuICAgICAgICAuc2V0RGVzYygnSW5jbHVkZSBub3RlIGZpbGUgbmFtZXMgaW4gZnV6enkgc2VhcmNoIHJlc3VsdHMgZm9yIGxpbmsgc3VnZ2VzdGVyIGFuZCBxdWljayBzd2l0Y2hlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2gpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIGFsaWFzZXMgaW4gZnV6enkgc2VhcmNoZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdJbmNsdWRlIHByb3BlcnR5IGFsaWFzZXMgaW4gZnV6enkgc2VhcmNoIHJlc3VsdHMgZm9yIGxpbmsgc3VnZ2VzdGVyIGFuZCBxdWljayBzd2l0Y2hlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUFsaWFzZXNJblNlYXJjaClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnV2hlbiBkcmFnZ2luZyBub3RlcycpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZXMgd2hlbiBkcmFnZ2luZyBub3RlcyBmcm9tIHRoZSBmaWxlIGV4cGxvcmVyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIGdyYXBoIHZpZXcnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBhcyB0aGUgbm90ZVxcJ3MgdGl0bGUgaW4gZ3JhcGggdmlldy4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUdyYXBoVmlldygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIGJhY2tsaW5rcyBhbmQgb3V0Z29pbmcgbGlua3MnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBpbiB0aGUgbGlua2VkIG1lbnRpb25zIGZvb3RlciwgZGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbCwgYW5kIG91dGdvaW5nIGxpbmtzLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQmFja2xpbmtzKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnSW4gdGFiIHRpdGxlcycpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSB0aGUgcHJvcGVydHkgaW5zdGVhZCBvZiB0aGUgZmlsZSBuYW1lIGluIHRhYiB0aXRsZXMuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclRhYnMpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBwcmV2VGFiU3RhdGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclRhYnMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3ModW5kZWZpbmVkLCBwcmV2VGFiU3RhdGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIHdpbmRvdyBmcmFtZSB0aXRsZScpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSB0aGUgcHJvcGVydHkgaW5zdGVhZCBvZiB0aGUgZmlsZSBuYW1lIGluIHRoZSBicm93c2VyIHdpbmRvdyB0aXRsZSBiYXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yV2luZG93RnJhbWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiBmaWxlIGV4cGxvcmVyJylcclxuICAgICAgICAuc2V0RGVzYygnVXNlIHRoZSBwcm9wZXJ0eSBpbnN0ZWFkIG9mIHRoZSBmaWxlIG5hbWUgaW4gdGhlIGZpbGUgZXhwbG9yZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlRXhwbG9yZXIoKTtcclxuICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0byBzaG93L2hpZGUgZm9sZGVyIG5vdGUgc2V0dGluZ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTaG93IGZvbGRlciBub3RlIGZpbGUgbmFtZSBzZXR0aW5nIG9ubHkgaWYgZXhwbG9yZXIgaXMgZW5hYmxlZFxyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgICAgc2V0dGluZ1xyXG4gICAgICAgICAgLnNldE5hbWUoJ0ZvbGRlciBub3RlIGZpbGUgbmFtZScpXHJcbiAgICAgICAgICAuc2V0RGVzYygnSWYgYSBmb2xkZXIgY29udGFpbnMgYSBmaWxlIHdpdGggdGhpcyBuYW1lIHRoYXQgaGFzIHRoZSBjb25maWd1cmVkIHByb3BlcnR5LCB0aGUgZm9sZGVyIHdpbGwgZGlzcGxheSB0aGF0IHByb3BlcnR5IHZhbHVlIGluc3RlYWQuIFRoaXMgZW5zdXJlcyBjb21wYXRpYmlsaXR5IHdpdGggZm9sZGVyIG5vdGVzIHBsdWdpbnMuIExlYXZlIGJsYW5rIHRvIGRpc2FibGUuJylcclxuICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdJbmRleCcpXHJcbiAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlck5vdGVGaWxlbmFtZSlcclxuICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUgPSB2YWx1ZS50cmltKCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVFeHBsb3JlcigpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICApO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ1VzZSBzaW1wbGUgc2VhcmNoJylcclxuICAgICAgICAuc2V0RGVzYygnSW5zdGVhZCBvZiB1c2luZyBmdXp6eSBzZWFyY2gsIHNpbXBsZSBzZWFyY2ggcHJvdmlkZXMgYmV0dGVyIHBlcmZvcm1hbmNlIHdpdGggdmVyeSBsYXJnZSB2YXVsdHMgKHRob3VzYW5kcyBvZiBmaWxlcykuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNpbXBsZVNlYXJjaClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNpbXBsZVNlYXJjaCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC8vIEZhbHNlIHBvc2l0aXZlOiBcIk1EWFwiIGlzIGEgcHJvcGVyIG5vdW4gKGZpbGUgZm9ybWF0IGFjcm9ueW0pIGFuZCBzaG91bGQgYmUgY2FwaXRhbGl6ZWRcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb2JzaWRpYW5tZC91aS9zZW50ZW5jZS1jYXNlXHJcbiAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBNRFggZmlsZSBzdXBwb3J0JylcclxuICAgICAgICAvLyBGYWxzZSBwb3NpdGl2ZTogXCJNRFhcIiBpcyBhIHByb3BlciBub3VuIChmaWxlIGZvcm1hdCBhY3JvbnltKSBhbmQgc2hvdWxkIGJlIGNhcGl0YWxpemVkXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG9ic2lkaWFubWQvdWkvc2VudGVuY2UtY2FzZVxyXG4gICAgICAgIC5zZXREZXNjKCdFbmFibGUgc3VwcG9ydCBmb3IgLm1keCBmaWxlcy4gV2hlbiBlbmFibGVkLCB0aGUgcGx1Z2luIHdpbGwgcmVhZCBmcm9udG1hdHRlciBmcm9tIE1EWCBmaWxlcyBtYW51YWxseSAoT2JzaWRpYW5cXCdzIG1ldGFkYXRhIGNhY2hlIG9ubHkgd29ya3MgZm9yIC5tZCBmaWxlcykuIE5vdGU6IE1EWCBzdXBwb3J0IGlzIHBhcnRpYWwgLSBncmFwaCB2aWV3IGlzIG5vdCBzdXBwb3J0ZWQgZHVlIHRvIHRlY2huaWNhbCBsaW1pdGF0aW9ucy4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgLy8gUmVidWlsZCBjYWNoZSBhbmQgcmVmcmVzaCBhbGwgY29tcG9uZW50cyB3aGVuIE1EWCBzdXBwb3J0IGlzIHRvZ2dsZWRcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5yZWJ1aWxkQ2FjaGUoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlUXVpY2tTd2l0Y2hlcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUdyYXBoVmlldygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVRhYnMoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVFeHBsb3JlcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIENvbXBhdGliaWxpdHkgdXRpbGl0aWVzIGZvciBzZXR0aW5nc1xyXG4gKiBQcm92aWRlcyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IGZvciBTZXR0aW5nR3JvdXAgKHJlcXVpcmVzIEFQSSAxLjExLjArKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNldHRpbmcsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBPYnNpZGlhbk1vZHVsZSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgd29ya3Mgd2l0aCBib3RoIFNldHRpbmdHcm91cCBhbmQgZmFsbGJhY2sgY29udGFpbmVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgc2V0dGluZ3MgY29udGFpbmVyIHRoYXQgdXNlcyBTZXR0aW5nR3JvdXAgaWYgYXZhaWxhYmxlIChBUEkgMS4xMS4wKyksXHJcbiAqIG90aGVyd2lzZSBmYWxscyBiYWNrIHRvIGNyZWF0aW5nIGEgaGVhZGluZyBhbmQgdXNpbmcgdGhlIGNvbnRhaW5lciBkaXJlY3RseS5cclxuICogXHJcbiAqIFVzZXMgcmVxdWlyZUFwaVZlcnNpb24oJzEuMTEuMCcpIHRvIGNoZWNrIGlmIFNldHRpbmdHcm91cCBpcyBhdmFpbGFibGUuXHJcbiAqIFRoaXMgaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmcuXHJcbiAqIFxyXG4gKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgY29udGFpbmVyIGVsZW1lbnQgZm9yIHNldHRpbmdzXHJcbiAqIEBwYXJhbSBoZWFkaW5nIC0gVGhlIGhlYWRpbmcgdGV4dCBmb3IgdGhlIHNldHRpbmdzIGdyb3VwIChvcHRpb25hbClcclxuICogQHJldHVybnMgQSBjb250YWluZXIgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nc0dyb3VwKFxyXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcclxuXHRoZWFkaW5nPzogc3RyaW5nXHJcbik6IFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcclxuXHQvLyByZXF1aXJlQXBpVmVyc2lvbiBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZ1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykpIHtcclxuXHRcdC8vIFVzZSBTZXR0aW5nR3JvdXAgLSBpdCdzIGd1YXJhbnRlZWQgdG8gZXhpc3QgaWYgcmVxdWlyZUFwaVZlcnNpb24gcmV0dXJucyB0cnVlXHJcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcclxuXHRcdC8vIGZvciBvbGRlciBUeXBlU2NyaXB0IHZlcnNpb25zLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWUgaW4gT2JzaWRpYW4gMS4xMS4wK1xyXG5cdFx0Ly8gVXNpbmcgdW5rbm93biBpbnN0ZWFkIG9mIGFueSB0byBzYXRpc2Z5IGVzbGludCB3aGlsZSBtYWludGFpbmluZyB0eXBlIHNhZmV0eVxyXG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoT2JzaWRpYW5Nb2R1bGUgYXMgdW5rbm93biBhcyB7IFNldHRpbmdHcm91cD86IG5ldyAoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRcdHNldEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKToge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdFx0fTtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0fSB9KS5TZXR0aW5nR3JvdXA7XHJcblx0XHRcclxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xyXG5cdFx0XHRjb25zdCBncm91cCA9IGhlYWRpbmcgXHJcblx0XHRcdFx0PyBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpLnNldEhlYWRpbmcoaGVhZGluZylcclxuXHRcdFx0XHQ6IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRcdGdyb3VwLmFkZFNldHRpbmcoY2IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gRmFsbGJhY2sgcGF0aCAoZWl0aGVyIEFQSSA8IDEuMTEuMCBvciBTZXR0aW5nR3JvdXAgbm90IGZvdW5kKVxyXG5cdHtcclxuXHRcdC8vIEZhbGxiYWNrOiBDcmVhdGUgYSBoZWFkaW5nIG1hbnVhbGx5IGZvciBvbGRlciBBUEkgdmVyc2lvbnNcclxuXHRcdC8vIE5vdGU6IFdoaWxlIGJlc3QgcHJhY3RpY2UgcHJlZmVycyBTZXR0aW5nLnNldEhlYWRpbmcoKSwgdGhlIGZhbGxiYWNrIHBhdGhcclxuXHRcdC8vIGlzIGZvciB2ZXJzaW9ucyB0aGF0IG1heSBub3Qgc3VwcG9ydCBpdCwgc28gbWFudWFsIGhlYWRpbmcgaXMgYXBwcm9wcmlhdGUgaGVyZVxyXG5cdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0Y29uc3QgaGVhZGluZ0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdzZXR0aW5nLWdyb3VwLWhlYWRpbmcnKTtcclxuXHRcdFx0aGVhZGluZ0VsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogaGVhZGluZyB9KTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG5cdFx0XHRcdGNiKHNldHRpbmcpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQ29tbWFuZHMocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gIC8vIFF1aWNrIFN3aXRjaGVyIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ29wZW4tcXVpY2stc3dpdGNoZXInLFxyXG4gICAgbmFtZTogJ09wZW4gcXVpY2sgc3dpdGNoZXIgKHByb3BlcnR5LWJhc2VkKScsXHJcbiAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IFF1aWNrU3dpdGNoTW9kYWwgfSA9IGF3YWl0IGltcG9ydCgnLi4vdWkvUXVpY2tTd2l0Y2hNb2RhbCcpO1xyXG4gICAgICBuZXcgUXVpY2tTd2l0Y2hNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4pLm9wZW4oKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIGxpbmtpbmcgY29tbWFuZFxyXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgIGlkOiAndG9nZ2xlLWxpbmtpbmcnLFxyXG4gICAgbmFtZTogJ1RvZ2dsZSBwcm9wZXJ0eS1iYXNlZCBsaW5raW5nJyxcclxuICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nID0gIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nO1xyXG4gICAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEocGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgcGx1Z2luLnVwZGF0ZUxpbmtTdWdnZXN0ZXIoKTtcclxuICAgICAgbmV3IE5vdGljZShgUHJvcGVydHktYmFzZWQgbGlua2luZyAke3BsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIFF1aWNrIFN3aXRjaGVyIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ3RvZ2dsZS1xdWljay1zd2l0Y2hlcicsXHJcbiAgICBuYW1lOiAnVG9nZ2xlIHByb3BlcnR5LWJhc2VkIHF1aWNrIHN3aXRjaGVyJyxcclxuICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyO1xyXG4gICAgICBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlciA9ICFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjtcclxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncyhwcmV2U3RhdGUpO1xyXG4gICAgICBuZXcgTm90aWNlKGBQcm9wZXJ0eS1iYXNlZCBRdWljayBTd2l0Y2hlciAke3BsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gUmVidWlsZCBjYWNoZSBjb21tYW5kXHJcbiAgcGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgaWQ6ICdyZWJ1aWxkLWNhY2hlJyxcclxuICAgIG5hbWU6ICdSZWJ1aWxkIGZpbGUgY2FjaGUnLFxyXG4gICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgcGx1Z2luLnJlYnVpbGRDYWNoZSgpO1xyXG4gICAgICBuZXcgTm90aWNlKCdGaWxlIGNhY2hlIHJlYnVpbHQnKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIGRyYWcgYW5kIGRyb3AgY29tbWFuZFxyXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgIGlkOiAndG9nZ2xlLWRyYWctZHJvcCcsXHJcbiAgICBuYW1lOiAnVG9nZ2xlIHByb3BlcnR5LWJhc2VkIGRyYWcgYW5kIGRyb3AnLFxyXG4gICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wID0gIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcDtcclxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgIG5ldyBOb3RpY2UoYFByb3BlcnR5LWJhc2VkIGRyYWcgYW5kIGRyb3AgJHtwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3AgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHBJbnRlcm5hbCwgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4sIFdvcmtzcGFjZUludGVybmFsIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUXVpY2tTd2l0Y2hlclNlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIG9yaWdpbmFsU3dpdGNoZXJDb21tYW5kPzoge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGljb24/OiBzdHJpbmc7XHJcbiAgICBob3RrZXlzOiBBcnJheTx7IG1vZGlmaWVyczogc3RyaW5nW107IGtleTogc3RyaW5nIH0+O1xyXG4gICAgY2FsbGJhY2s6ICgpID0+IHZvaWQ7XHJcbiAgfTtcclxuICBwcml2YXRlIGlzQ29tbWFuZE92ZXJyaWRkZW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICB1cGRhdGVRdWlja1N3aXRjaGVyKCkge1xyXG4gICAgLy8gT25seSBvdmVycmlkZSB0aGUgY29tbWFuZCBpZiBvdXIgUXVpY2sgU3dpdGNoZXIgaXMgZW5hYmxlZFxyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIgJiYgIXRoaXMuaXNDb21tYW5kT3ZlcnJpZGRlbikge1xyXG4gICAgICB0aGlzLm92ZXJyaWRlUXVpY2tTd2l0Y2hlckNvbW1hbmQoKTtcclxuICAgIH0gZWxzZSBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIgJiYgdGhpcy5pc0NvbW1hbmRPdmVycmlkZGVuKSB7XHJcbiAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgY29tbWFuZCB3aGVuIGRpc2FibGVkXHJcbiAgICAgIHRoaXMucmVzdG9yZU9yaWdpbmFsQ29tbWFuZCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvdmVycmlkZVF1aWNrU3dpdGNoZXJDb21tYW5kKCkge1xyXG4gICAgLy8gR2V0IHRoZSBjb21tYW5kIHJlZ2lzdHJ5XHJcbiAgICBjb25zdCBjb21tYW5kcyA9ICh0aGlzLnBsdWdpbi5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuY29tbWFuZHMuY29tbWFuZHM7XHJcblxyXG4gICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIGNvbW1hbmQgQkVGT1JFIHdlIGRlbGV0ZSBpdFxyXG4gICAgaWYgKGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gJiYgIXRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQpIHtcclxuICAgICAgY29uc3Qgb3JpZ2luYWxDbWQgPSBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddO1xyXG4gICAgICB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kID0ge1xyXG4gICAgICAgIGlkOiBvcmlnaW5hbENtZC5pZCB8fCAnc3dpdGNoZXI6b3BlbicsXHJcbiAgICAgICAgbmFtZTogb3JpZ2luYWxDbWQubmFtZSB8fCAnUXVpY2sgU3dpdGNoZXInLFxyXG4gICAgICAgIGljb246IG9yaWdpbmFsQ21kLmljb24sXHJcbiAgICAgICAgaG90a2V5czogb3JpZ2luYWxDbWQuaG90a2V5cyA/IFsuLi5vcmlnaW5hbENtZC5ob3RrZXlzXSA6IFtdLFxyXG4gICAgICAgIGNhbGxiYWNrOiBvcmlnaW5hbENtZC5jYWxsYmFja1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlbW92ZSB0aGUgb3JpZ2luYWwgY29tbWFuZCBjb21wbGV0ZWx5IHRvIGF2b2lkIGNvbmZsaWN0c1xyXG4gICAgaWYgKGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10pIHtcclxuICAgICAgZGVsZXRlIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ107XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JlYXRlIG91ciBjdXN0b20gY29tbWFuZCBvYmplY3RcclxuICAgIGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB7XHJcbiAgICAgIGlkOiAnc3dpdGNoZXI6b3BlbicsXHJcbiAgICAgIG5hbWU6ICdRdWljayBTd2l0Y2hlcicsXHJcbiAgICAgIGljb246IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQ/Lmljb24sXHJcbiAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogW1wiTW9kXCJdLCBrZXk6IFwib1wiIH1dLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgIC8vIFByZXZlbnQgYW55IGRlZmF1bHQgUXVpY2sgU3dpdGNoZXIgZnJvbSBvcGVuaW5nXHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZSBhcyB1bmtub3duIGFzIFdvcmtzcGFjZUludGVybmFsICYgeyBzd2l0Y2hlcj86IHsgY2xvc2UoKTogdm9pZCB9IH07XHJcbiAgICAgICAgaWYgKHdvcmtzcGFjZS5zd2l0Y2hlciAmJiB0eXBlb2Ygd29ya3NwYWNlLnN3aXRjaGVyLmNsb3NlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICB3b3Jrc3BhY2Uuc3dpdGNoZXIuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXNlIG91ciBjdXN0b20gbW9kYWwgd2hlbiB0aGlzIGNvbW1hbmQgaXMgYWN0aXZlXHJcbiAgICAgICAgLy8gQ2xvc2UgYW55IGV4aXN0aW5nIG1vZGFscyBmaXJzdFxyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsJyk7XHJcbiAgICAgICAgZXhpc3RpbmdNb2RhbHMuZm9yRWFjaChtb2RhbCA9PiB7XHJcbiAgICAgICAgICBpZiAobW9kYWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiAhbW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xyXG4gICAgICAgICAgICBtb2RhbC5hZGRDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGltcG9ydCgnLi4vdWkvUXVpY2tTd2l0Y2hNb2RhbCcpLnRoZW4oKHsgUXVpY2tTd2l0Y2hNb2RhbCB9KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFF1aWNrU3dpdGNoTW9kYWwodGhpcy5wbHVnaW4uYXBwLCB0aGlzLnBsdWdpbik7XHJcbiAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcclxuICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgY29tbWFuZCBpZiBvdXIgbW9kYWwgZmFpbHNcclxuICAgICAgICAgICAgaWYgKHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQgJiYgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBjb21tYW5kIGlmIG91ciBtb2RhbCBmYWlsc1xyXG4gICAgICAgICAgaWYgKHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQgJiYgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIERpcmVjdGx5IGFzc2lnbiB0byB0aGUgY29tbWFuZCByZWdpc3RyeSBpbnN0ZWFkIG9mIHVzaW5nIGFkZENvbW1hbmRcclxuICAgIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gPSBjdXN0b21Db21tYW5kO1xyXG5cclxuICAgIHRoaXMuaXNDb21tYW5kT3ZlcnJpZGRlbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICByZXN0b3JlT3JpZ2luYWxDb21tYW5kKCkge1xyXG4gICAgaWYgKCF0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW1vdmUgb3VyIGNvbW1hbmRcclxuICAgIGNvbnN0IGNvbW1hbmRzID0gKHRoaXMucGx1Z2luLmFwcCBhcyB1bmtub3duIGFzIEFwcEludGVybmFsKS5jb21tYW5kcy5jb21tYW5kcztcclxuICAgIGlmIChjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddKSB7XHJcbiAgICAgIGRlbGV0ZSBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIGNvbW1hbmRcclxuICAgIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gPSB7XHJcbiAgICAgIGlkOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmlkLFxyXG4gICAgICBuYW1lOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLm5hbWUsXHJcbiAgICAgIGljb246IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuaWNvbixcclxuICAgICAgaG90a2V5czogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5ob3RrZXlzLFxyXG4gICAgICBjYWxsYmFjazogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFja1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmlzQ29tbWFuZE92ZXJyaWRkZW4gPSBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBNYXJrZG93blZpZXcsIEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBnZXRGcm9udG1hdHRlclN5bmMgfSBmcm9tIFwiLi4vdXRpbHMvZnJvbnRtYXR0ZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBEcmFnRHJvcFNlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIGxhc3REcm9wVGltZTogbnVtYmVyID0gMDtcclxuICBwcml2YXRlIGxhc3REcm9wRGF0YTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBEUk9QX0RFQk9VTkNFX01TID0gMTAwOyAvLyBQcmV2ZW50IGR1cGxpY2F0ZSBwcm9jZXNzaW5nIHdpdGhpbiAxMDBtc1xyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGhhbmRsZURyYWdEcm9wKGV2ZW50OiBEcmFnRXZlbnQsIGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XHJcbiAgICAvLyBDUklUSUNBTDogQ2FwdHVyZSBkYXRhVHJhbnNmZXIgc3luY2hyb25vdXNseSBpbiBhIGxvY2FsIHZhcmlhYmxlXHJcbiAgICAvLyBUaGUgZXZlbnQuZGF0YVRyYW5zZmVyIGNhbiBiZWNvbWUgbnVsbC91bmRlZmluZWQgYWZ0ZXIgdGhlIGV2ZW50IGhhbmRsZXIgY29tcGxldGVzLFxyXG4gICAgLy8gc28gd2UgbXVzdCBjYXB0dXJlIGl0IGltbWVkaWF0ZWx5IGFuZCB1c2UgdGhlIGxvY2FsIHJlZmVyZW5jZVxyXG4gICAgY29uc3QgZGF0YVRyYW5zZmVyID0gZXZlbnQuZGF0YVRyYW5zZmVyO1xyXG4gICAgaWYgKCFkYXRhVHJhbnNmZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgZmlsZSBwYXRoIGZyb20gdGhlIGRyYWcgZXZlbnQgc3luY2hyb25vdXNseVxyXG4gICAgLy8gVGhpcyBtdXN0IGJlIGRvbmUgZHVyaW5nIHRoZSBldmVudCwgbm90IGluIHNldFRpbWVvdXRcclxuICAgIC8vIFVzZSB0aGUgY2FwdHVyZWQgZGF0YVRyYW5zZmVyIHJlZmVyZW5jZSwgbm90IGV2ZW50LmRhdGFUcmFuc2ZlclxyXG4gICAgY29uc3QgZmlsZVBhdGggPSBkYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xyXG4gICAgXHJcbiAgICBpZiAoIWZpbGVQYXRoIHx8ICghZmlsZVBhdGguZW5kc1dpdGgoJy5tZCcpICYmICEoZmlsZVBhdGguZW5kc1dpdGgoJy5tZHgnKSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIHByb2Nlc3NpbmcgaWYgYm90aCBoYW5kbGVycyBmaXJlIGZvciB0aGUgc2FtZSBkcm9wXHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgaWYgKG5vdyAtIHRoaXMubGFzdERyb3BUaW1lIDwgdGhpcy5EUk9QX0RFQk9VTkNFX01TICYmIHRoaXMubGFzdERyb3BEYXRhID09PSBmaWxlUGF0aCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmxhc3REcm9wVGltZSA9IG5vdztcclxuICAgIHRoaXMubGFzdERyb3BEYXRhID0gZmlsZVBhdGg7XHJcblxyXG4gICAgLy8gRmluZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHRcclxuICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcclxuICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZvciAubWQgZmlsZXMsIHVzZSBzeW5jaHJvbm91cyBsb2dpYyAoZmFzdCwgaW1tZWRpYXRlKVxyXG4gICAgLy8gRm9yIC5tZHggZmlsZXMsIHVzZSBhc3luYyBsb2dpYyB3aXRoIHJldHJpZXMgKG5lZWRzIGZpbGUgcmVhZGluZylcclxuICAgIGlmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHRoaXMuZ2V0RGlzcGxheU5hbWVTeW5jKGZpbGUpO1xyXG4gICAgICBpZiAoZGlzcGxheU5hbWUgIT09IG51bGwpIHtcclxuICAgICAgICAvLyBJbW1lZGlhdGUgcmVwbGFjZW1lbnQgZm9yIC5tZCBmaWxlcyAobm8gcmV0cmllcyBuZWVkZWQpXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGUsIGRpc3BsYXlOYW1lLCBlZGl0b3IpO1xyXG4gICAgICAgIH0sIDUwKTsgLy8gU2hvcnQgZGVsYXkganVzdCB0byBsZXQgT2JzaWRpYW4gaW5zZXJ0IHRoZSBsaW5rIGZpcnN0XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcclxuICAgICAgLy8gQXN5bmMgbG9naWMgd2l0aCByZXRyaWVzIGZvciAubWR4IGZpbGVzXHJcbiAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IGF3YWl0IHRoaXMuZ2V0RGlzcGxheU5hbWUoZmlsZSk7XHJcblxyXG4gICAgICAgIGlmIChkaXNwbGF5TmFtZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgLy8gVXNlIG11bHRpcGxlIGF0dGVtcHRzIHdpdGggaW5jcmVhc2luZyBkZWxheXMgdG8gY2F0Y2ggdGhlIGxpbmsgaW5zZXJ0aW9uXHJcbiAgICAgICAgICBsZXQgYXR0ZW1wdHMgPSAwO1xyXG4gICAgICAgICAgY29uc3QgbWF4QXR0ZW1wdHMgPSA1O1xyXG4gICAgICAgICAgY29uc3QgYXR0ZW1wdFJlcGxhY2UgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGF0dGVtcHRzKys7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VkID0gdGhpcy5yZXBsYWNlTGFzdEluc2VydGVkTGluayhmaWxlLCBkaXNwbGF5TmFtZSwgZWRpdG9yKTtcclxuICAgICAgICAgICAgaWYgKCFyZXBsYWNlZCAmJiBhdHRlbXB0cyA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgICAgc2V0VGltZW91dChhdHRlbXB0UmVwbGFjZSwgNTAgKiBhdHRlbXB0cyk7IC8vIEluY3JlYXNpbmcgZGVsYXk6IDUwbXMsIDEwMG1zLCAxNTBtcywgZXRjLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgc2V0VGltZW91dChhdHRlbXB0UmVwbGFjZSwgMTUwKTsgLy8gU3RhcnQgYWZ0ZXIgMTUwbXNcclxuICAgICAgICB9XHJcbiAgICAgIH0pKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBoYW5kbGVET01Ecm9wKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgIC8vIENoZWNrIGlmIHdlJ3JlIGRyb3BwaW5nIG9uIGFuIGVkaXRvclxyXG4gICAgLy8gVXNlIG11bHRpcGxlIG1ldGhvZHMgdG8gZGV0ZWN0IGVkaXRvciBjb250ZXh0LCBhcyBjbG9zZXN0KCkgY2FuIGZhaWxcclxuICAgIC8vIHdoZW4gZHJvcHBpbmcgb24gY20tbGluZSBlbGVtZW50cyB0aGF0IGFyZW4ndCBmdWxseSBhdHRhY2hlZCB0byBET00gKGxhcmdlIHZhdWx0IGxhZylcclxuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuICAgIFxyXG4gICAgLy8gTWV0aG9kIDE6IFRyeSBET00gdHJhdmVyc2FsICh3b3JrcyB3aGVuIGVsZW1lbnQgaXMgZnVsbHkgYXR0YWNoZWQpXHJcbiAgICBjb25zdCBlZGl0b3JFbGVtZW50ID0gdGFyZ2V0Py5jbG9zZXN0KCcuY20tZWRpdG9yJyk7XHJcbiAgICBcclxuICAgIC8vIE1ldGhvZCAyOiBGYWxsYmFjayAtIGNoZWNrIGlmIHRoZXJlJ3MgYW4gYWN0aXZlIG1hcmtkb3duIHZpZXcgd2l0aCBhbiBlZGl0b3JcclxuICAgIC8vIFRoaXMgd29ya3MgZXZlbiB3aGVuIERPTSB0cmF2ZXJzYWwgZmFpbHMgZHVlIHRvIHRpbWluZy9sYWcgaXNzdWVzIGluIGxhcmdlIHZhdWx0c1xyXG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgY29uc3QgaGFzQWN0aXZlRWRpdG9yID0gYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmVkaXRvcjtcclxuICAgIFxyXG4gICAgLy8gV2UgbmVlZCBhdCBsZWFzdCBvbmUgb2YgdGhlc2UgdG8gYmUgdHJ1ZSB0byBwcm9jZWVkXHJcbiAgICBpZiAoIWVkaXRvckVsZW1lbnQgJiYgIWhhc0FjdGl2ZUVkaXRvcikge1xyXG4gICAgICAvLyBOb3QgZHJvcHBpbmcgb24gYW4gZWRpdG9yIG9yIG5vIGFjdGl2ZSBlZGl0b3IgYXZhaWxhYmxlXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSWYgY2xvc2VzdCgpIGZhaWxlZCBidXQgd2UgaGF2ZSBhbiBhY3RpdmUgZWRpdG9yLCB3ZSBjYW4gc3RpbGwgcHJvY2VlZFxyXG4gICAgLy8gVGhlIGFjdGl2ZVZpZXcuZWRpdG9yIHdpbGwgYmUgdXNlZCBsYXRlciBpbiB0aGUgc2V0VGltZW91dFxyXG5cclxuICAgIC8vIENSSVRJQ0FMOiBDYXB0dXJlIGRhdGFUcmFuc2ZlciBzeW5jaHJvbm91c2x5IGluIGEgbG9jYWwgdmFyaWFibGVcclxuICAgIC8vIFRoZSBldmVudC5kYXRhVHJhbnNmZXIgY2FuIGJlY29tZSBudWxsL3VuZGVmaW5lZCBhZnRlciB0aGUgZXZlbnQgaGFuZGxlciBjb21wbGV0ZXMsXHJcbiAgICAvLyBzbyB3ZSBtdXN0IGNhcHR1cmUgaXQgaW1tZWRpYXRlbHkgYW5kIHVzZSB0aGUgbG9jYWwgcmVmZXJlbmNlXHJcbiAgICBjb25zdCBkYXRhVHJhbnNmZXIgPSBldmVudC5kYXRhVHJhbnNmZXI7XHJcbiAgICBpZiAoIWRhdGFUcmFuc2Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSBmaWxlIHBhdGggZnJvbSB0aGUgZHJhZyBldmVudCBzeW5jaHJvbm91c2x5XHJcbiAgICAvLyBUaGlzIG11c3QgYmUgZG9uZSBkdXJpbmcgdGhlIGV2ZW50LCBub3QgaW4gc2V0VGltZW91dFxyXG4gICAgLy8gVXNlIHRoZSBjYXB0dXJlZCBkYXRhVHJhbnNmZXIgcmVmZXJlbmNlLCBub3QgZXZlbnQuZGF0YVRyYW5zZmVyXHJcbiAgICBjb25zdCBmaWxlUGF0aCA9IGRhdGFUcmFuc2Zlci5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICBcclxuICAgIGlmICghZmlsZVBhdGgpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhcnNlIE9ic2lkaWFuIFVSTCBmb3JtYXQ6IG9ic2lkaWFuOi8vb3Blbj92YXVsdD0uLi4mZmlsZT0uLi5cclxuICAgIGxldCBhY3R1YWxGaWxlUGF0aCA9IGZpbGVQYXRoO1xyXG4gICAgaWYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoZmlsZVBhdGgpO1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXJhbSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdmaWxlJyk7XHJcbiAgICAgICAgaWYgKGZpbGVQYXJhbSkge1xyXG4gICAgICAgICAgY29uc3QgZGVjb2RlZFBhdGggPSBkZWNvZGVVUklDb21wb25lbnQoZmlsZVBhcmFtKTtcclxuICAgICAgICAgIC8vIE9ic2lkaWFuIFVSTHMgbWlnaHQgbm90IGluY2x1ZGUgdGhlIGV4dGVuc2lvblxyXG4gICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgdGhlIGZpbGUgd2l0aCBib3RoIC5tZCBhbmQgLm1keCBleHRlbnNpb25zXHJcbiAgICAgICAgICBpZiAoZGVjb2RlZFBhdGguZW5kc1dpdGgoJy5tZHgnKSkge1xyXG4gICAgICAgICAgICAvLyBBbHJlYWR5IGhhcyAubWR4IGV4dGVuc2lvblxyXG4gICAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZWRQYXRoO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChkZWNvZGVkUGF0aC5lbmRzV2l0aCgnLm1kJykpIHtcclxuICAgICAgICAgICAgLy8gQWxyZWFkeSBoYXMgLm1kIGV4dGVuc2lvblxyXG4gICAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZWRQYXRoO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTm8gZXh0ZW5zaW9uIC0gdHJ5IC5tZHggZmlyc3QgaWYgTURYIHN1cHBvcnQgaXMgZW5hYmxlZCwgdGhlbiBmYWxsIGJhY2sgdG8gLm1kXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWR4RmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGVjb2RlZFBhdGggKyAnLm1keCcpO1xyXG4gICAgICAgICAgICAgIGlmIChtZHhGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZWRQYXRoICsgJy5tZHgnO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZWRQYXRoICsgJy5tZCc7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGFjdHVhbEZpbGVQYXRoID0gZGVjb2RlZFBhdGggKyAnLm1kJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoIWZpbGVQYXRoLmVuZHNXaXRoKCcubWQnKSAmJiAhKGZpbGVQYXRoLmVuZHNXaXRoKCcubWR4JykgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIHByb2Nlc3NpbmcgaWYgYm90aCBoYW5kbGVycyBmaXJlIGZvciB0aGUgc2FtZSBkcm9wXHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgaWYgKG5vdyAtIHRoaXMubGFzdERyb3BUaW1lIDwgdGhpcy5EUk9QX0RFQk9VTkNFX01TICYmIHRoaXMubGFzdERyb3BEYXRhID09PSBhY3R1YWxGaWxlUGF0aCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmxhc3REcm9wVGltZSA9IG5vdztcclxuICAgIHRoaXMubGFzdERyb3BEYXRhID0gYWN0dWFsRmlsZVBhdGg7XHJcblxyXG4gICAgLy8gRmluZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHRcclxuICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGFjdHVhbEZpbGVQYXRoKTtcclxuICAgIFxyXG4gICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSBkaXNwbGF5IG5hbWUgZnJvbSBmcm9udG1hdHRlciAob25seSBpZiBwcm9wZXJ0eSBleGlzdHMpXHJcbiAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIEZvciAubWQgZmlsZXMsIHVzZSBzeW5jaHJvbm91cyBsb2dpYyAoZmFzdCwgaW1tZWRpYXRlKVxyXG4gICAgICAvLyBGb3IgLm1keCBmaWxlcywgdXNlIGFzeW5jIGxvZ2ljIHdpdGggcmV0cmllcyAobmVlZHMgZmlsZSByZWFkaW5nKVxyXG4gICAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHRoaXMuZ2V0RGlzcGxheU5hbWVTeW5jKGZpbGUpO1xyXG4gICAgICAgIGlmIChkaXNwbGF5TmFtZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgLy8gSW1tZWRpYXRlIHJlcGxhY2VtZW50IGZvciAubWQgZmlsZXMgKG5vIHJldHJpZXMgbmVlZGVkKVxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5lZGl0b3IpIHtcclxuICAgICAgICAgICAgICB0aGlzLnJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGUsIGRpc3BsYXlOYW1lLCBhY3RpdmVWaWV3LmVkaXRvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIDUwKTsgLy8gU2hvcnQgZGVsYXkganVzdCB0byBsZXQgT2JzaWRpYW4gaW5zZXJ0IHRoZSBsaW5rIGZpcnN0XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgICAgLy8gQXN5bmMgbG9naWMgd2l0aCByZXRyaWVzIGZvciAubWR4IGZpbGVzXHJcbiAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBhd2FpdCB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoZGlzcGxheU5hbWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgLy8gVXNlIG11bHRpcGxlIGF0dGVtcHRzIHdpdGggaW5jcmVhc2luZyBkZWxheXMgdG8gY2F0Y2ggdGhlIGxpbmsgaW5zZXJ0aW9uXHJcbiAgICAgICAgICAgIGxldCBhdHRlbXB0cyA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IG1heEF0dGVtcHRzID0gNTtcclxuICAgICAgICAgICAgY29uc3QgYXR0ZW1wdFJlcGxhY2UgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgYXR0ZW1wdHMrKztcclxuICAgICAgICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5lZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VkID0gdGhpcy5yZXBsYWNlTGFzdEluc2VydGVkTGluayhmaWxlLCBkaXNwbGF5TmFtZSwgYWN0aXZlVmlldy5lZGl0b3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyZXBsYWNlZCAmJiBhdHRlbXB0cyA8IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDUwICogYXR0ZW1wdHMpOyAvLyBJbmNyZWFzaW5nIGRlbGF5OiA1MG1zLCAxMDBtcywgMTUwbXMsIGV0Yy5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGF0dGVtcHRzIDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDUwICogYXR0ZW1wdHMpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChhdHRlbXB0UmVwbGFjZSwgMTUwKTsgLy8gU3RhcnQgYWZ0ZXIgMTUwbXNcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KSgpO1xyXG4gICAgICB9XHJcbiAgICB9KSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3luY2hyb25vdXMgdmVyc2lvbiBmb3IgLm1kIGZpbGVzIChmYXN0LCBpbW1lZGlhdGUpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXREaXNwbGF5TmFtZVN5bmMoZmlsZTogVEZpbGUpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGlmIChmaWxlLmV4dGVuc2lvbiAhPT0gJ21kJykge1xyXG4gICAgICByZXR1cm4gbnVsbDsgLy8gT25seSBmb3IgLm1kIGZpbGVzXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBnZXRGcm9udG1hdHRlclN5bmModGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICBcclxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0pLnRyaW0oKTtcclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHByb3BlcnR5VmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDsgLy8gTm8gcHJvcGVydHkgLSB1c2UgZGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvclxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXN5bmMgdmVyc2lvbiBmb3IgLm1keCBmaWxlcyAobmVlZHMgZmlsZSByZWFkaW5nKVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGNvbnN0IHsgZ2V0RnJvbnRtYXR0ZXIsIGlzRmlsZVR5cGVTdXBwb3J0ZWQgfSA9IGF3YWl0IGltcG9ydCgnLi4vdXRpbHMvZnJvbnRtYXR0ZXInKTtcclxuICAgIFxyXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXHJcbiAgICBpZiAoIWlzRmlsZVR5cGVTdXBwb3J0ZWQoZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgXHJcbiAgICAvLyBPbmx5IHJldHVybiBkaXNwbGF5IG5hbWUgaWYgdGhlIHByb3BlcnR5IGV4aXN0cyBhbmQgaGFzIGEgdmFsdWVcclxuICAgIC8vIFJldHVybiBudWxsIGlmIHByb3BlcnR5IGRvZXNuJ3QgZXhpc3QgKHRvIGluZGljYXRlIHdlIHNob3VsZCB1c2UgZGVmYXVsdCBiZWhhdmlvcilcclxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0pLnRyaW0oKTtcclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHByb3BlcnR5VmFsdWU7IC8vIFVzZSBmcm9udG1hdHRlciB0aXRsZVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7IC8vIE5vIHByb3BlcnR5IC0gdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3JcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVwbGFjZUxhc3RJbnNlcnRlZExpbmsoZmlsZTogVEZpbGUsIGRpc3BsYXlOYW1lOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XHJcbiAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcbiAgICBcclxuICAgIC8vIExvb2sgZm9yIHRoZSBtb3N0IHJlY2VudGx5IGluc2VydGVkIGxpbmsgbmVhciB0aGUgY3Vyc29yXHJcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xyXG4gICAgY29uc3QgY3VycmVudExpbmUgPSBsaW5lc1tjdXJzb3IubGluZV07XHJcbiAgICBcclxuICAgIC8vIEZpbmQgd2lraSBsaW5rcyBvciBtYXJrZG93biBsaW5rcyBvbiB0aGUgY3VycmVudCBsaW5lXHJcbiAgICAvLyBVcGRhdGVkIHJlZ2V4IHRvIGhhbmRsZSBNRFggZmlsZXMgLSB0aGV5IG1pZ2h0IGhhdmUgLm1keCBleHRlbnNpb24gaW4gdGhlIGxpbmtcclxuICAgIC8vIE5vdGU6IG1hcmtkb3duIGxpbmtzIGNhbiBoYXZlIGVtcHR5IGJyYWNrZXRzOiBbXShmaWxlLm1keClcclxuICAgIGNvbnN0IHdpa2lMaW5rUmVnZXggPSAvXFxbXFxbKFteXFxdXSspXFxdXFxdL2c7XHJcbiAgICBjb25zdCBtYXJrZG93bkxpbmtSZWdleCA9IC9cXFsoW15cXF1dKilcXF1cXCgoW14pXSspXFwpL2c7IC8vIEFsbG93IGVtcHR5IGJyYWNrZXRzIHdpdGggKlxyXG4gICAgXHJcbiAgICBsZXQgbWF0Y2g7XHJcbiAgICBsZXQgbGFzdE1hdGNoID0gbnVsbDtcclxuICAgIFxyXG4gICAgLy8gRmluZCB0aGUgbGFzdCB3aWtpIGxpbmsgb24gdGhlIGN1cnJlbnQgbGluZVxyXG4gICAgd2hpbGUgKChtYXRjaCA9IHdpa2lMaW5rUmVnZXguZXhlYyhjdXJyZW50TGluZSkpICE9PSBudWxsKSB7XHJcbiAgICAgIGxhc3RNYXRjaCA9IG1hdGNoO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAobGFzdE1hdGNoKSB7XHJcbiAgICAgIGNvbnN0IGxpbmtQYXRoID0gbGFzdE1hdGNoWzFdO1xyXG4gICAgICAvLyBDaGVjayBpZiB0aGlzIGxpbmsgbWF0Y2hlcyBvdXIgZmlsZSAod2l0aCBvciB3aXRob3V0IGV4dGVuc2lvbilcclxuICAgICAgY29uc3QgZmlsZVBhdGhXaXRob3V0RXh0ID0gZmlsZS5wYXRoLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcclxuICAgICAgY29uc3QgbGlua1BhdGhXaXRob3V0RXh0ID0gbGlua1BhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGZpbGVQYXRoV2l0aG91dEV4dCA9PT0gbGlua1BhdGhXaXRob3V0RXh0IHx8IGZpbGUucGF0aCA9PT0gbGlua1BhdGggfHwgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1keCQvLCAnLm1kJykgPT09IGxpbmtQYXRoKSB7XHJcbiAgICAgICAgY29uc3QgbmV3TGlua1RleHQgPSBgW1ske2xpbmtQYXRofXwke2Rpc3BsYXlOYW1lfV1dYDtcclxuICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBsYXN0TWF0Y2guaW5kZXggfTtcclxuICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4ICsgbGFzdE1hdGNoWzBdLmxlbmd0aCB9O1xyXG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3TGlua1RleHQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFJlc2V0IHJlZ2V4IGZvciBtYXJrZG93biBsaW5rc1xyXG4gICAgbWFya2Rvd25MaW5rUmVnZXgubGFzdEluZGV4ID0gMDtcclxuICAgIGxhc3RNYXRjaCA9IG51bGw7XHJcbiAgICBcclxuICAgIC8vIEZpbmQgdGhlIGxhc3QgbWFya2Rvd24gbGluayBvbiB0aGUgY3VycmVudCBsaW5lXHJcbiAgICB3aGlsZSAoKG1hdGNoID0gbWFya2Rvd25MaW5rUmVnZXguZXhlYyhjdXJyZW50TGluZSkpICE9PSBudWxsKSB7XHJcbiAgICAgIGxhc3RNYXRjaCA9IG1hdGNoO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAobGFzdE1hdGNoKSB7XHJcbiAgICAgIGNvbnN0IGxpbmtVcmwgPSBsYXN0TWF0Y2hbMl07XHJcbiAgICAgIGNvbnN0IGxpbmtVcmxEZWNvZGVkID0gZGVjb2RlVVJJQ29tcG9uZW50KGxpbmtVcmwpO1xyXG4gICAgICAvLyBDaGVjayBpZiB0aGlzIGxpbmsgbWF0Y2hlcyBvdXIgZmlsZVxyXG4gICAgICBjb25zdCBmaWxlUGF0aEVuY29kZWQgPSBlbmNvZGVVUkkoZmlsZS5wYXRoKTtcclxuICAgICAgY29uc3QgZmlsZVBhdGhXaXRob3V0RXh0ID0gZmlsZS5wYXRoLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcclxuICAgICAgY29uc3QgbGlua1VybFdpdGhvdXRFeHQgPSBsaW5rVXJsRGVjb2RlZC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayB2YXJpb3VzIG1hdGNoaW5nIHNjZW5hcmlvc1xyXG4gICAgICBjb25zdCBtYXRjaGVzID0gXHJcbiAgICAgICAgZmlsZS5wYXRoID09PSBsaW5rVXJsRGVjb2RlZCB8fCBcclxuICAgICAgICBmaWxlUGF0aEVuY29kZWQgPT09IGxpbmtVcmwgfHxcclxuICAgICAgICBmaWxlUGF0aFdpdGhvdXRFeHQgPT09IGxpbmtVcmxXaXRob3V0RXh0IHx8XHJcbiAgICAgICAgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1keCQvLCAnLm1kJykgPT09IGxpbmtVcmxEZWNvZGVkIHx8XHJcbiAgICAgICAgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1kJC8sICcubWR4JykgPT09IGxpbmtVcmxEZWNvZGVkIHx8XHJcbiAgICAgICAgLy8gSGFuZGxlIHJlbGF0aXZlIHBhdGhzIC0gY2hlY2sgaWYgbGluayBVUkwgbWF0Y2hlcyBmaWxlIGJhc2VuYW1lXHJcbiAgICAgICAgZmlsZS5iYXNlbmFtZSA9PT0gbGlua1VybERlY29kZWQucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpIHx8XHJcbiAgICAgICAgZmlsZS5iYXNlbmFtZSArICcubWR4JyA9PT0gbGlua1VybERlY29kZWQgfHxcclxuICAgICAgICBmaWxlLmJhc2VuYW1lICsgJy5tZCcgPT09IGxpbmtVcmxEZWNvZGVkIHx8XHJcbiAgICAgICAgLy8gSGFuZGxlIHBhdGhzIHdpdGggZGlyZWN0b3J5XHJcbiAgICAgICAgZmlsZS5wYXRoLmVuZHNXaXRoKGxpbmtVcmxEZWNvZGVkKSB8fFxyXG4gICAgICAgIGxpbmtVcmxEZWNvZGVkLmVuZHNXaXRoKGZpbGUucGF0aCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAobWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IG5ld0xpbmtUZXh0ID0gYFske2Rpc3BsYXlOYW1lfV0oJHtsaW5rVXJsfSlgO1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGxhc3RNYXRjaC5pbmRleCB9O1xyXG4gICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBsYXN0TWF0Y2guaW5kZXggKyBsYXN0TWF0Y2hbMF0ubGVuZ3RoIH07XHJcbiAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdMaW5rVGV4dCwgc3RhcnRQb3MsIGVuZFBvcyk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFRyeSBzZWFyY2hpbmcgYSBmZXcgbGluZXMgYXJvdW5kIHRoZSBjdXJzb3JcclxuICAgICAgY29uc3Qgc2VhcmNoUmFuZ2UgPSAzO1xyXG4gICAgICBmb3IgKGxldCBpID0gTWF0aC5tYXgoMCwgY3Vyc29yLmxpbmUgLSBzZWFyY2hSYW5nZSk7IGkgPD0gTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3Vyc29yLmxpbmUgKyBzZWFyY2hSYW5nZSk7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcclxuICAgICAgICBjb25zdCB3aWtpTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKC9cXFtcXFsoW15cXF1dKylcXF1cXF0vZyldO1xyXG4gICAgICAgIGNvbnN0IG1hcmtkb3duTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKC9cXFsoW15cXF1dKilcXF1cXCgoW14pXSspXFwpL2cpXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDaGVjayB3aWtpIGxpbmtzXHJcbiAgICAgICAgZm9yIChjb25zdCB3aWtpTWF0Y2ggb2Ygd2lraU1hdGNoZXMpIHtcclxuICAgICAgICAgIGNvbnN0IGxpbmtQYXRoID0gd2lraU1hdGNoWzFdO1xyXG4gICAgICAgICAgY29uc3QgZmlsZVBhdGhXaXRob3V0RXh0ID0gZmlsZS5wYXRoLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcclxuICAgICAgICAgIGNvbnN0IGxpbmtQYXRoV2l0aG91dEV4dCA9IGxpbmtQYXRoLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKGZpbGVQYXRoV2l0aG91dEV4dCA9PT0gbGlua1BhdGhXaXRob3V0RXh0IHx8IGZpbGUucGF0aCA9PT0gbGlua1BhdGggfHwgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1keCQvLCAnLm1kJykgPT09IGxpbmtQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0xpbmtUZXh0ID0gYFtbJHtsaW5rUGF0aH18JHtkaXNwbGF5TmFtZX1dXWA7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoSW5kZXggPSB3aWtpTWF0Y2guaW5kZXggPz8gMDtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IGksIGNoOiBtYXRjaEluZGV4IH07XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogaSwgY2g6IG1hdGNoSW5kZXggKyB3aWtpTWF0Y2hbMF0ubGVuZ3RoIH07XHJcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3TGlua1RleHQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgbWFya2Rvd24gbGlua3NcclxuICAgICAgICBmb3IgKGNvbnN0IG1kTWF0Y2ggb2YgbWFya2Rvd25NYXRjaGVzKSB7XHJcbiAgICAgICAgICBjb25zdCBsaW5rVXJsID0gbWRNYXRjaFsyXTtcclxuICAgICAgICAgIC8vIEhhbmRsZSBib3RoIHJlbGF0aXZlIHBhdGhzIChiaWctdGVzdC5tZHgpIGFuZCBmdWxsIHBhdGhzIChwb3N0cy9iaWctdGVzdC5tZHgpXHJcbiAgICAgICAgICBjb25zdCBsaW5rVXJsRGVjb2RlZCA9IGRlY29kZVVSSUNvbXBvbmVudChsaW5rVXJsKTtcclxuICAgICAgICAgIGNvbnN0IGZpbGVQYXRoV2l0aG91dEV4dCA9IGZpbGUucGF0aC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJyk7XHJcbiAgICAgICAgICBjb25zdCBsaW5rVXJsV2l0aG91dEV4dCA9IGxpbmtVcmxEZWNvZGVkLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2hlY2sgdmFyaW91cyBtYXRjaGluZyBzY2VuYXJpb3NcclxuICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBcclxuICAgICAgICAgICAgZmlsZS5wYXRoID09PSBsaW5rVXJsRGVjb2RlZCB8fCBcclxuICAgICAgICAgICAgZW5jb2RlVVJJKGZpbGUucGF0aCkgPT09IGxpbmtVcmwgfHxcclxuICAgICAgICAgICAgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1keCQvLCAnLm1kJykgPT09IGxpbmtVcmxEZWNvZGVkIHx8XHJcbiAgICAgICAgICAgIGZpbGUucGF0aC5yZXBsYWNlKC9cXC5tZCQvLCAnLm1keCcpID09PSBsaW5rVXJsRGVjb2RlZCB8fFxyXG4gICAgICAgICAgICBmaWxlUGF0aFdpdGhvdXRFeHQgPT09IGxpbmtVcmxXaXRob3V0RXh0IHx8XHJcbiAgICAgICAgICAgIC8vIEhhbmRsZSByZWxhdGl2ZSBwYXRocyAtIGNoZWNrIGlmIGxpbmsgVVJMIG1hdGNoZXMgZmlsZSBiYXNlbmFtZVxyXG4gICAgICAgICAgICBmaWxlLmJhc2VuYW1lID09PSBsaW5rVXJsRGVjb2RlZC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJykgfHxcclxuICAgICAgICAgICAgZmlsZS5iYXNlbmFtZSArICcubWR4JyA9PT0gbGlua1VybERlY29kZWQgfHxcclxuICAgICAgICAgICAgZmlsZS5iYXNlbmFtZSArICcubWQnID09PSBsaW5rVXJsRGVjb2RlZCB8fFxyXG4gICAgICAgICAgICAvLyBIYW5kbGUgcGF0aHMgd2l0aCBkaXJlY3RvcnlcclxuICAgICAgICAgICAgZmlsZS5wYXRoLmVuZHNXaXRoKGxpbmtVcmxEZWNvZGVkKSB8fFxyXG4gICAgICAgICAgICBsaW5rVXJsRGVjb2RlZC5lbmRzV2l0aChmaWxlLnBhdGgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAobWF0Y2hlcykge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdMaW5rVGV4dCA9IGBbJHtkaXNwbGF5TmFtZX1dKCR7bGlua1VybH0pYDtcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2hJbmRleCA9IG1kTWF0Y2guaW5kZXggPz8gMDtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IGksIGNoOiBtYXRjaEluZGV4IH07XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogaSwgY2g6IG1hdGNoSW5kZXggKyBtZE1hdGNoWzBdLmxlbmd0aCB9O1xyXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0xpbmtUZXh0LCBzdGFydFBvcywgZW5kUG9zKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEVkaXRvclN1Z2dlc3QsIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2FjaGVTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBzdWdnZXN0PzogRWRpdG9yU3VnZ2VzdDtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBzZXRTdWdnZXN0KHN1Z2dlc3Q6IEVkaXRvclN1Z2dlc3QpIHtcclxuICAgIHRoaXMuc3VnZ2VzdCA9IHN1Z2dlc3Q7XHJcbiAgfVxyXG5cclxuICBpbnZhbGlkYXRlQ2FjaGUoZmlsZTogVEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnN1Z2dlc3QpIHtcclxuICAgICAgLy8gdXBkYXRlRmlsZUNhY2hlIGlzIG5vdyBhc3luYywgYnV0IHdlIGNhbid0IGF3YWl0IGhlcmVcclxuICAgICAgLy8gVGhlIGNhY2hlIHdpbGwgYmUgdXBkYXRlZCBhc3luY2hyb25vdXNseVxyXG4gICAgICB2b2lkIHRoaXMuc3VnZ2VzdC51cGRhdGVGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZWJ1aWxkQ2FjaGUoKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5zdWdnZXN0KSB7XHJcbiAgICAgIC8vIGJ1aWxkRmlsZUNhY2hlIGlzIG5vdyBhc3luYywgYnV0IHdlIGNhbid0IGF3YWl0IGhlcmVcclxuICAgICAgLy8gVGhlIGNhY2hlIHdpbGwgYmUgcmVidWlsdCBhc3luY2hyb25vdXNseVxyXG4gICAgICB2b2lkIHRoaXMuc3VnZ2VzdC5idWlsZEZpbGVDYWNoZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIEdyYXBoIFZpZXcgU2VydmljZVxyXG4gKiBcclxuICogVGhpcyBmaWxlIGNvbnRhaW5zIGNvZGUgYWRhcHRlZCBmcm9tIHRoZSBOb2RlIE1hc3F1ZXJhZGUgcGx1Z2luIGJ5IEVsc2FUYW0uXHJcbiAqIE9yaWdpbmFsIHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL0thcGlya2xhYS9vYnNpZGlhbi1ub2RlLW1hc3F1ZXJhZGVcclxuICogXHJcbiAqIFRoZSBjb2RlIGhhcyBiZWVuIG1vZGlmaWVkIHRvIGludGVncmF0ZSB3aXRoIHRoZSBQcm9wZXJ0eSBPdmVyIEZpbGUgTmFtZSBwbHVnaW5cclxuICogYW5kIHVzZSB0aGUgcGx1Z2luJ3MgcHJvcGVydHkga2V5IHNldHRpbmcgaW5zdGVhZCBvZiBOb2RlIE1hc3F1ZXJhZGUncyBjb25maWd1cmF0aW9uLlxyXG4gKiBcclxuICogT3JpZ2luYWwgY29kZSBpcyBsaWNlbnNlZCB1bmRlciBHUEx2My4gVGhpcyBmaWxlIGlzIGFsc28gbGljZW5zZWQgdW5kZXIgR1BMdjMuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBWaWV3LCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgZnJvbnRtYXR0ZXJDYWNoZSB9IGZyb20gJy4uL3V0aWxzL2Zyb250bWF0dGVyLWNhY2hlJztcclxuXHJcbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIGdyYXBoIHZpZXcgaW50ZXJuYWxzXHJcbmludGVyZmFjZSBHcmFwaE5vZGVDb2xsZWN0aW9uIHtcclxuICBmaXJzdCgpOiBHcmFwaE5vZGUgfCB1bmRlZmluZWQ7XHJcbiAgW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmF0b3I8R3JhcGhOb2RlPjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEdyYXBoVmlldyB7XHJcbiAgcmVuZGVyZXI6IHtcclxuICAgIG5vZGVzOiBHcmFwaE5vZGVDb2xsZWN0aW9uO1xyXG4gICAgY2hhbmdlZCgpOiB2b2lkO1xyXG4gIH07XHJcbn1cclxuXHJcbmludGVyZmFjZSBMb2NhbEdyYXBoVmlldyB7XHJcbiAgcmVuZGVyZXI6IHtcclxuICAgIG5vZGVzOiBHcmFwaE5vZGVDb2xsZWN0aW9uO1xyXG4gICAgY2hhbmdlZCgpOiB2b2lkO1xyXG4gIH07XHJcbn1cclxuXHJcbmludGVyZmFjZSBHcmFwaE5vZGUge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdGV4dD86IHtcclxuICAgIHRleHQ6IHN0cmluZztcclxuICB9O1xyXG4gIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZztcclxuICBwb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dD86ICgpID0+IHN0cmluZztcclxuICBwb3ZfcGx1Z2luPzogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBHcmFwaE5vZGVQcm90b3R5cGUge1xyXG4gIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZztcclxuICBwb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dD86ICgpID0+IHN0cmluZztcclxuICBwb3ZfcGx1Z2luPzogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBHcmFwaE5vZGVDb2xsZWN0aW9uV2l0aEZpcnN0IGV4dGVuZHMgR3JhcGhOb2RlQ29sbGVjdGlvbiB7XHJcbiAgZmlyc3QoKTogR3JhcGhOb2RlIHwgdW5kZWZpbmVkO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgR3JhcGhWaWV3U2VydmljZSB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgbW9kaWZpZWRQcm90b3R5cGVzOiBHcmFwaE5vZGVQcm90b3R5cGVbXSA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlR2V0RGlzcGxheVRleHQoYXBwOiBBcHApIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBnZXREaXNwbGF5VGV4dCh0aGlzOiBHcmFwaE5vZGUpOiBzdHJpbmcge1xyXG4gICAgICBjb25zdCBwbHVnaW4gPSB0aGlzLnBvdl9wbHVnaW47XHJcbiAgICAgIGlmICghcGx1Z2luIHx8ICFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgICAgLy8gSWYgZGlzYWJsZWQgb3IgcGx1Z2luIG5vdCBmb3VuZCwgdXNlIG9yaWdpbmFsXHJcbiAgICAgICAgaWYgKHRoaXMucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQpIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcigncG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQgZG9lcyBub3QgZXhpc3Qgb24gbm9kZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBUcnkgdG8gZ2V0IHByb3BlcnR5IHZhbHVlXHJcbiAgICAgIGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0RmlsZUJ5UGF0aCh0aGlzLmlkKTtcclxuICAgICAgaWYgKGZpbGUpIHtcclxuICAgICAgICAvLyBGb3IgTUQgZmlsZXMsIHVzZSBtZXRhZGF0YSBjYWNoZSBkaXJlY3RseSAoZmFzdCBzeW5jIGFjY2VzcylcclxuICAgICAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgICAgIGNvbnN0IGZpbGVDYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgIGNvbnN0IG1kRnJvbnRtYXR0ZXIgPSBmaWxlQ2FjaGU/LmZyb250bWF0dGVyO1xyXG4gICAgICAgICAgaWYgKG1kRnJvbnRtYXR0ZXIgJiYgbWRGcm9udG1hdHRlcltwbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgbWRGcm9udG1hdHRlcltwbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcobWRGcm9udG1hdHRlcltwbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XHJcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZvciBNRFggZmlsZXMsIHVzZSBjYWNoZSAocG9wdWxhdGVkIGFzeW5jLCBidXQgYWNjZXNzZWQgc3luYylcclxuICAgICAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgICAgICAvLyBUcmlnZ2VyIGFzeW5jIHJlYWQgdG8gcG9wdWxhdGUgY2FjaGUgaWYgbm90IGFscmVhZHkgY2FjaGVkIChmaXJlIGFuZCBmb3JnZXQpXHJcbiAgICAgICAgICBjb25zdCBjYWNoZWQgPSBmcm9udG1hdHRlckNhY2hlLmdldFN5bmMoZmlsZS5wYXRoKTtcclxuICAgICAgICAgIGlmICghY2FjaGVkKSB7XHJcbiAgICAgICAgICAgIHZvaWQgZnJvbnRtYXR0ZXJDYWNoZS5nZXQoYXBwLCBmaWxlLCBwbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBUcnkgdG8gZ2V0IGZyb20gY2FjaGVcclxuICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXJDYWNoZS5nZXRTeW5jKGZpbGUucGF0aCk7XHJcbiAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbcGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyW3BsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhmcm9udG1hdHRlcltwbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XHJcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBGYWxsIGJhY2sgdG8gb3JpZ2luYWwgZGlzcGxheSB0ZXh0IChmaWxlIG5hbWUpXHJcbiAgICAgIGlmICh0aGlzLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQoKTtcclxuICAgICAgfVxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Bvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0IGRvZXMgbm90IGV4aXN0IG9uIG5vZGUnKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEdyYXBoTGVhdmVzKCk6IFdvcmtzcGFjZUxlYWZbXSB7XHJcbiAgICBjb25zdCBsZWF2ZXM6IFdvcmtzcGFjZUxlYWZbXSA9IFtdO1xyXG4gICAgbGVhdmVzLnB1c2goLi4udGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2dyYXBoJykpO1xyXG4gICAgbGVhdmVzLnB1c2goLi4udGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2xvY2FsZ3JhcGgnKSk7XHJcbiAgICByZXR1cm4gWy4uLm5ldyBTZXQobGVhdmVzKV07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG92ZXJyaWRlUHJvdG90eXBlcygpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmdldEdyYXBoTGVhdmVzKCk7XHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcbiAgICAgIGlmICghKGxlYWYudmlldyBpbnN0YW5jZW9mIFZpZXcpIHx8IGxlYWYuaXNEZWZlcnJlZCkgY29udGludWU7XHJcbiAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgdW5rbm93biBhcyBHcmFwaFZpZXcgfCBMb2NhbEdyYXBoVmlldztcclxuICAgICAgdGhpcy5vdmVycmlkZVByb3RvdHlwZSh2aWV3KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3ZlcnJpZGVQcm90b3R5cGUodmlldzogR3JhcGhWaWV3IHwgTG9jYWxHcmFwaFZpZXcpIHtcclxuICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZSBmb3IgTURYIGZpbGVzIGluIHRoZSBncmFwaFxyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcclxuICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB2aWV3LnJlbmRlcmVyLm5vZGVzKSB7XHJcbiAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVCeVBhdGgobm9kZS5pZCk7XHJcbiAgICAgICAgICBpZiAoZmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcpIHtcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciBhc3luYyByZWFkIHRvIHBvcHVsYXRlIGNhY2hlXHJcbiAgICAgICAgICAgIHZvaWQgZnJvbnRtYXR0ZXJDYWNoZS5nZXQodGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyeSB0byBnZXQgZmlyc3Qgbm9kZSAtIGhhbmRsZSBib3RoIFNldCBhbmQgY3VzdG9tIGNvbGxlY3Rpb24gdHlwZXNcclxuICAgIGxldCBmaXJzdE5vZGU6IEdyYXBoTm9kZSB8IHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IG5vZGVzV2l0aEZpcnN0ID0gdmlldy5yZW5kZXJlci5ub2RlcyBhcyBHcmFwaE5vZGVDb2xsZWN0aW9uV2l0aEZpcnN0O1xyXG4gICAgaWYgKHR5cGVvZiBub2Rlc1dpdGhGaXJzdC5maXJzdCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBmaXJzdE5vZGUgPSBub2Rlc1dpdGhGaXJzdC5maXJzdCgpO1xyXG4gICAgfSBlbHNlIGlmICh2aWV3LnJlbmRlcmVyLm5vZGVzIGluc3RhbmNlb2YgU2V0KSB7XHJcbiAgICAgIGZpcnN0Tm9kZSA9ICh2aWV3LnJlbmRlcmVyLm5vZGVzLnZhbHVlcygpLm5leHQoKS52YWx1ZSBhcyBHcmFwaE5vZGUgfCB1bmRlZmluZWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gRmFsbGJhY2s6IGl0ZXJhdGUgdG8gZ2V0IGZpcnN0XHJcbiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB2aWV3LnJlbmRlcmVyLm5vZGVzKSB7XHJcbiAgICAgICAgZmlyc3ROb2RlID0gbm9kZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaXJzdE5vZGUpIHtcclxuICAgICAgY29uc3QgcHJvdG8gPSBmaXJzdE5vZGUuY29uc3RydWN0b3IucHJvdG90eXBlIGFzIEdyYXBoTm9kZVByb3RvdHlwZTtcclxuICAgICAgaWYgKCFwcm90by5oYXNPd25Qcm9wZXJ0eSgncG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQnKSAmJiAhdGhpcy5tb2RpZmllZFByb3RvdHlwZXMuaW5jbHVkZXMocHJvdG8pKSB7XHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZCAtLSBGdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBjYWxsZWQgd2l0aCBgdGhpc2AgYXMgR3JhcGhOb2RlXHJcbiAgICAgICAgcHJvdG8ucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQgPSBwcm90by5nZXREaXNwbGF5VGV4dDtcclxuICAgICAgICBjb25zdCBnZXREaXNwbGF5VGV4dEZuID0gdGhpcy5jcmVhdGVHZXREaXNwbGF5VGV4dCh0aGlzLnBsdWdpbi5hcHApO1xyXG4gICAgICAgIHByb3RvLmdldERpc3BsYXlUZXh0ID0gZ2V0RGlzcGxheVRleHRGbjtcclxuICAgICAgICAvLyBTdG9yZSBwbHVnaW4gcmVmZXJlbmNlIG9uIHByb3RvdHlwZSBmb3IgYWNjZXNzIGluIGdldERpc3BsYXlUZXh0XHJcbiAgICAgICAgcHJvdG8ucG92X3BsdWdpbiA9IHRoaXMucGx1Z2luO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBhbGwgZXhpc3Rpbmcgbm9kZXNcclxuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygdmlldy5yZW5kZXJlci5ub2Rlcykge1xyXG4gICAgICAgICAgaWYgKG5vZGUudGV4dCkge1xyXG4gICAgICAgICAgICBub2RlLnRleHQudGV4dCA9IG5vZGUuZ2V0RGlzcGxheVRleHQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmlldy5yZW5kZXJlci5jaGFuZ2VkKCk7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZFByb3RvdHlwZXMucHVzaChwcm90byk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVzdG9yZVByb3RvdHlwZXMoKSB7XHJcbiAgICBmb3IgKGNvbnN0IHByb3RvIG9mIHRoaXMubW9kaWZpZWRQcm90b3R5cGVzKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgcHJvdG8ucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBwcm90by5nZXREaXNwbGF5VGV4dCA9IHByb3RvLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0O1xyXG4gICAgICAgIGRlbGV0ZSBwcm90by5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dDtcclxuICAgICAgfVxyXG4gICAgICBkZWxldGUgcHJvdG8ucG92X3BsdWdpbjtcclxuICAgIH1cclxuICAgIHRoaXMubW9kaWZpZWRQcm90b3R5cGVzID0gW107XHJcbiAgICB0aGlzLnJld3JpdGVOYW1lcygpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZXdyaXRlTmFtZXMoKSB7XHJcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmdldEdyYXBoTGVhdmVzKCk7XHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcbiAgICAgIGlmICghKGxlYWYudmlldyBpbnN0YW5jZW9mIFZpZXcpIHx8IGxlYWYuaXNEZWZlcnJlZCkgY29udGludWU7XHJcbiAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgdW5rbm93biBhcyBHcmFwaFZpZXcgfCBMb2NhbEdyYXBoVmlldztcclxuICAgICAgZm9yIChjb25zdCBub2RlIG9mIHZpZXcucmVuZGVyZXIubm9kZXMpIHtcclxuICAgICAgICBpZiAobm9kZS50ZXh0KSB7XHJcbiAgICAgICAgICBub2RlLnRleHQudGV4dCA9IG5vZGUuZ2V0RGlzcGxheVRleHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdmlldy5yZW5kZXJlci5jaGFuZ2VkKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkxheW91dENoYW5nZSgpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgIHRoaXMucmVzdG9yZVByb3RvdHlwZXMoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiBncmFwaCBwbHVnaW4gaXMgbG9hZGVkXHJcbiAgICBjb25zdCBhcHBJbnRlcm5hbCA9IHRoaXMucGx1Z2luLmFwcCBhcyBBcHAgJiB7IGludGVybmFsUGx1Z2lucz86IHsgZ2V0UGx1Z2luQnlJZD86IChpZDogc3RyaW5nKSA9PiB7IF9sb2FkZWQ/OiBib29sZWFuIH0gfCBudWxsIH0gfTtcclxuICAgIGNvbnN0IGdyYXBoUGx1Z2luID0gYXBwSW50ZXJuYWwuaW50ZXJuYWxQbHVnaW5zPy5nZXRQbHVnaW5CeUlkPy4oJ2dyYXBoJyk7XHJcbiAgICBpZiAoIWdyYXBoUGx1Z2luPy5fbG9hZGVkKSByZXR1cm47XHJcbiAgICBcclxuICAgIHRoaXMub3ZlcnJpZGVQcm90b3R5cGVzKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVHcmFwaFZpZXcoKSB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgIHRoaXMub3ZlcnJpZGVQcm90b3R5cGVzKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlc3RvcmVQcm90b3R5cGVzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZWZyZXNoR3JhcGhWaWV3KCkge1xyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICB0aGlzLnJld3JpdGVOYW1lcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICB0aGlzLnJlc3RvcmVQcm90b3R5cGVzKCk7XHJcbiAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGdldEZyb250bWF0dGVyIH0gZnJvbSAnLi9mcm9udG1hdHRlcic7XHJcblxyXG4vKipcclxuICogU2ltcGxlIGNhY2hlIGZvciBmcm9udG1hdHRlciBkYXRhIHRvIHN1cHBvcnQgc3luYyBjb250ZXh0cyBsaWtlIGdyYXBoIHZpZXdcclxuICogVGhpcyBjYWNoZSBnZXRzIHBvcHVsYXRlZCBhc3luY2hyb25vdXNseSB3aGVuIGZpbGVzIGFyZSByZWFkXHJcbiAqL1xyXG5jbGFzcyBGcm9udG1hdHRlckNhY2hlIHtcclxuICBwcml2YXRlIGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbD4oKTtcclxuICBwcml2YXRlIHBlbmRpbmcgPSBuZXcgTWFwPHN0cmluZywgUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw+PigpO1xyXG5cclxuICBhc3luYyBnZXQoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MpOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbD4ge1xyXG4gICAgY29uc3Qga2V5ID0gZmlsZS5wYXRoO1xyXG4gICAgXHJcbiAgICAvLyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZVxyXG4gICAgaWYgKHRoaXMuY2FjaGUuaGFzKGtleSkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY2FjaGUuZ2V0KGtleSkgPz8gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBhbHJlYWR5IHBlbmRpbmcsIHdhaXQgZm9yIGl0XHJcbiAgICBpZiAodGhpcy5wZW5kaW5nLmhhcyhrZXkpKSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnBlbmRpbmcuZ2V0KGtleSkhO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0YXJ0IHJlYWRpbmdcclxuICAgIGNvbnN0IHByb21pc2UgPSBnZXRGcm9udG1hdHRlcihhcHAsIGZpbGUsIHNldHRpbmdzKTtcclxuICAgIHRoaXMucGVuZGluZy5zZXQoa2V5LCBwcm9taXNlKTtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvbWlzZTtcclxuICAgICAgdGhpcy5jYWNoZS5zZXQoa2V5LCByZXN1bHQpO1xyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgdGhpcy5wZW5kaW5nLmRlbGV0ZShrZXkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0U3luYyhrZXk6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbCB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy5jYWNoZS5nZXQoa2V5KTtcclxuICB9XHJcblxyXG4gIGludmFsaWRhdGUoa2V5OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICB0aGlzLnBlbmRpbmcuZGVsZXRlKGtleSk7XHJcbiAgfVxyXG5cclxuICBjbGVhcigpOiB2b2lkIHtcclxuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcclxuICAgIHRoaXMucGVuZGluZy5jbGVhcigpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2xvYmFsIGNhY2hlIGluc3RhbmNlXHJcbmV4cG9ydCBjb25zdCBmcm9udG1hdHRlckNhY2hlID0gbmV3IEZyb250bWF0dGVyQ2FjaGUoKTtcclxuIiwgImltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEJhY2tsaW5rIFNlcnZpY2VcclxuICogXHJcbiAqIEhhbmRsZXMgZGlzcGxheWluZyBwcm9wZXJ0eSB0aXRsZXMgaW5zdGVhZCBvZiBmaWxlIG5hbWVzIGluOlxyXG4gKiAtIEVtYmVkZGVkIGJhY2tsaW5rcyAoTGlua2VkIG1lbnRpb25zIGZvb3RlciBpbiBlYWNoIG5vdGUpXHJcbiAqIC0gRGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gKiAtIE91dGdvaW5nIGxpbmtzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQmFja2xpbmtTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBvYnNlcnZlcj86IE11dGF0aW9uT2JzZXJ2ZXI7XHJcbiAgcHJpdmF0ZSBwcm9jZXNzZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgbW9kaWZpZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzOiBNYXA8SFRNTEVsZW1lbnQsIFByb3BlcnR5RGVzY3JpcHRvcj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGRpc3BsYXkgbmFtZSBmcm9tIGZpbGUncyBmcm9udG1hdHRlciBwcm9wZXJ0eVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZ2V0RnJvbnRtYXR0ZXIsIGlzRmlsZVR5cGVTdXBwb3J0ZWQgfSA9IGF3YWl0IGltcG9ydCgnLi4vdXRpbHMvZnJvbnRtYXR0ZXInKTtcclxuICAgIFxyXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXHJcbiAgICBpZiAoIWlzRmlsZVR5cGVTdXBwb3J0ZWQoZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgXHJcbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XHJcbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xyXG4gICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWxsIGJhY2tsaW5rIGRpc3BsYXlzXHJcbiAgICovXHJcbiAgdXBkYXRlQmFja2xpbmtzKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpIHtcclxuICAgICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgZW1iZWRkZWQgYmFja2xpbmtzIGluIGFsbCBtYXJrZG93biB2aWV3c1xyXG4gICAgdGhpcy51cGRhdGVFbWJlZGRlZEJhY2tsaW5rcygpO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgZGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gICAgdm9pZCB0aGlzLnVwZGF0ZURlZGljYXRlZEJhY2tsaW5rc1BhbmVsKCk7XHJcblxyXG4gICAgLy8gU3RhcnQgb2JzZXJ2aW5nIGZvciBmdXR1cmUgY2hhbmdlc1xyXG4gICAgdGhpcy5zdGFydE9ic2VydmluZygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGVtYmVkZGVkIGJhY2tsaW5rcyBpbiBtYXJrZG93biB2aWV3c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTogdm9pZCB7XHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJykpIHtcclxuICAgICAgaWYgKCEobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSkge1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBlbWJlZGRlZEJhY2tsaW5rcyA9IGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuZW1iZWRkZWQtYmFja2xpbmtzJyk7XHJcbiAgICAgIGlmIChlbWJlZGRlZEJhY2tsaW5rcykge1xyXG4gICAgICAgIHRoaXMudXBkYXRlQmFja2xpbmtDb250YWluZXIoZW1iZWRkZWRCYWNrbGlua3MgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgZGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlRGVkaWNhdGVkQmFja2xpbmtzUGFuZWwoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBiYWNrbGlua3NMZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnYmFja2xpbmsnKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGJhY2tsaW5rc0xlYXZlcykge1xyXG4gICAgICBhd2FpdCBsZWFmLmxvYWRJZkRlZmVycmVkKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAobGVhZi52aWV3KSB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gKGxlYWYudmlldyBhcyB7IGNvbnRhaW5lckVsPzogSFRNTEVsZW1lbnQgfSkuY29udGFpbmVyRWw7XHJcbiAgICAgICAgaWYgKGNvbnRhaW5lcikge1xyXG4gICAgICAgICAgLy8gRmluZCBiYWNrbGlua3MgYW5kIG91dGdvaW5nIGxpbmtzIHNlY3Rpb25zXHJcbiAgICAgICAgICBjb25zdCBiYWNrbGlua3NDb250YWluZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJhY2tsaW5rcy1wYW5lJykgfHwgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrbGluay1wYW5lJyk7XHJcbiAgICAgICAgICBpZiAoYmFja2xpbmtzQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQmFja2xpbmtDb250YWluZXIoYmFja2xpbmtzQ29udGFpbmVyIGFzIEhUTUxFbGVtZW50KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQWxzbyBjaGVjayBmb3Igb3V0Z29pbmcgbGlua3NcclxuICAgICAgICAgIGNvbnN0IG91dGdvaW5nTGlua3NDb250YWluZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm91dGdvaW5nLWxpbmstcGFuZScpIHx8IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcub3V0Z29pbmctbGlua3MnKTtcclxuICAgICAgICAgIGlmIChvdXRnb2luZ0xpbmtzQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQmFja2xpbmtDb250YWluZXIob3V0Z29pbmdMaW5rc0NvbnRhaW5lciBhcyBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeHRyYWN0IGZpbGUgcGF0aCBmcm9tIGFuIGVsZW1lbnQgb3IgaXRzIHBhcmVudCBsaW5rXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBleHRyYWN0RmlsZVBhdGhGcm9tRWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCk6IFRGaWxlIHwgbnVsbCB7XHJcbiAgICAvLyBUcnkgZGF0YS1wYXRoIGF0dHJpYnV0ZSBmaXJzdFxyXG4gICAgY29uc3QgZGF0YVBhdGggPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJyk7XHJcbiAgICBpZiAoZGF0YVBhdGgpIHtcclxuICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGF0YVBhdGgpO1xyXG4gICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZpbGU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gZmluZCBhIGxpbmsgZWxlbWVudCAocGFyZW50IG9yIGNoaWxkKVxyXG4gICAgY29uc3QgbGluayA9IGVsZW1lbnQuY2xvc2VzdCgnYScpIHx8IGVsZW1lbnQucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgaWYgKGxpbmspIHtcclxuICAgICAgY29uc3QgaHJlZiA9IGxpbmsgaW5zdGFuY2VvZiBIVE1MQW5jaG9yRWxlbWVudCA/IGxpbmsuaHJlZiA6IChsaW5rIGFzIEVsZW1lbnQpLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xyXG4gICAgICBpZiAoaHJlZikge1xyXG4gICAgICAgIC8vIFRyeSBvYnNpZGlhbjovLyBVUkwgZm9ybWF0XHJcbiAgICAgICAgaWYgKGhyZWYuc3RhcnRzV2l0aCgnb2JzaWRpYW46Ly8nKSkge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChocmVmKTtcclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhcmFtID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2ZpbGUnKTtcclxuICAgICAgICAgICAgaWYgKGZpbGVQYXJhbSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGRlY29kZWRQYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KGZpbGVQYXJhbSk7XHJcbiAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGVjb2RlZFBhdGggKyAnLm1kJyk7XHJcbiAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgLy8gSWdub3JlIFVSTCBwYXJzaW5nIGVycm9yc1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBUcnkgaW50ZXJuYWwgbGluayBmb3JtYXQgKGUuZy4sICNmaWxlL3BhdGgvdG8vZmlsZSlcclxuICAgICAgICBjb25zdCBpbnRlcm5hbExpbmtNYXRjaCA9IGhyZWYubWF0Y2goLyNmaWxlXFwvKC4rKS8pO1xyXG4gICAgICAgIGlmIChpbnRlcm5hbExpbmtNYXRjaCkge1xyXG4gICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBkZWNvZGVVUklDb21wb25lbnQoaW50ZXJuYWxMaW5rTWF0Y2hbMV0pO1xyXG4gICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyeSBkYXRhLWhyZWYgYXR0cmlidXRlIChPYnNpZGlhbiBzb21ldGltZXMgdXNlcyB0aGlzKVxyXG4gICAgICAgIGNvbnN0IGRhdGFIcmVmID0gbGluay5nZXRBdHRyaWJ1dGUoJ2RhdGEtaHJlZicpO1xyXG4gICAgICAgIGlmIChkYXRhSHJlZikge1xyXG4gICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGF0YUhyZWYpO1xyXG4gICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gbWF0Y2ggdGV4dCBjb250ZW50IHRvIGEgZmlsZSBiYXNlbmFtZVxyXG4gICAgY29uc3QgdGV4dENvbnRlbnQgPSBlbGVtZW50LnRleHRDb250ZW50Py50cmltKCk7XHJcbiAgICBpZiAodGV4dENvbnRlbnQpIHtcclxuICAgICAgLy8gVHJ5IHRvIGZpbmQgZmlsZSBieSBiYXNlbmFtZSAod2l0aG91dCBleHRlbnNpb24pXHJcbiAgICAgIGNvbnN0IGFsbEZpbGVzID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgY29uc3QgbWF0Y2hpbmdGaWxlID0gYWxsRmlsZXMuZmluZChmID0+IGYuYmFzZW5hbWUgPT09IHRleHRDb250ZW50KTtcclxuICAgICAgaWYgKG1hdGNoaW5nRmlsZSkge1xyXG4gICAgICAgIHJldHVybiBtYXRjaGluZ0ZpbGU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBhIGJhY2tsaW5rIGNvbnRhaW5lciBieSByZXBsYWNpbmcgZmlsZSBuYW1lcyB3aXRoIHByb3BlcnR5IHRpdGxlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQmFja2xpbmtDb250YWluZXIoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgLy8gRmluZCBhbGwgcG90ZW50aWFsIGZpbGUgbmFtZSBlbGVtZW50cyBpbiB0aGUgY29udGFpbmVyXHJcbiAgICAvLyBPYnNpZGlhbiB1c2VzIHZhcmlvdXMgc2VsZWN0b3JzIGZvciBiYWNrbGluayBpdGVtc1xyXG4gICAgY29uc3Qgc2VsZWN0b3JzID0gW1xyXG4gICAgICAnLnRyZWUtaXRlbS1pbm5lcicsXHJcbiAgICAgICcuYmFja2xpbmstdGl0bGUnLFxyXG4gICAgICAnLmJhY2tsaW5rLWZpbGUtbGluaycsXHJcbiAgICAgICcub3V0Z29pbmctbGluay1maWxlLWxpbmsnLFxyXG4gICAgICAnLnRyZWUtaXRlbS1zZWxmJyxcclxuICAgICAgJy5uYXYtZmlsZS10aXRsZScsXHJcbiAgICAgICdbZGF0YS1wYXRoXScsXHJcbiAgICAgICdhLmludGVybmFsLWxpbmsnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGZpbGVFbGVtZW50cyA9IG5ldyBTZXQ8SFRNTEVsZW1lbnQ+KCk7XHJcblxyXG4gICAgLy8gQ29sbGVjdCBhbGwgcG90ZW50aWFsIGVsZW1lbnRzXHJcbiAgICBzZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgICAgZmlsZUVsZW1lbnRzLmFkZChlbCBhcyBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIC8vIElnbm9yZSBpbnZhbGlkIHNlbGVjdG9yIGVycm9yc1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBmaWxlRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAvLyBTa2lwIGlmIGFscmVhZHkgcHJvY2Vzc2VkIGluIHRoaXMgdXBkYXRlIGN5Y2xlXHJcbiAgICAgIGlmICh0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRXh0cmFjdCBmaWxlIGZyb20gZWxlbWVudFxyXG4gICAgICBjb25zdCBmaWxlID0gdGhpcy5leHRyYWN0RmlsZVBhdGhGcm9tRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgaWYgKGZpbGUgJiYgZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVFbGVtZW50V2l0aEZpbGUoZWxlbWVudCwgZmlsZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFuIGVsZW1lbnQgd2l0aCBmaWxlJ3MgZGlzcGxheSBuYW1lXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVFbGVtZW50V2l0aEZpbGUoZWxlbWVudDogSFRNTEVsZW1lbnQsIGZpbGU6IFRGaWxlKTogdm9pZCB7XHJcbiAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gYXdhaXQgdGhpcy5nZXREaXNwbGF5TmFtZShmaWxlKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChkaXNwbGF5TmFtZSA9PT0gbnVsbCkge1xyXG4gICAgICAgIC8vIE5vIHByb3BlcnR5LCB1c2UgZGVmYXVsdCBiZWhhdmlvciAoZmlsZSBuYW1lKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgIC8vIE1hcmsgYXMgcHJvY2Vzc2VkXHJcbiAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG5cclxuICAgIC8vIEZpbmQgdGhlIHRleHQgbm9kZSBvciBlbGVtZW50IHRoYXQgY29udGFpbnMgdGhlIGZpbGUgbmFtZVxyXG4gICAgY29uc3QgY3VycmVudFRleHQgPSBlbGVtZW50LnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcbiAgICBjb25zdCBiYXNlbmFtZSA9IGZpbGUuYmFzZW5hbWU7XHJcblxyXG4gICAgLy8gT25seSB1cGRhdGUgaWYgdGhlIGN1cnJlbnQgdGV4dCBtYXRjaGVzIHRoZSBiYXNlbmFtZSBvciBmaWxlIG5hbWVcclxuICAgIC8vIFRoaXMgcHJldmVudHMgb3ZlcndyaXRpbmcgY3VzdG9tIHRleHQgdGhhdCBtaWdodCBhbHJlYWR5IGJlIHNldFxyXG4gICAgaWYgKGN1cnJlbnRUZXh0ID09PSBiYXNlbmFtZSB8fCBjdXJyZW50VGV4dCA9PT0gZmlsZS5uYW1lIHx8IGN1cnJlbnRUZXh0LmVuZHNXaXRoKGJhc2VuYW1lKSkge1xyXG4gICAgICAvLyBGaW5kIHRoZSBsaW5rIGVsZW1lbnQgKGlmIGFueSlcclxuICAgICAgY29uc3QgbGluayA9IGVsZW1lbnQuY2xvc2VzdCgnYScpIHx8IGVsZW1lbnQucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gbGluayB8fCBlbGVtZW50O1xyXG5cclxuICAgICAgLy8gVHJ5IHRvIHByZXNlcnZlIHRoZSBzdHJ1Y3R1cmUgd2hpbGUgdXBkYXRpbmcgdGV4dFxyXG4gICAgICAvLyBMb29rIGZvciB0ZXh0IG5vZGVzIG9yIGVsZW1lbnRzIHRoYXQgY29udGFpbiB0aGUgZmlsZSBuYW1lXHJcbiAgICAgIGNvbnN0IHVwZGF0ZVRleHRJbkVsZW1lbnQgPSAoZWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgZWxlbWVudCBoYXMgYSBzaW5nbGUgdGV4dCBub2RlIGNoaWxkXHJcbiAgICAgICAgaWYgKGVsLmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICYmIGVsLmNoaWxkTm9kZXNbMF0ubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XHJcbiAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IGRpc3BsYXlOYW1lO1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBMb29rIGZvciB0ZXh0IG5vZGVzXHJcbiAgICAgICAgY29uc3QgdGV4dE5vZGVzID0gQXJyYXkuZnJvbShlbC5jaGlsZE5vZGVzKS5maWx0ZXIobm9kZSA9PiBub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSk7XHJcbiAgICAgICAgaWYgKHRleHROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAvLyBVcGRhdGUgdGhlIGZpcnN0IHRleHQgbm9kZVxyXG4gICAgICAgICAgdGV4dE5vZGVzWzBdLnRleHRDb250ZW50ID0gZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICAvLyBSZW1vdmUgb3RoZXIgdGV4dCBub2RlcyB0byBhdm9pZCBkdXBsaWNhdGlvblxyXG4gICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0ZXh0Tm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGV4dE5vZGVzW2ldLnJlbW92ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJZiBubyB0ZXh0IG5vZGVzLCBjaGVjayBpZiB3ZSBzaG91bGQgcmVwbGFjZSBhbGwgY29udGVudFxyXG4gICAgICAgIC8vIE9ubHkgZG8gdGhpcyBpZiB0aGUgZWxlbWVudCdzIHRleHQgbWF0Y2hlcyB0aGUgZmlsZSBuYW1lXHJcbiAgICAgICAgaWYgKGVsLnRleHRDb250ZW50Py50cmltKCkgPT09IGJhc2VuYW1lIHx8IGVsLnRleHRDb250ZW50Py50cmltKCkgPT09IGZpbGUubmFtZSkge1xyXG4gICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBkaXNwbGF5TmFtZTtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gVHJ5IHRvIHVwZGF0ZSB0aGUgbGluayBmaXJzdCwgdGhlbiBmYWxsIGJhY2sgdG8gZWxlbWVudFxyXG4gICAgICBpZiAoIXVwZGF0ZVRleHRJbkVsZW1lbnQodGFyZ2V0RWxlbWVudCkpIHtcclxuICAgICAgICAvLyBJZiBsaW5rIHVwZGF0ZSBmYWlsZWQsIHRyeSB0aGUgZWxlbWVudCBpdHNlbGZcclxuICAgICAgICB1cGRhdGVUZXh0SW5FbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB9KSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgb2JzZXJ2aW5nIERPTSBjaGFuZ2VzIGZvciBiYWNrbGlua3NcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0T2JzZXJ2aW5nKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcclxuICAgICAgcmV0dXJuOyAvLyBBbHJlYWR5IG9ic2VydmluZ1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE92ZXJyaWRlIHRleHRDb250ZW50IG9uIGJhY2tsaW5rIGVsZW1lbnRzIHRvIGludGVyY2VwdCBpbW1lZGlhdGVseVxyXG4gICAgdGhpcy5vdmVycmlkZUJhY2tsaW5rRWxlbWVudHMoKTtcclxuXHJcbiAgICBsZXQgdXBkYXRlVGltZW91dDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD4gfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xyXG4gICAgICAvLyBDaGVjayBpZiBhbnkgbXV0YXRpb25zIGFmZmVjdCBiYWNrbGluayBjb250YWluZXJzXHJcbiAgICAgIGxldCBzaG91bGRVcGRhdGUgPSBmYWxzZTtcclxuICAgICAgY29uc3QgbmV3RWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBmb3IgbmV3IGVsZW1lbnRzIHRoYXQgbWlnaHQgYmUgYmFja2xpbmtzXHJcbiAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShtdXRhdGlvbi5hZGRlZE5vZGVzKSkge1xyXG4gICAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSBub2RlLmNsb3Nlc3QoJy5lbWJlZGRlZC1iYWNrbGlua3MnKTtcclxuICAgICAgICAgICAgICBjb25zdCBiYWNrbGlua3NQYW5lbCA9IG5vZGUuY2xvc2VzdCgnLmJhY2tsaW5rcy1wYW5lLCAuYmFja2xpbmstcGFuZSwgLm91dGdvaW5nLWxpbmstcGFuZSwgLm91dGdvaW5nLWxpbmtzLCAuYmFja2xpbmstY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgaWYgKGVtYmVkZGVkQmFja2xpbmtzIHx8IGJhY2tsaW5rc1BhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gRmluZCBwb3RlbnRpYWwgYmFja2xpbmsgZWxlbWVudHMgaW4gdGhlIG5ldyBub2RlXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSBbJy50cmVlLWl0ZW0taW5uZXInLCAnLmJhY2tsaW5rLXRpdGxlJywgJy5iYWNrbGluay1maWxlLWxpbmsnLCAnLm91dGdvaW5nLWxpbmstZmlsZS1saW5rJywgJy50cmVlLWl0ZW0tc2VsZicsICcubmF2LWZpbGUtdGl0bGUnLCAnW2RhdGEtcGF0aF0nLCAnYS5pbnRlcm5hbC1saW5rJ107XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGw/LihzZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM/LmZvckVhY2goKGVsOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50cy5wdXNoKGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnKSB7XHJcbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBtdXRhdGlvbi50YXJnZXQ7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIENoZWNrIGlmIG11dGF0aW9uIGlzIGluIGEgYmFja2xpbmsgY29udGFpbmVyXHJcbiAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSB0YXJnZXQuY2xvc2VzdCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpO1xyXG4gICAgICAgICAgICBjb25zdCBiYWNrbGlua3NQYW5lbCA9IHRhcmdldC5jbG9zZXN0KCcuYmFja2xpbmtzLXBhbmUsIC5iYWNrbGluay1wYW5lLCAub3V0Z29pbmctbGluay1wYW5lLCAub3V0Z29pbmctbGlua3MsIC5iYWNrbGluay1jb250YWluZXInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChlbWJlZGRlZEJhY2tsaW5rcyB8fCBiYWNrbGlua3NQYW5lbCkge1xyXG4gICAgICAgICAgICAgIHNob3VsZFVwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0LnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgcGFyZW50IGVsZW1lbnRcclxuICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSB0YXJnZXQucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZW1iZWRkZWQtYmFja2xpbmtzJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhY2tsaW5rc1BhbmVsID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmJhY2tsaW5rcy1wYW5lLCAuYmFja2xpbmstcGFuZSwgLm91dGdvaW5nLWxpbmstcGFuZSwgLm91dGdvaW5nLWxpbmtzLCAuYmFja2xpbmstY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZW1iZWRkZWRCYWNrbGlua3MgfHwgYmFja2xpbmtzUGFuZWwpIHtcclxuICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBPdmVycmlkZSBuZXcgZWxlbWVudHMgaW1tZWRpYXRlbHkgYW5kIHVwZGF0ZSB0aGVtXHJcbiAgICAgIG5ld0VsZW1lbnRzLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVFbGVtZW50VGV4dENvbnRlbnQoZWwpO1xyXG4gICAgICAgIC8vIEFsc28gdHJ5IHRvIHVwZGF0ZSBpbW1lZGlhdGVseSBpZiB3ZSBjYW4gZXh0cmFjdCB0aGUgZmlsZVxyXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmV4dHJhY3RGaWxlUGF0aEZyb21FbGVtZW50KGVsKTtcclxuICAgICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBhd2FpdCB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG4gICAgICAgICAgICBpZiAoZGlzcGxheU5hbWUpIHtcclxuICAgICAgICAgICAgICAvLyBDaGVjayBjdXJyZW50IHRleHQgYW5kIHJlcGxhY2UgaWYgaXQncyB0aGUgZmlsZW5hbWVcclxuICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VGV4dCA9IGVsLnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcbiAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0ID09PSBmaWxlLmJhc2VuYW1lIHx8IGN1cnJlbnRUZXh0ID09PSBmaWxlLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLmFkZChlbCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XHJcbiAgICAgICAgLy8gQ2xlYXIgcHJvY2Vzc2VkIGVsZW1lbnRzIGNhY2hlIHdoZW4gdXBkYXRpbmdcclxuICAgICAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzID0gbmV3IFdlYWtTZXQoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBEZWJvdW5jZSB1cGRhdGVzIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBwcm9jZXNzaW5nXHJcbiAgICAgICAgaWYgKHVwZGF0ZVRpbWVvdXQpIHtcclxuICAgICAgICAgIGNsZWFyVGltZW91dCh1cGRhdGVUaW1lb3V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVCYWNrbGlua3MoKTtcclxuICAgICAgICAgIHRoaXMub3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk7IC8vIFJlLW92ZXJyaWRlIGluIGNhc2UgbmV3IGVsZW1lbnRzIHdlcmUgYWRkZWRcclxuICAgICAgICAgIHVwZGF0ZVRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgIH0sIDEwKTsgLy8gVmVyeSBzaG9ydCBkZWxheSBmb3IgZmFzdGVyIHVwZGF0ZXNcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gT2JzZXJ2ZSB0aGUgZW50aXJlIGRvY3VtZW50IGZvciBjaGFuZ2VzXHJcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xyXG4gICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE92ZXJyaWRlIHRleHRDb250ZW50IG9uIGFsbCBiYWNrbGluayBlbGVtZW50c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2VsZWN0b3JzID0gW1xyXG4gICAgICAnLnRyZWUtaXRlbS1pbm5lcicsXHJcbiAgICAgICcuYmFja2xpbmstdGl0bGUnLFxyXG4gICAgICAnLmJhY2tsaW5rLWZpbGUtbGluaycsXHJcbiAgICAgICcub3V0Z29pbmctbGluay1maWxlLWxpbmsnLFxyXG4gICAgICAnLnRyZWUtaXRlbS1zZWxmJyxcclxuICAgICAgJy5uYXYtZmlsZS10aXRsZScsXHJcbiAgICAgICdbZGF0YS1wYXRoXScsXHJcbiAgICAgICdhLmludGVybmFsLWxpbmsnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGNvbnRhaW5lcnMgPSBbXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmFja2xpbmtzLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm91dGdvaW5nLWxpbmstcGFuZScpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0Z29pbmctbGlua3MnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLWNvbnRhaW5lcicpKVxyXG4gICAgXTtcclxuXHJcbiAgICBjb250YWluZXJzLmZvckVhY2goY29udGFpbmVyID0+IHtcclxuICAgICAgc2VsZWN0b3JzLmZvckVhY2goc2VsZWN0b3IgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5vdmVycmlkZUVsZW1lbnRUZXh0Q29udGVudChlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgLy8gSWdub3JlIGludmFsaWQgc2VsZWN0b3IgZXJyb3JzXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgdGV4dENvbnRlbnQgc2V0dGVyIG9uIGFuIGVsZW1lbnQgdG8gaW50ZXJjZXB0IE9ic2lkaWFuJ3MgdXBkYXRlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVFbGVtZW50VGV4dENvbnRlbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLm1vZGlmaWVkRWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgIHJldHVybjsgLy8gQWxyZWFkeSBvdmVycmlkZGVuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dENvbnRlbnQgZGVzY3JpcHRvciBpZiBpdCBleGlzdHNcclxuICAgIGNvbnN0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGVsZW1lbnQpIGFzIHsgdGV4dENvbnRlbnQ/OiBQcm9wZXJ0eURlc2NyaXB0b3IgfTtcclxuICAgIGNvbnN0IG9yaWdpbmFsRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sICd0ZXh0Q29udGVudCcpO1xyXG4gICAgXHJcbiAgICBpZiAob3JpZ2luYWxEZXNjcmlwdG9yICYmIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQpIHtcclxuICAgICAgdGhpcy5vcmlnaW5hbFRleHRDb250ZW50RGVzY3JpcHRvcnMuc2V0KGVsZW1lbnQsIG9yaWdpbmFsRGVzY3JpcHRvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPdmVycmlkZSB0ZXh0Q29udGVudCBzZXR0ZXJcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudCwgJ3RleHRDb250ZW50Jywge1xyXG4gICAgICAgICAgc2V0OiAodmFsdWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGxvb2tzIGxpa2UgYSBmaWxlbmFtZSB0aGF0IHNob3VsZCBiZSByZXBsYWNlZFxyXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5leHRyYWN0RmlsZVBhdGhGcm9tRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICAgICAgaWYgKGZpbGUgJiYgZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBhd2FpdCB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRpc3BsYXlOYW1lICYmICh2YWx1ZSA9PT0gZmlsZS5iYXNlbmFtZSB8fCB2YWx1ZSA9PT0gZmlsZS5uYW1lIHx8IHZhbHVlLmVuZHNXaXRoKGZpbGUuYmFzZW5hbWUpKSkge1xyXG4gICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHdpdGggcHJvcGVydHkgdmFsdWUgdXNpbmcgb3JpZ2luYWwgc2V0dGVyXHJcbiAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQhLmNhbGwoZWxlbWVudCwgZGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRFbGVtZW50cy5hZGQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIE5vdCBhIGZpbGVuYW1lIG9yIG5vIHByb3BlcnR5LCB1c2Ugb3JpZ2luYWwgYmVoYXZpb3JcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQhLmNhbGwoZWxlbWVudCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgIH0pKCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBOb3QgYSBmaWxlbmFtZSBvciBubyBwcm9wZXJ0eSwgdXNlIG9yaWdpbmFsIGJlaGF2aW9yXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQhLmNhbGwoZWxlbWVudCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kXHJcbiAgICAgICAgICBnZXQ6IG9yaWdpbmFsRGVzY3JpcHRvci5nZXQgfHwgKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGFjY2VzcyB0aGUgbmF0aXZlIHRleHRDb250ZW50IHByb3BlcnR5IGRpcmVjdGx5XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3RleHRDb250ZW50Jyk/LmdldD8uY2FsbChlbGVtZW50KSBhcyBzdHJpbmcgfHwgJyc7XHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gSWYgb3ZlcnJpZGUgZmFpbHMgKGUuZy4sIHByb3BlcnR5IGlzIG5vdCBjb25maWd1cmFibGUpLCBmYWxsIGJhY2sgdG8gbW9uaXRvcmluZ1xyXG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGYWxsYmFjazogY2FuJ3Qgb3ZlcnJpZGUsIGJ1dCBtYXJrIGFzIHByb2Nlc3NlZCBzbyBDU1MgZG9lc24ndCBoaWRlIGl0XHJcbiAgICAgIC8vIFRoZSBtdXRhdGlvbiBvYnNlcnZlciB3aWxsIGNhdGNoIGFuZCB1cGRhdGUgaXRcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tb2RpZmllZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3Agb2JzZXJ2aW5nIERPTSBjaGFuZ2VzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdG9wT2JzZXJ2aW5nKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcclxuICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgbGF5b3V0IGNoYW5nZXNcclxuICAgKi9cclxuICBvbkxheW91dENoYW5nZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpIHtcclxuICAgICAgLy8gU21hbGwgZGVsYXkgdG8gbGV0IE9ic2lkaWFuIHJlbmRlciBmaXJzdFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICB9LCAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgZmlsZSBvcGVuIGV2ZW50c1xyXG4gICAqL1xyXG4gIG9uRmlsZU9wZW4oKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTtcclxuICAgICAgfSwgMjAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFuIHVwIG9uIHVubG9hZFxyXG4gICAqL1xyXG4gIG9udW5sb2FkKCk6IHZvaWQge1xyXG4gICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICBcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dENvbnRlbnQgZGVzY3JpcHRvcnNcclxuICAgIHRoaXMub3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzLmZvckVhY2goKGRlc2NyaXB0b3IsIGVsZW1lbnQpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudCwgJ3RleHRDb250ZW50JywgZGVzY3JpcHRvcik7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnMgd2hlbiByZXN0b3JpbmdcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLm9yaWdpbmFsVGV4dENvbnRlbnREZXNjcmlwdG9ycy5jbGVhcigpO1xyXG4gICAgdGhpcy5tb2RpZmllZEVsZW1lbnRzID0gbmV3IFdlYWtTZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbiIsICIvKipcclxuICogVGFiIFNlcnZpY2VcclxuICogXHJcbiAqIFRoaXMgZmlsZSBjb250YWlucyBjb2RlIGFkYXB0ZWQgZnJvbSB0aGUgVGl0bGUtb25seSBUYWIgcGx1Z2luIGJ5IHRyaXN0b25lMTN0aC5cclxuICogT3JpZ2luYWwgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vdHJpc3RvbmUxM3RoL29ic2lkaWFuLXRpdGxlLW9ubHktdGFiXHJcbiAqIFxyXG4gKiBUaGUgY29kZSBoYXMgYmVlbiBtb2RpZmllZCB0byBpbnRlZ3JhdGUgd2l0aCB0aGUgUHJvcGVydHkgT3ZlciBGaWxlIE5hbWUgcGx1Z2luXHJcbiAqIGFuZCB1c2UgdGhlIHBsdWdpbidzIHByb3BlcnR5IGtleSBzZXR0aW5nIGluc3RlYWQgb2YgaGFyZGNvZGVkIFwidGl0bGVcIiBwcm9wZXJ0eS5cclxuICogXHJcbiAqIE9yaWdpbmFsIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgTUlULiBUaGlzIGZpbGUgaXMgYWxzbyBsaWNlbnNlZCB1bmRlciBHUEx2My5cclxuICovXHJcblxyXG5pbXBvcnQgeyBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBnZXRGcm9udG1hdHRlciB9IGZyb20gJy4uL3V0aWxzL2Zyb250bWF0dGVyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBUYWJTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVuYW1lcyBhbGwgbWFya2Rvd24gdGFicyB0byB1c2UgdGhlIGNvbmZpZ3VyZWQgcHJvcGVydHkgdmFsdWVcclxuICAgKiBGYWxscyBiYWNrIHRvIGZpbGUgYmFzZW5hbWUgaWYgcHJvcGVydHkgaXMgbm90IGZvdW5kXHJcbiAgICogRVhBQ1QgY29weSBvZiB0aGUgd29ya2luZyBpbXBsZW1lbnRhdGlvbiBmcm9tIG9ic2lkaWFuLXRpdGxlLW9ubHktdGFiXHJcbiAgICovXHJcbiAgYXN5bmMgcmVuYW1lVGFicygpIHtcclxuICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xyXG4gICAgbGVhdmVzLmZvckVhY2goKGxlYWYpID0+IHtcclxuICAgICAgLypcclxuICAgICAgICogV2hlbiBPYnNpZGlhbiBmaXJzdCBvcGVucywgZHVlIHRvIGxhenkgbG9hZGluZywgdGhlIHZpZXcgbWF5IG5vdCBoYXZlXHJcbiAgICAgICAqIGEgZmlsZSBwcm9wZXJ0eS4gV2UgbmVlZCB0byBtYW51YWxseSB0cmlnZ2VyIGEgcmVsb2FkLiBCeSB1c2luZyBzZXRWaWV3U3RhdGVcclxuICAgICAgICogdG8gcmVhcHBseSB0aGUgdmlldyBzdGF0ZSwgd2UgZm9yY2UgdGhlIHZpZXcgdG8gcmVpbml0aWFsaXplIGFuZCBsb2FkIHRoZVxyXG4gICAgICAgKiBjb3JyZXNwb25kaW5nIGZpbGUsIHRodXMgcG9wdWxhdGluZyB0aGUgZmlsZSBwcm9wZXJ0eS4gSWYgbWFueSB0YWJzIGFyZSBvcGVuLFxyXG4gICAgICAgKiB0aGlzIG1heSBzbGlnaHRseSBpbmNyZWFzZSBzdGFydHVwIHRpbWUuXHJcbiAgICAgICAqL1xyXG4gICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcclxuICAgICAgY29uc3Qgc3RhdGUgPSBsZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG4gICAgICBpZiAoc3RhdGUuc3RhdGU/LmZpbGUgJiYgIXZpZXc/LmZpbGUpIHtcclxuICAgICAgICB2b2lkIGxlYWYuc2V0Vmlld1N0YXRlKHsgdHlwZTogc3RhdGUudHlwZSwgc3RhdGU6IHN0YXRlLnN0YXRlIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodmlldz8uZmlsZSkge1xyXG4gICAgICAgIGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XHJcbiAgICAgICAgLy8gVXNlIGFzeW5jIHZlcnNpb24gdG8gc3VwcG9ydCBNRFggZmlsZXNcclxuICAgICAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgICAgICAgIGNvbnN0IHRhYkhlYWRlckVsID0gKGxlYWYgYXMgeyB0YWJIZWFkZXJFbD86IEhUTUxFbGVtZW50IH0pLnRhYkhlYWRlckVsO1xyXG5cclxuICAgICAgICAgIGlmICh0YWJIZWFkZXJFbCkge1xyXG4gICAgICAgICAgICAvLyBBbHdheXMgbWFyayB0YWJzIGFzIHByb2Nlc3NlZCBzbyB0aGV5J3JlIG5vdCBkaW1tZWQgKGV2ZW4gd2hlbiBmZWF0dXJlIGlzIGRpc2FibGVkKVxyXG4gICAgICAgICAgICB0YWJIZWFkZXJFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXRpdGxlLXNldCcsICd0cnVlJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBPbmx5IGNoYW5nZSB0aGUgdGl0bGUgaWYgdGhlIGZlYXR1cmUgaXMgZW5hYmxlZFxyXG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yVGFicykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSB0YWJIZWFkZXJFbC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXItaW5uZXItdGl0bGUnKTtcclxuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5VGV4dCA9IHByb3BlcnR5VmFsdWUgPyBTdHJpbmcocHJvcGVydHlWYWx1ZSkgOiBmaWxlLmJhc2VuYW1lO1xyXG4gICAgICAgICAgICAgIGlmICh0aXRsZUVsKSB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZUVsLnNldFRleHQoZGlzcGxheVRleHQpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgdGFiSGVhZGVyRWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgZGlzcGxheVRleHQpO1xyXG4gICAgICAgICAgICAgIHRhYkhlYWRlckVsLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBkaXNwbGF5VGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVycyBmb3IgdGFiIHJlbmFtaW5nXHJcbiAgICogRVhBQ1QgY29weSBvZiB0aGUgd29ya2luZyBpbXBsZW1lbnRhdGlvbiBmcm9tIG9ic2lkaWFuLXRpdGxlLW9ubHktdGFiXHJcbiAgICovXHJcbiAgYXN5bmMgcmVnaXN0ZXJFdmVudHMoKSB7XHJcbiAgICBhd2FpdCB0aGlzLnJlbmFtZVRhYnMoKTtcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdsYXlvdXQtY2hhbmdlJywgKCkgPT4gdGhpcy5yZW5hbWVUYWJzKCkpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHRoaXMucmVuYW1lVGFicygpKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW9wZW4nLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGFicyAocHVibGljIG1ldGhvZCBmb3IgbWFudWFsIHVwZGF0ZXMpXHJcbiAgICovXHJcbiAgdXBkYXRlVGFicygpIHtcclxuICAgIHZvaWQgdGhpcy5yZW5hbWVUYWJzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhbnVwIG9uIHVubG9hZFxyXG4gICAqL1xyXG4gIG9udW5sb2FkKCkge1xyXG4gICAgLy8gTm8gY2xlYW51cCBuZWVkZWQgLSBldmVudHMgYXJlIGF1dG9tYXRpY2FsbHkgdW5yZWdpc3RlcmVkIGJ5IE9ic2lkaWFuXHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBURmlsZSwgVEZvbGRlciB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4sIFRGaWxlRXhwbG9yZXJJdGVtLCBURmlsZUV4cGxvcmVyVmlldyB9IGZyb20gJy4uL3R5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBFeHBsb3JlciBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBIYW5kbGVzIGRpc3BsYXlpbmcgcHJvcGVydHktYmFzZWQgdGl0bGVzIGluIHRoZSBmaWxlIGV4cGxvcmVyLlxyXG4gKiBTdXBwb3J0cyBmb2xkZXIgbm90ZXM6IGlmIGEgZm9sZGVyIGNvbnRhaW5zIGEgZmlsZSBtYXRjaGluZyB0aGUgY29uZmlndXJlZFxyXG4gKiBmb2xkZXIgbm90ZSBmaWxlbmFtZSAoZS5nLiwgXCJpbmRleC5tZFwiKSB3aXRoIGEgZnJvbnRtYXR0ZXIgdGl0bGUsIHRoZSBmb2xkZXJcclxuICogd2lsbCBkaXNwbGF5IHRoYXQgdGl0bGUgaW5zdGVhZCBvZiB0aGUgZm9sZGVyIG5hbWUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRXhwbG9yZXJTZXJ2aWNlIHtcclxuICBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luOyAvLyBQdWJsaWMgc28gRXhwbG9yZXJGaWxlSXRlbU11dGF0b3IgY2FuIGFjY2VzcyBpdFxyXG4gIHByaXZhdGUgZXhwbG9yZXJWaWV3OiBURmlsZUV4cGxvcmVyVmlldyB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgbW9kaWZpZWQgPSBuZXcgV2Vha01hcDxURmlsZUV4cGxvcmVySXRlbSwgRXhwbG9yZXJGaWxlSXRlbU11dGF0b3I+KCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBmaWxlIGV4cGxvcmVyIHZpZXdcclxuICAgKi9cclxuICBwcml2YXRlIGdldEV4cGxvcmVyVmlldygpOiBURmlsZUV4cGxvcmVyVmlldyB8IG51bGwge1xyXG4gICAgaWYgKHRoaXMuZXhwbG9yZXJWaWV3ID09PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJyk7XHJcbiAgICAgIGlmIChsZWF2ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgbGVhZiA9IGxlYXZlc1swXTtcclxuICAgICAgaWYgKGxlYWYgJiYgbGVhZi52aWV3KSB7XHJcbiAgICAgICAgLy8gVHlwZSBhc3NlcnRpb24gdGhyb3VnaCB1bmtub3duIHRvIGhhbmRsZSB0aGUgaW50ZXJmYWNlIG1pc21hdGNoXHJcbiAgICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBsZWFmLnZpZXcgYXMgdW5rbm93biBhcyBURmlsZUV4cGxvcmVyVmlldztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZXhwbG9yZXJWaWV3O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGZvbGRlciBub3RlIHRpdGxlIGZvciBhIGZvbGRlclxyXG4gICAqIFJldHVybnMgdGhlIGZyb250bWF0dGVyIHRpdGxlIHByb3BlcnR5IGZyb20gdGhlIGZvbGRlciBub3RlIGZpbGUgaWYgaXQgZXhpc3RzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRGb2xkZXJOb3RlVGl0bGUoZm9sZGVyOiBURm9sZGVyKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlck5vdGVGaWxlbmFtZSB8fCBcclxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUudHJpbSgpID09PSAnJykge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmb2xkZXJOb3RlRmlsZW5hbWUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUudHJpbSgpO1xyXG4gICAgY29uc3QgZm9sZGVyTm90ZVBhdGggPSBgJHtmb2xkZXIucGF0aH0vJHtmb2xkZXJOb3RlRmlsZW5hbWV9Lm1kYDtcclxuICAgIGNvbnN0IGZvbGRlck5vdGVGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJOb3RlUGF0aCk7XHJcblxyXG4gICAgaWYgKGZvbGRlck5vdGVGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZm9sZGVyTm90ZUZpbGUpO1xyXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gY2FjaGU/LmZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHByb3BlcnR5VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNvbHZlIHRpdGxlIGZvciBhIGZpbGUgb3IgZm9sZGVyXHJcbiAgICogUHVibGljIHNvIEV4cGxvcmVyRmlsZUl0ZW1NdXRhdG9yIGNhbiBhY2Nlc3MgaXRcclxuICAgKi9cclxuICBhc3luYyByZXNvbHZlVGl0bGUoaXRlbTogVEZpbGVFeHBsb3Jlckl0ZW0pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGlmIChpdGVtLmZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAvLyBGb3IgZmlsZXMsIHVzZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZVxyXG4gICAgICBjb25zdCB7IGdldEZyb250bWF0dGVyLCBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3V0aWxzL2Zyb250bWF0dGVyJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTa2lwIHVuc3VwcG9ydGVkIGZpbGUgdHlwZXNcclxuICAgICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGl0ZW0uZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgaXRlbS5maWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogbnVsbDtcclxuICAgIH0gZWxzZSBpZiAoaXRlbS5maWxlIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG4gICAgICAvLyBGb3IgZm9sZGVycywgY2hlY2sgZm9yIGZvbGRlciBub3RlXHJcbiAgICAgIHJldHVybiB0aGlzLmdldEZvbGRlck5vdGVUaXRsZShpdGVtLmZpbGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWxsIGZpbGUgZXhwbG9yZXIgaXRlbXNcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUFsbEl0ZW1zKCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0RXhwbG9yZXJWaWV3KCk7XHJcbiAgICBpZiAoIXZpZXcgfHwgIXZpZXcuZmlsZUl0ZW1zKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpdGVtcyA9IE9iamVjdC52YWx1ZXModmlldy5maWxlSXRlbXMpO1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGlmICghdGhpcy5tb2RpZmllZC5oYXMoaXRlbSkpIHtcclxuICAgICAgICB0aGlzLm1vZGlmaWVkLnNldChpdGVtLCBuZXcgRXhwbG9yZXJGaWxlSXRlbU11dGF0b3IoaXRlbSwgdGhpcykpO1xyXG4gICAgICB9XHJcbiAgICAgIGl0ZW0udXBkYXRlVGl0bGUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RvcmUgYWxsIG9yaWdpbmFsIHRpdGxlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVzdG9yZUFsbEl0ZW1zKCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0RXhwbG9yZXJWaWV3KCk7XHJcbiAgICBpZiAoIXZpZXcgfHwgIXZpZXcuZmlsZUl0ZW1zKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpdGVtcyA9IE9iamVjdC52YWx1ZXModmlldy5maWxlSXRlbXMpO1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGlmICh0aGlzLm1vZGlmaWVkLmhhcyhpdGVtKSkge1xyXG4gICAgICAgIGNvbnN0IG11dGF0b3IgPSB0aGlzLm1vZGlmaWVkLmdldChpdGVtKTtcclxuICAgICAgICBtdXRhdG9yPy5kZXN0cm95KCk7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZC5kZWxldGUoaXRlbSk7XHJcbiAgICAgICAgaXRlbS51cGRhdGVUaXRsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBldmVudHMgYW5kIGluaXRpYWxpemVcclxuICAgKi9cclxuICByZWdpc3RlckV2ZW50cygpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdhaXQgZm9yIGxheW91dCB0byBiZSByZWFkeVxyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBudWxsOyAvLyBSZXNldCB0byBnZXQgZnJlc2ggdmlld1xyXG4gICAgICB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBsYXlvdXQgY2hhbmdlc1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LWNoYW5nZScsICgpID0+IHtcclxuICAgICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7IC8vIFJlc2V0IHRvIGdldCBmcmVzaCB2aWV3XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQWxsSXRlbXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB3aGVuIGZpbGVzIGFyZSByZW5hbWVkXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ3JlbmFtZScsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgICAgIHRoaXMuZXhwbG9yZXJWaWV3ID0gbnVsbDsgLy8gUmVzZXQgdG8gZ2V0IGZyZXNoIHZpZXdcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGVBbGxJdGVtcygpLCAxMDApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgZXhwbG9yZXIgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgKi9cclxuICB1cGRhdGVFeHBsb3JlcigpIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7IC8vIFJlc2V0IHRvIGdldCBmcmVzaCB2aWV3XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCksIDEwMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlc3RvcmVBbGxJdGVtcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcclxuICAgKi9cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMucmVzdG9yZUFsbEl0ZW1zKCk7XHJcbiAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTXV0YXRvciBmb3IgaW5kaXZpZHVhbCBmaWxlIGV4cGxvcmVyIGl0ZW1zXHJcbiAqIEhvb2tzIGludG8gdXBkYXRlVGl0bGUoKSB0byByZXBsYWNlIGRpc3BsYXllZCB0ZXh0XHJcbiAqL1xyXG5jbGFzcyBFeHBsb3JlckZpbGVJdGVtTXV0YXRvciB7XHJcbiAgcHJpdmF0ZSBvcmlnaW5hbFVwZGF0ZVRpdGxlOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxTdGFydFJlbmFtZTogKCgpID0+IHZvaWQpIHwgdW5kZWZpbmVkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaXRlbTogVEZpbGVFeHBsb3Jlckl0ZW0sXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNlcnZpY2U6IEV4cGxvcmVyU2VydmljZVxyXG4gICkge1xyXG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgbWV0aG9kc1xyXG4gICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaXRlbSkgYXMgeyB1cGRhdGVUaXRsZTogKCkgPT4gdm9pZDsgc3RhcnRSZW5hbWU/OiAoKSA9PiB2b2lkIH07XHJcbiAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUgPSBwcm90by51cGRhdGVUaXRsZS5iaW5kKGl0ZW0pO1xyXG4gICAgdGhpcy5vcmlnaW5hbFN0YXJ0UmVuYW1lID0gcHJvdG8uc3RhcnRSZW5hbWUgPyBwcm90by5zdGFydFJlbmFtZS5iaW5kKGl0ZW0pIDogdW5kZWZpbmVkO1xyXG5cclxuICAgIC8vIE92ZXJyaWRlIHVwZGF0ZVRpdGxlXHJcbiAgICBpdGVtLnVwZGF0ZVRpdGxlID0gdGhpcy51cGRhdGVUaXRsZS5iaW5kKHRoaXMpO1xyXG4gICAgXHJcbiAgICAvLyBPdmVycmlkZSBzdGFydFJlbmFtZSBpZiBpdCBleGlzdHNcclxuICAgIGlmIChwcm90by5zdGFydFJlbmFtZSkge1xyXG4gICAgICBpdGVtLnN0YXJ0UmVuYW1lID0gdGhpcy5zdGFydFJlbmFtZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVUaXRsZSgpIHtcclxuICAgIC8vIENhbGwgb3JpZ2luYWwgdG8gc2V0IHVwIHRoZSBlbGVtZW50XHJcbiAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUoKTtcclxuICAgIFxyXG4gICAgLy8gUmVwbGFjZSB3aXRoIHByb3BlcnR5LWJhc2VkIHRpdGxlIGlmIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnNlcnZpY2UucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCB0aXRsZSA9IGF3YWl0IHRoaXMuc2VydmljZS5yZXNvbHZlVGl0bGUodGhpcy5pdGVtKTtcclxuICAgICAgICBpZiAodGl0bGUgJiYgdGl0bGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdGhpcy5pdGVtLmlubmVyRWwuc2V0VGV4dCh0aXRsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGFydFJlbmFtZSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGl0bGUgZm9yIHJlbmFtaW5nXHJcbiAgICB0aGlzLml0ZW0uaW5uZXJFbC5zZXRUZXh0KHRoaXMuaXRlbS5nZXRUaXRsZSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU/LigpO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgbWV0aG9kc1xyXG4gICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcy5pdGVtKSBhcyB7IHN0YXJ0UmVuYW1lPzogKCkgPT4gdm9pZCB9O1xyXG4gICAgdGhpcy5pdGVtLnVwZGF0ZVRpdGxlID0gdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlO1xyXG4gICAgaWYgKHByb3RvLnN0YXJ0UmVuYW1lICYmIHRoaXMub3JpZ2luYWxTdGFydFJlbmFtZSkge1xyXG4gICAgICB0aGlzLml0ZW0uc3RhcnRSZW5hbWUgPSB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VFeHQgfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGdldEZyb250bWF0dGVyIH0gZnJvbSAnLi4vdXRpbHMvZnJvbnRtYXR0ZXInO1xyXG5cclxuLyoqXHJcbiAqIFdpbmRvdyBGcmFtZSBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBIYW5kbGVzIGRpc3BsYXlpbmcgcHJvcGVydHktYmFzZWQgdGl0bGUgaW4gdGhlIGJyb3dzZXIgd2luZG93IHRpdGxlIGJhci5cclxuICogT3ZlcnJpZGVzIHdvcmtzcGFjZS51cGRhdGVUaXRsZSgpIHRvIHVzZSB0aGUgZnJvbnRtYXR0ZXIgcHJvcGVydHkgaW5zdGVhZFxyXG4gKiBvZiB0aGUgZmlsZSBuYW1lLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFdpbmRvd0ZyYW1lU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxVcGRhdGVUaXRsZTogKCgpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBlbmFibGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSB0aXRsZSBmb3IgdGhlIGFjdGl2ZSBmaWxlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRBY3RpdmVGaWxlVGl0bGUoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgIGlmIChhY3RpdmVGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgLy8gRm9yIE1EIGZpbGVzLCB1c2UgbWV0YWRhdGEgY2FjaGUgKGZhc3Qgc3luYyBhY2Nlc3MpXHJcbiAgICAgIGlmIChhY3RpdmVGaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgIGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuICAgICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZmlsZUNhY2hlPy5mcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKHByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiBTdHJpbmcocHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBGb3IgTURYIGZpbGVzLCB0cmlnZ2VyIGFzeW5jIHJlYWQgYW5kIHJldHVybiBmaWxlbmFtZSBmb3Igbm93XHJcbiAgICAgIC8vIFRoZSB0aXRsZSB3aWxsIHVwZGF0ZSBvbmNlIHRoZSBjYWNoZSBpcyBwb3B1bGF0ZWRcclxuICAgICAgaWYgKGFjdGl2ZUZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBhd2FpdCBnZXRGcm9udG1hdHRlcih0aGlzLnBsdWdpbi5hcHAsIGFjdGl2ZUZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICBpZiAocHJvcGVydHlWYWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGl0bGUgYXN5bmNocm9ub3VzbHlcclxuICAgICAgICAgICAgY29uc3QgYXBwID0gdGhpcy5wbHVnaW4uYXBwIGFzIHsgZ2V0QXBwVGl0bGU/OiAodGl0bGU6IHN0cmluZykgPT4gc3RyaW5nIH07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXBwLmdldEFwcFRpdGxlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBhcHAuZ2V0QXBwVGl0bGUoU3RyaW5nKHByb3BlcnR5VmFsdWUpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBjb25zdCB2YXVsdE5hbWUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TmFtZSgpO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gYCR7U3RyaW5nKHByb3BlcnR5VmFsdWUpfSAtICR7dmF1bHROYW1lfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KSgpO1xyXG4gICAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lOyAvLyBSZXR1cm4gZmlsZW5hbWUgaW1tZWRpYXRlbHksIHdpbGwgdXBkYXRlIGFzeW5jXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgdXBkYXRlVGl0bGUgdG8gdXNlIHByb3BlcnR5LWJhc2VkIHRpdGxlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVUaXRsZSgpIHtcclxuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIGlmICh0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUpIHtcclxuICAgICAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUoKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGl0bGUgPSB0aGlzLmdldEFjdGl2ZUZpbGVUaXRsZSgpO1xyXG4gICAgaWYgKHRpdGxlKSB7XHJcbiAgICAgIC8vIEdldCB0aGUgYXBwIHRpdGxlIGZvcm1hdCAodXN1YWxseSBcIlRpdGxlIC0gVmF1bHQgTmFtZVwiKVxyXG4gICAgICAvLyBUcnkgdG8gdXNlIE9ic2lkaWFuJ3MgZ2V0QXBwVGl0bGUgbWV0aG9kIGlmIGF2YWlsYWJsZVxyXG4gICAgICBjb25zdCBhcHAgPSB0aGlzLnBsdWdpbi5hcHAgYXMgeyBnZXRBcHBUaXRsZT86ICh0aXRsZTogc3RyaW5nKSA9PiBzdHJpbmcgfTtcclxuICAgICAgaWYgKHR5cGVvZiBhcHAuZ2V0QXBwVGl0bGUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBkb2N1bWVudC50aXRsZSA9IGFwcC5nZXRBcHBUaXRsZSh0aXRsZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmFsbGJhY2s6IGZvcm1hdCBtYW51YWxseVxyXG4gICAgICAgIGNvbnN0IHZhdWx0TmFtZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXROYW1lKCk7XHJcbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBgJHt0aXRsZX0gLSAke3ZhdWx0TmFtZX1gO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBiZWhhdmlvclxyXG4gICAgICBpZiAodGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKSB7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuYWJsZSB0aGUgd2luZG93IGZyYW1lIGZlYXR1cmVcclxuICAgKi9cclxuICBlbmFibGUoKSB7XHJcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB3b3Jrc3BhY2UgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlIGFzIFdvcmtzcGFjZUV4dDtcclxuICAgIGlmICh3b3Jrc3BhY2UudXBkYXRlVGl0bGUpIHtcclxuICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgbWV0aG9kXHJcbiAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSA9IHdvcmtzcGFjZS51cGRhdGVUaXRsZS5iaW5kKHdvcmtzcGFjZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPdmVycmlkZSB3aXRoIG91ciBtZXRob2RcclxuICAgICAgd29ya3NwYWNlLnVwZGF0ZVRpdGxlID0gdGhpcy51cGRhdGVUaXRsZS5iaW5kKHRoaXMpO1xyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIGltbWVkaWF0ZWx5XHJcbiAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNhYmxlIHRoZSB3aW5kb3cgZnJhbWUgZmVhdHVyZVxyXG4gICAqL1xyXG4gIGRpc2FibGUoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZSBhcyBXb3Jrc3BhY2VFeHQ7XHJcbiAgICBpZiAod29ya3NwYWNlLnVwZGF0ZVRpdGxlICYmIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSkge1xyXG4gICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIG1ldGhvZFxyXG4gICAgICB3b3Jrc3BhY2UudXBkYXRlVGl0bGUgPSB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVcGRhdGUgdG8gcmVzdG9yZSBvcmlnaW5hbCB0aXRsZVxyXG4gICAgICB3b3Jrc3BhY2UudXBkYXRlVGl0bGUoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSA9IG51bGw7XHJcbiAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgZXZlbnRzIGZvciB3aW5kb3cgZnJhbWUgdXBkYXRlc1xyXG4gICAqL1xyXG4gIHJlZ2lzdGVyRXZlbnRzKCkge1xyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JXaW5kb3dGcmFtZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHdoZW4gYWN0aXZlIGZpbGUgY2hhbmdlc1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1vcGVuJywgKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHdpbmRvdyBmcmFtZSB3aGVuIHNldHRpbmdzIGNoYW5nZVxyXG4gICAqL1xyXG4gIHVwZGF0ZVdpbmRvd0ZyYW1lKCkge1xyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lKSB7XHJcbiAgICAgIHRoaXMuZW5hYmxlKCk7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcclxuICAgKi9cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMuZGlzYWJsZSgpO1xyXG4gIH1cclxufVxyXG5cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7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aUJBQWlCLFNBQVM7QUFHL0IsU0FBSyxnQkFBZ0IsU0FBUztBQUc5QixTQUFLLFdBQVcsU0FBUztBQUd6QixTQUFLLGdCQUFnQixTQUFTO0FBRzlCLFNBQUssbUJBQW1CLFNBQVM7QUFBQSxFQUNuQztBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ25CLFVBQU0sYUFBYyxNQUFNLEtBQUssU0FBUztBQUN4QyxTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0Isa0NBQWMsQ0FBQyxDQUFDO0FBQUEsRUFDdEU7QUFBQSxFQUVBLE1BQU0sYUFBYSx3QkFBa0MsY0FBd0I7QUFDM0UsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBRWpDLFFBQUksMkJBQTJCLFVBQWEsMkJBQTJCLEtBQUssU0FBUyx3QkFBd0I7QUFDM0csV0FBSyxvQkFBb0I7QUFBQSxJQUMzQjtBQUNBLFFBQUksaUJBQWlCLFVBQWEsaUJBQWlCLEtBQUssU0FBUyxlQUFlO0FBRzlFLFdBQUssS0FBSyxXQUFXLGVBQWU7QUFDcEMsV0FBSyxXQUFXO0FBQUEsSUFDbEI7QUFBQSxFQUNGO0FBQ0Y7IiwKICAibmFtZXMiOiBbImdldEZyb250bWF0dGVyIiwgImltcG9ydF9vYnNpZGlhbiIsICJnZXRGcm9udG1hdHRlciIsICJpc0ZpbGVUeXBlU3VwcG9ydGVkIiwgInNlYXJjaFF1ZXJ5IiwgIl9hIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZ2V0RnJvbnRtYXR0ZXIiLCAiaXNGaWxlVHlwZVN1cHBvcnRlZCIsICJzdWdnZXN0aW9ucyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJRdWlja1N3aXRjaE1vZGFsIiwgIlF1aWNrU3dpdGNoTW9kYWwiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFjdGl2ZVZpZXciLCAiZ2V0RnJvbnRtYXR0ZXIiLCAiaXNGaWxlVHlwZVN1cHBvcnRlZCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiX2EiLCAiaW1wb3J0X29ic2lkaWFuIiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
