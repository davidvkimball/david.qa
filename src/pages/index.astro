---
import IndexLayout from '@/layouts/IndexLayout.astro';
import About from '@/components/widgets/About.astro';
import PostList from '@/components/widgets/PostList.astro';
import { themeConfig } from '@/config';
import { getSortedFilteredPosts } from '@/utils/draft';

const posts = await getSortedFilteredPosts();

// Enhanced debug log to verify post details
if (import.meta.env.DEV) {
  console.log('Dev mode: Posts include drafts', posts.map(p => ({
    id: p.id,
    title: p.data.title,
    pubDate: p.data.pubDate?.toISOString() || 'null'
  })));
} else {
  console.log('Build mode: Posts exclude drafts', posts.map(p => p.id));
}
---

<IndexLayout title={themeConfig.site.title} description={themeConfig.site.description}>
  <About />
  <main>
    <PostList posts={posts} />
  </main>
</IndexLayout>