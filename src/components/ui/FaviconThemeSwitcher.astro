<script is:inline>
  // Favicon theme switcher using separate SVG files for light and dark modes
  class FaviconThemeSwitcher {
    constructor() {
      this.faviconLink =
        document.querySelector('link[rel="icon"]') ||
        document.querySelector('link[rel="shortcut icon"]') ||
        document.querySelector('link[rel="apple-touch-icon"]')

      if (!this.faviconLink) {
        console.warn('Favicon link not found, skipping theme switcher')
        return
      }

      this.lightSvgUrl = '/favicon.svg'
      this.darkSvgUrl = '/favicon-on-dark.svg'
      this.currentUrl = null

      this.mediaQuery = window.matchMedia('(prefers-color-scheme: dark)')
      this.mediaQuery.addEventListener('change', () => this.updateFavicon())
      this.updateFavicon()
    }

    updateFavicon() {
      const newUrl = this.mediaQuery.matches ? this.darkSvgUrl : this.lightSvgUrl
      if (this.currentUrl === newUrl) return
      this.currentUrl = newUrl
      this.faviconLink.href = newUrl
    }
  }

  // Initialize favicon theme switcher
  function init() {
    try {
      new FaviconThemeSwitcher()
    } catch (error) {
      console.warn('Failed to initialize favicon theme switcher:', error)
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init)
  } else {
    init()
  }

  // Re-initialize on Astro page loads
  document.addEventListener('astro:page-load', init)
</script>